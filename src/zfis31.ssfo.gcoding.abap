DATA: WL_T001     TYPE T001,
      WL_LFA1     TYPE LFA1,
      WL_ZFIT0091 TYPE ZFIT0091.

LOOP AT IT_ZFIT0091 INTO WL_ZFIT0091.
*Seleciona Empresa.
  SELECT SINGLE *
    FROM T001
    INTO WL_T001
   WHERE BUKRS = WL_ZFIT0091-BUKRS.

  WL_SAIDA-BUKRS = WL_T001-BUKRS.
  WL_SAIDA-BUTXT = WL_T001-BUTXT.

* Seleciona Fornecedor.
  SELECT SINGLE *
    FROM LFA1
    INTO WL_LFA1
   WHERE LIFNR = WL_ZFIT0091-LIFNR.

  PERFORM F_STRLEN(ZFIS32) USING WL_ZFIT0091-AGENCIA
                        CHANGING WL_SAIDA-AGENCIA.

  PERFORM F_STRLEN(ZFIS32) USING WL_ZFIT0091-CONTA_CORRENTE
                        CHANGING WL_SAIDA-CONTA_CORRENTE.

  SHIFT WL_SAIDA-CONTA_CORRENTE LEFT DELETING LEADING '0'.

  WL_SAIDA-FAVORECIDO    = WL_LFA1-NAME1.
  WL_SAIDA-CNPJ_EMPRESA  = WL_ZFIT0091-CNPJ_EMPRESA.
  WL_SAIDA-CNPJ_CPF_FAV  = WL_ZFIT0091-CNPJ_CPF_FORN.
  WL_SAIDA-VLR_PGTO      = WL_ZFIT0091-VLR_PGTO.
  WL_SAIDA-COD_AUTENT    = WL_ZFIT0091-COD_AUTENT.
  WL_SAIDA-COD_BARRAS    = WL_ZFIT0091-COD_BARRAS.

* Concatena Banco + Agência + Dígito;
  IF WL_ZFIT0091-DV_AG_FAV IS INITIAL.
    WL_SAIDA-BCO_AG_FAV = WL_ZFIT0091-BCO_FAV
                       && WL_ZFIT0091-AG_FAV.
  ELSE.
    WL_SAIDA-BCO_AG_FAV = WL_ZFIT0091-BCO_FAV
                       && WL_ZFIT0091-AG_FAV
                       && '-'
                       && WL_ZFIT0091-DV_AG_FAV.
  ENDIF.

* Concatena Conta Corrente + Digito;
  IF WL_ZFIT0091-DV_FAV IS NOT INITIAL.
    WL_SAIDA-CC_FAV = WL_ZFIT0091-CC_FAV && '-' && WL_ZFIT0091-DV_FAV.
  ELSE.
    WL_SAIDA-CC_FAV = WL_ZFIT0091-CC_FAV.
  ENDIF.

  SHIFT WL_SAIDA-CC_FAV LEFT DELETING LEADING '0'.

* Formata a data.
  CONCATENATE WL_ZFIT0091-DT_PGTO+6(2) '/'
  WL_ZFIT0091-DT_PGTO+4(2) '/' WL_ZFIT0091-DT_PGTO(4)
  INTO WL_SAIDA-DT_PAGAMENTO.

* Nomeia o banco.
  CASE WL_ZFIT0091-BANCO.
    WHEN '001'.
      WL_SAIDA-BCO_EMPRESA = 'BANCO DO BRASIL'.
    WHEN '237'.
      WL_SAIDA-BCO_EMPRESA = 'BANCO BRADESCO'.
    WHEN '399'.
      WL_SAIDA-BCO_EMPRESA = 'BANCO HSBC'.
    WHEN '341'.
      WL_SAIDA-BCO_EMPRESA = 'BANCO ITAÚ'.
    WHEN '748'.
      WL_SAIDA-BCO_EMPRESA = 'SICREDI'.
    WHEN OTHERS.
  ENDCASE.

  APPEND WL_SAIDA TO GT_SAIDA.
ENDLOOP.
