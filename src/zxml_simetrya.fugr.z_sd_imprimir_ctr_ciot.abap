FUNCTION Z_SD_IMPRIMIR_CTR_CIOT.
*"----------------------------------------------------------------------
*"*"Interface local:
*"  IMPORTING
*"     VALUE(P_CTE_AVULSO) TYPE  J_1BDOCNUM OPTIONAL
*"     REFERENCE(P_RESUMO) TYPE  CHAR01 DEFAULT ' '
*"     REFERENCE(P_PEDAGIO) TYPE  CHAR01 DEFAULT ' '
*"     REFERENCE(P_CARGA_PEDAGIO) TYPE  CHAR01 DEFAULT ' '
*"  EXCEPTIONS
*"      NAO_CIOT
*"      ERRO_STATUS
*"      ERROR
*"----------------------------------------------------------------------

  DATA: VIAGEM TYPE REF TO ZCL_CIOT_VIAGEM.

  CREATE OBJECT VIAGEM.
  IF P_PEDAGIO IS NOT INITIAL.
    CALL METHOD VIAGEM->IMPRIMIR_PEDAGIO
      EXPORTING
        CTE_DOCNUM  = P_CTE_AVULSO
      EXCEPTIONS
        NAO_CIOT    = 1
        ERRO_STATUS = 2
        OTHERS      = 3.
  ELSEIF P_CARGA_PEDAGIO IS NOT INITIAL.
    CALL METHOD VIAGEM->CARGA_PEDAGIO
      EXPORTING
        CTE_DOCNUM  = P_CTE_AVULSO
      EXCEPTIONS
        NAO_CIOT    = 1
        ERRO_STATUS = 2
        OTHERS      = 3.
  ELSE.
    IF P_RESUMO IS INITIAL.

      CALL METHOD VIAGEM->IMPRIMIR_CONTRATO
        EXPORTING
          CTE_DOCNUM  = P_CTE_AVULSO
        EXCEPTIONS
          NAO_CIOT    = 1
          ERRO_STATUS = 2
          OTHERS      = 3.
    ELSE.
      CALL METHOD VIAGEM->IMPRIMIR_RESUMO
        EXPORTING
          CTE_DOCNUM  = P_CTE_AVULSO
        EXCEPTIONS
          NAO_CIOT    = 1
          ERRO_STATUS = 2
          OTHERS      = 3.
    ENDIF.
  ENDIF.

  CASE SY-SUBRC.
    WHEN 0.
    WHEN 1.
      MESSAGE E004(ZCIOT) WITH P_CTE_AVULSO RAISING NAO_CIOT.
    WHEN 2.
      MESSAGE E024(ZCIOT) WITH P_CTE_AVULSO RAISING ERRO_STATUS.
    WHEN OTHERS.
      MESSAGE ID SY-MSGID TYPE SY-MSGTY NUMBER SY-MSGNO WITH SY-MSGV1 SY-MSGV2 SY-MSGV3 SY-MSGV4 RAISING ERROR.
  ENDCASE.

ENDFUNCTION.
