*----------------------------------------------------------------------*
***INCLUDE MZDRE0001_9009 .
*----------------------------------------------------------------------*

*&---------------------------------------------------------------------*
*&      Module  STATUS_9009  OUTPUT
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
MODULE STATUS_9009 OUTPUT.

  SET PF-STATUS 'PF9003'.
  SET TITLEBAR 'TL9009'.

  CLEAR: VG_GRUPO_MATERIAL,
         VG_GRUPO_MATERIAL_2,
         VG_GRUPO_MATERIAL_3,
         VG_GRUPO_MATERIAL_4,
         VG_GRUPO_MATERIAL_5.

  IF NOT ZGL015_DRE_EST06-MATKL IS INITIAL.
    SELECT SINGLE WGBEZ60 INTO VG_GRUPO_MATERIAL
      FROM T023T
     WHERE SPRAS EQ SY-LANGU
       AND MATKL EQ ZGL015_DRE_EST06-MATKL.
  ENDIF.

  IF NOT LS_MATKL_2 IS INITIAL.
    SELECT SINGLE WGBEZ60 INTO VG_GRUPO_MATERIAL_2
      FROM T023T
     WHERE SPRAS EQ SY-LANGU
       AND MATKL EQ LS_MATKL_2.
  ENDIF.

  IF NOT LS_MATKL_3 IS INITIAL.
    SELECT SINGLE WGBEZ60 INTO VG_GRUPO_MATERIAL_3
      FROM T023T
     WHERE SPRAS EQ SY-LANGU
       AND MATKL EQ LS_MATKL_3.
  ENDIF.

  IF NOT LS_MATKL_4 IS INITIAL.
    SELECT SINGLE WGBEZ60 INTO VG_GRUPO_MATERIAL_4
      FROM T023T
     WHERE SPRAS EQ SY-LANGU
       AND MATKL EQ LS_MATKL_4.
  ENDIF.

  IF NOT LS_MATKL_5 IS INITIAL.
    SELECT SINGLE WGBEZ60 INTO VG_GRUPO_MATERIAL_5
      FROM T023T
     WHERE SPRAS EQ SY-LANGU
       AND MATKL EQ LS_MATKL_5.
  ENDIF.


ENDMODULE.                 " STATUS_9009  OUTPUT

*&---------------------------------------------------------------------*
*&      Module  USER_COMMAND_9009_EXIT  INPUT
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
MODULE USER_COMMAND_9009_EXIT INPUT.
  LEAVE TO SCREEN 0.
ENDMODULE.                 " USER_COMMAND_9009_EXIT  INPUT

*&---------------------------------------------------------------------*
*&      Module  USER_COMMAND_9009  INPUT
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
MODULE USER_COMMAND_9009 INPUT.

  DATA: VG_CGM TYPE ZGL015_DRE_EST06,
        CGM_MSG TYPE CHAR100.

  IF OK_CODE_9009 EQ C_CONF.

    IF NOT ( ZGL015_DRE_EST06-MATKL IS INITIAL ).

      SELECT SINGLE * INTO VG_CGM
        FROM ZGL015_DRE_EST06
       WHERE BUKRS EQ ZGL015_DRE_EST06-BUKRS
         AND VERSN EQ ZGL015_DRE_EST06-VERSN
         AND NIVEL EQ ZGL015_DRE_EST06-NIVEL
         AND KTOPL EQ ZGL015_DRE_EST06-KTOPL
         AND SAKNR EQ ZGL015_DRE_EST06-SAKNR
         AND MATKL EQ ZGL015_DRE_EST06-MATKL.

      IF SY-SUBRC IS INITIAL.
        CLEAR: CGM_MSG.
        CONCATENATE 'Grupo de Material já cadastrado' ZGL015_DRE_EST06-MATKL '!' INTO CGM_MSG SEPARATED BY SPACE.
        MESSAGE CGM_MSG TYPE 'E'.
      ENDIF.

      MODIFY ZGL015_DRE_EST06.
      PRIM_DRE_NIVEL_RE = C_X.
      MOVE-CORRESPONDING ZGL015_DRE_EST06 TO ZGL015_DRE_EST02.
    ENDIF.


    IF NOT ( LS_MATKL_2 IS INITIAL ).
      SELECT SINGLE * INTO VG_CGM
        FROM ZGL015_DRE_EST06
       WHERE BUKRS EQ ZGL015_DRE_EST06-BUKRS
         AND VERSN EQ ZGL015_DRE_EST06-VERSN
         AND NIVEL EQ ZGL015_DRE_EST06-NIVEL
         AND KTOPL EQ ZGL015_DRE_EST06-KTOPL
         AND SAKNR EQ ZGL015_DRE_EST06-SAKNR
         AND MATKL EQ LS_MATKL_2.

      IF SY-SUBRC IS INITIAL.
        CLEAR: CGM_MSG.
        CONCATENATE 'Grupo de Material já cadastrado' LS_MATKL_2 '!' INTO CGM_MSG SEPARATED BY SPACE.
        MESSAGE CGM_MSG TYPE 'E'.
      ENDIF.
      ZGL015_DRE_EST06-MATKL = LS_MATKL_2.
      MODIFY ZGL015_DRE_EST06.
      PRIM_DRE_NIVEL_RE = C_X.
      MOVE-CORRESPONDING ZGL015_DRE_EST06 TO ZGL015_DRE_EST02.
    ENDIF.

    IF NOT ( LS_MATKL_3 IS INITIAL ).
      SELECT SINGLE * INTO VG_CGM
        FROM ZGL015_DRE_EST06
       WHERE BUKRS EQ ZGL015_DRE_EST06-BUKRS
         AND VERSN EQ ZGL015_DRE_EST06-VERSN
         AND NIVEL EQ ZGL015_DRE_EST06-NIVEL
         AND KTOPL EQ ZGL015_DRE_EST06-KTOPL
         AND SAKNR EQ ZGL015_DRE_EST06-SAKNR
         AND MATKL EQ LS_MATKL_3.

      IF SY-SUBRC IS INITIAL.
        CLEAR: CGM_MSG.
        CONCATENATE 'Grupo de Material já cadastrado' LS_MATKL_3 '!' INTO CGM_MSG SEPARATED BY SPACE.
        MESSAGE CGM_MSG TYPE 'E'.
      ENDIF.
      ZGL015_DRE_EST06-MATKL = LS_MATKL_3.
      MODIFY ZGL015_DRE_EST06.
      PRIM_DRE_NIVEL_RE = C_X.
      MOVE-CORRESPONDING ZGL015_DRE_EST06 TO ZGL015_DRE_EST02.
    ENDIF.


    IF NOT ( LS_MATKL_4 IS INITIAL ).
      SELECT SINGLE * INTO VG_CGM
        FROM ZGL015_DRE_EST06
       WHERE BUKRS EQ ZGL015_DRE_EST06-BUKRS
         AND VERSN EQ ZGL015_DRE_EST06-VERSN
         AND NIVEL EQ ZGL015_DRE_EST06-NIVEL
         AND KTOPL EQ ZGL015_DRE_EST06-KTOPL
         AND SAKNR EQ ZGL015_DRE_EST06-SAKNR
         AND MATKL EQ LS_MATKL_4.

      IF SY-SUBRC IS INITIAL.
        CLEAR: CGM_MSG.
        CONCATENATE 'Grupo de Material já cadastrado' LS_MATKL_4 '!' INTO CGM_MSG SEPARATED BY SPACE.
        MESSAGE CGM_MSG TYPE 'E'.
      ENDIF.
      ZGL015_DRE_EST06-MATKL = LS_MATKL_4.
      MODIFY ZGL015_DRE_EST06.
      PRIM_DRE_NIVEL_RE = C_X.
      MOVE-CORRESPONDING ZGL015_DRE_EST06 TO ZGL015_DRE_EST02.
    ENDIF.

    IF NOT ( LS_MATKL_5 IS INITIAL ).
      SELECT SINGLE * INTO VG_CGM
        FROM ZGL015_DRE_EST06
       WHERE BUKRS EQ ZGL015_DRE_EST06-BUKRS
         AND VERSN EQ ZGL015_DRE_EST06-VERSN
         AND NIVEL EQ ZGL015_DRE_EST06-NIVEL
         AND KTOPL EQ ZGL015_DRE_EST06-KTOPL
         AND SAKNR EQ ZGL015_DRE_EST06-SAKNR
         AND MATKL EQ LS_MATKL_5.

      IF SY-SUBRC IS INITIAL.
        CLEAR: CGM_MSG.
        CONCATENATE 'Grupo de Material já cadastrado' LS_MATKL_5 '!' INTO CGM_MSG SEPARATED BY SPACE.
        MESSAGE CGM_MSG TYPE 'E'.
      ENDIF.
      ZGL015_DRE_EST06-MATKL = LS_MATKL_5.
      MODIFY ZGL015_DRE_EST06.
      PRIM_DRE_NIVEL_RE = C_X.
      MOVE-CORRESPONDING ZGL015_DRE_EST06 TO ZGL015_DRE_EST02.
    ENDIF.

    CALL METHOD G_TREE->DELETE_ALL_NODES.
    LEAVE TO SCREEN 0.
  ENDIF.

ENDMODULE.                 " USER_COMMAND_9009  INPUT
