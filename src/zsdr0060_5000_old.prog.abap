*&---------------------------------------------------------------------*
*&  Include           ZSDR0060_5000
*&---------------------------------------------------------------------*

DATA: IT_EXCLUDE_FCODE TYPE UI_FUNCTIONS.

*&---------------------------------------------------------------------*
*&      Module  STATUS_5000  OUTPUT
*&---------------------------------------------------------------------*
MODULE STATUS_5000 OUTPUT.

  SET PF-STATUS 'PF5000' EXCLUDING IT_EXCLUDE_FCODE.

  "Abas visíveis para cada opção da seleção
  LOOP AT SCREEN.
    IF P_SPART2 IS NOT INITIAL.
      IF P_FCORP IS NOT INITIAL.
        IF SCREEN-NAME = 'TABSTRIP_TAB1' OR
          SCREEN-NAME  = 'TABSTRIP_TAB2' OR
          SCREEN-NAME  = 'TABSTRIP_TAB3' OR
          SCREEN-NAME  = 'TABSTRIP_TAB5' OR
          SCREEN-NAME  = 'TABSTRIP_TAB6' OR
          SCREEN-NAME  = 'TABSTRIP_TAB7' OR
          SCREEN-NAME  = 'TABSTRIP_TAB8'.
          SCREEN-ACTIVE    = 0.
          SCREEN-INVISIBLE = 0.
          MODIFY SCREEN.
        ENDIF.
      ELSEIF P_FTPNG IS NOT INITIAL.
        IF SCREEN-NAME = 'TABSTRIP_TAB1' OR
          SCREEN-NAME  = 'TABSTRIP_TAB2' OR
          SCREEN-NAME  = 'TABSTRIP_TAB3' OR
          SCREEN-NAME  = 'TABSTRIP_TAB4' OR
          SCREEN-NAME  = 'TABSTRIP_TAB6' OR
          SCREEN-NAME  = 'TABSTRIP_TAB7' OR
          SCREEN-NAME  = 'TABSTRIP_TAB8'.
          SCREEN-ACTIVE    = 0.
          SCREEN-INVISIBLE = 0.
          MODIFY SCREEN.
        ENDIF.
      ELSEIF P_FTROO IS NOT INITIAL.
        IF SCREEN-NAME = 'TABSTRIP_TAB1' OR
          SCREEN-NAME  = 'TABSTRIP_TAB2' OR
          SCREEN-NAME  = 'TABSTRIP_TAB3' OR
          SCREEN-NAME  = 'TABSTRIP_TAB4' OR
          SCREEN-NAME  = 'TABSTRIP_TAB5' OR
          SCREEN-NAME  = 'TABSTRIP_TAB7' OR
          SCREEN-NAME  = 'TABSTRIP_TAB8'.
          SCREEN-ACTIVE    = 0.
          SCREEN-INVISIBLE = 0.
          MODIFY SCREEN.
        ENDIF.
      ENDIF.
    ELSEIF P_SPART3 IS NOT INITIAL.
      IF SCREEN-NAME = 'TABSTRIP_TAB1' OR
         SCREEN-NAME = 'TABSTRIP_TAB2' OR
         SCREEN-NAME = 'TABSTRIP_TAB3' OR
         SCREEN-NAME = 'TABSTRIP_TAB4' OR
         SCREEN-NAME = 'TABSTRIP_TAB5' OR
         SCREEN-NAME = 'TABSTRIP_TAB6'.
        SCREEN-ACTIVE    = 0.
        SCREEN-INVISIBLE = 0.
        MODIFY SCREEN.
      ENDIF.
    ELSEIF P_SPART4 IS NOT INITIAL.
      IF P_FILIAL IS NOT INITIAL.
        IF SCREEN-NAME = 'TABSTRIP_TAB2' OR
           SCREEN-NAME = 'TABSTRIP_TAB3' OR
           SCREEN-NAME = 'TABSTRIP_TAB4' OR
          SCREEN-NAME  = 'TABSTRIP_TAB5' OR
          SCREEN-NAME  = 'TABSTRIP_TAB6' OR
          SCREEN-NAME  = 'TABSTRIP_TAB7' OR
          SCREEN-NAME  = 'TABSTRIP_TAB8'.
          SCREEN-ACTIVE    = 0.
          SCREEN-INVISIBLE = 0.
          MODIFY SCREEN.
        ENDIF.
      ELSEIF P_TRANSP IS NOT INITIAL OR
             P_LOGCOR IS NOT INITIAL.
        IF SCREEN-NAME = 'TABSTRIP_TAB1' OR
           SCREEN-NAME = 'TABSTRIP_TAB3' OR
           SCREEN-NAME = 'TABSTRIP_TAB4' OR
          SCREEN-NAME  = 'TABSTRIP_TAB5' OR
          SCREEN-NAME  = 'TABSTRIP_TAB6' OR
          SCREEN-NAME  = 'TABSTRIP_TAB7' OR
          SCREEN-NAME  = 'TABSTRIP_TAB8'.
          SCREEN-ACTIVE    = 0.
          SCREEN-INVISIBLE = 0.
          MODIFY SCREEN.
        ENDIF.
      ELSEIF P_CORPLT IS NOT INITIAL.
        IF SCREEN-NAME = 'TABSTRIP_TAB4' OR
          SCREEN-NAME  = 'TABSTRIP_TAB5' OR
          SCREEN-NAME  = 'TABSTRIP_TAB6' OR
          SCREEN-NAME  = 'TABSTRIP_TAB7' OR
          SCREEN-NAME  = 'TABSTRIP_TAB8'.
          SCREEN-ACTIVE    = 0.
          SCREEN-INVISIBLE = 0.
          MODIFY SCREEN.
        ENDIF.
      ELSEIF P_CORPCG IS NOT INITIAL.
        IF SCREEN-NAME = 'TABSTRIP_TAB1' OR
           SCREEN-NAME = 'TABSTRIP_TAB4' OR
          SCREEN-NAME  = 'TABSTRIP_TAB5' OR
          SCREEN-NAME  = 'TABSTRIP_TAB6' OR
          SCREEN-NAME  = 'TABSTRIP_TAB7' OR
          SCREEN-NAME  = 'TABSTRIP_TAB8'.
          SCREEN-ACTIVE    = 0.
          SCREEN-INVISIBLE = 0.
          MODIFY SCREEN.
        ENDIF.
      ELSEIF P_CORPPT IS NOT INITIAL.
        IF SCREEN-NAME = 'TABSTRIP_TAB1' OR
           SCREEN-NAME = 'TABSTRIP_TAB2' OR
           SCREEN-NAME = 'TABSTRIP_TAB4' OR
          SCREEN-NAME  = 'TABSTRIP_TAB5' OR
          SCREEN-NAME  = 'TABSTRIP_TAB6' OR
          SCREEN-NAME  = 'TABSTRIP_TAB7' OR
          SCREEN-NAME  = 'TABSTRIP_TAB8'.
          SCREEN-ACTIVE    = 0.
          SCREEN-INVISIBLE = 0.
          MODIFY SCREEN.
        ENDIF.
      ENDIF.
    ENDIF.
  ENDLOOP.

  "Títulos
  IF VG_SUBT_LOTE EQ '5120'.
    SET TITLEBAR 'T5120'.
  ELSEIF VG_SUBT_LOTE EQ '5130'.
    SET TITLEBAR 'T5130'.
  ELSEIF VG_SUBT_LOTE EQ '5140'.
    SET TITLEBAR 'T5140' WITH VG_LOTE_EDITAR.
  ELSEIF VG_SUBT_LOTE EQ '5230'.
    SET TITLEBAR 'T5230'.
  ELSEIF VG_SUBT_LOTE EQ '5220'.
    SET TITLEBAR 'T5220'.
  ELSEIF VG_SUBT_LOTE EQ '5320'.
    SET TITLEBAR 'T5320'.
  ELSEIF VG_SUBT_LOTE EQ '5420'.
    SET TITLEBAR 'T5420'.
  ELSEIF VG_SUBT_LOTE EQ '5520'.
    SET TITLEBAR 'T5520'.
  ELSEIF VG_SUBT_LOTE EQ '5620'.
    SET TITLEBAR 'T5620'.
  ELSEIF VG_SUBT_LOTE EQ '5720'.
    SET TITLEBAR 'T5720'.
  ELSEIF VG_SUBT_LOTE EQ '5730'.
    SET TITLEBAR 'T5730'.
  ELSEIF VG_SUBT_LOTE EQ '5740'.
    SET TITLEBAR 'T5740' WITH VG_LOTE_EDITAR.
  ELSEIF VG_SUBT_LOTE EQ '5820'.
    SET TITLEBAR 'T5820'.
  ENDIF.

ENDMODULE.
*&---------------------------------------------------------------------*
*&      Module  USER_COMMAND_5000_EXIT  INPUT
*&---------------------------------------------------------------------*
MODULE USER_COMMAND_5000_EXIT INPUT.

  IF VG_SUBT_LOTE EQ '5130'.

    PERFORM DESBLOQUEIA_SOL_5130.

    VG_SUBT_LOTE = '5120'.
    PERFORM CLEAR_5120.
    LEAVE TO SCREEN 5000.
  ELSEIF VG_SUBT_LOTE EQ '5140'.

    PERFORM DESBLOQUEIA_SOL_5140.

    CALL FUNCTION 'ZDENQUEUE_SD_LOTE_INSUMOS'
      EXPORTING
        CHAVE = VG_LOTE_EDITAR.

    VG_SUBT_LOTE = '5120'.
    PERFORM CLEAR_5120.
    LEAVE TO SCREEN 5000.
  ELSEIF VG_SUBT_LOTE EQ '5120'.
    LEAVE TO SCREEN 0.
  ELSEIF VG_SUBT_LOTE EQ '5220'.
    LEAVE TO SCREEN 0.
  ELSEIF VG_SUBT_LOTE EQ '5230'.
    LEAVE TO SCREEN 0.
  ELSEIF VG_SUBT_LOTE EQ '5320'.
    LEAVE TO SCREEN 0.
  ELSEIF VG_SUBT_LOTE EQ '5420'.
    LEAVE TO SCREEN 0.
  ELSEIF VG_SUBT_LOTE EQ '5520'.
    LEAVE TO SCREEN 0.
  ELSEIF VG_SUBT_LOTE EQ '5620'.
    LEAVE TO SCREEN 0.
  ELSEIF VG_SUBT_LOTE EQ '5720'.
    LEAVE TO SCREEN 0.
  ELSEIF VG_SUBT_LOTE EQ '5730'.

    PERFORM DESBLOQUEIA_SOL_5730.

    VG_SUBT_LOTE = '5720'.
    PERFORM CLEAR_5720.
    LEAVE TO SCREEN 5000.
  ELSEIF VG_SUBT_LOTE EQ '5740'.

    PERFORM DESBLOQUEIA_SOL_5740.

    CALL FUNCTION 'ZDENQUEUE_SD_CARGAD_INSUMOS'
      EXPORTING
        CHAVE = VG_LOTE_EDITAR.

    VG_SUBT_LOTE = '5720'.
    PERFORM CLEAR_5720.
    LEAVE TO SCREEN 5000.
  ELSEIF VG_SUBT_LOTE EQ '5820'.
    LEAVE TO SCREEN 0.
  ENDIF.

ENDMODULE.

*&---------------------------------------------------------------------*
*&      Module  EXCLUIR_BOTOES  OUTPUT
*&---------------------------------------------------------------------*
MODULE EXCLUIR_BOTOES OUTPUT.

  DATA: WA_EXCLUDE_FCODE LIKE LINE OF IT_EXCLUDE_FCODE.

  CLEAR: IT_EXCLUDE_FCODE.

  IF VG_SUBT_LOTE NE '5140'.
    WA_EXCLUDE_FCODE = 'DELETELOTE'.
    APPEND WA_EXCLUDE_FCODE TO IT_EXCLUDE_FCODE.
  ENDIF.

  IF VG_SUBT_LOTE NE '5740'.
    WA_EXCLUDE_FCODE = 'DELETECG'.
    APPEND WA_EXCLUDE_FCODE TO IT_EXCLUDE_FCODE.
  ENDIF.

  IF ( VG_SUBT_LOTE NE '5130' AND VG_SUBT_LOTE NE '5140' AND VG_SUBT_LOTE NE '5230' AND
       VG_SUBT_LOTE NE '5220' AND VG_SUBT_LOTE NE '5730' AND VG_SUBT_LOTE NE '5740' ).
    WA_EXCLUDE_FCODE = 'SAVE'.
    APPEND WA_EXCLUDE_FCODE TO IT_EXCLUDE_FCODE.
  ENDIF.

ENDMODULE.

*&SPWIZARD: OUTPUT MODULE FOR TS 'TABSTRIP'. DO NOT CHANGE THIS LINE!
*&SPWIZARD: SETS ACTIVE TAB
MODULE TABSTRIP_ACTIVE_TAB_SET OUTPUT.

  TABSTRIP-ACTIVETAB = G_TABSTRIP-PRESSED_TAB.
  CASE G_TABSTRIP-PRESSED_TAB.
    WHEN C_TABSTRIP-TAB1.
      G_TABSTRIP-SUBSCREEN = '5100'.
    WHEN C_TABSTRIP-TAB2.
      G_TABSTRIP-SUBSCREEN = '5200'.
    WHEN C_TABSTRIP-TAB3.
      G_TABSTRIP-SUBSCREEN = '5300'.
    WHEN C_TABSTRIP-TAB4.
      G_TABSTRIP-SUBSCREEN = '5400'.
    WHEN C_TABSTRIP-TAB5.
      G_TABSTRIP-SUBSCREEN = '5500'.
    WHEN C_TABSTRIP-TAB6.
      G_TABSTRIP-SUBSCREEN = '5600'.
    WHEN C_TABSTRIP-TAB7.
      G_TABSTRIP-SUBSCREEN = '5700'.
    WHEN C_TABSTRIP-TAB8.
      G_TABSTRIP-SUBSCREEN = '5800'.
    WHEN OTHERS.
      "DO NOTHING
  ENDCASE.
ENDMODULE.

*&SPWIZARD: INPUT MODULE FOR TS 'TABSTRIP'. DO NOT CHANGE THIS LINE!
*&SPWIZARD: GETS ACTIVE TAB
MODULE TABSTRIP_ACTIVE_TAB_GET INPUT.
  OK_CODE = SY-UCOMM.
  CASE OK_CODE.
    WHEN C_TABSTRIP-TAB1.
      VG_SUBT_LOTE = '5120'.
      PERFORM CLEAR_5120.
      G_TABSTRIP-PRESSED_TAB = C_TABSTRIP-TAB1.
    WHEN C_TABSTRIP-TAB2.
      IF VG_SUBT_LOTE NE '5130' AND VG_SUBT_LOTE NE '5140'.
        VG_SUBT_LOTE = '5230'.
        G_TABSTRIP-PRESSED_TAB = C_TABSTRIP-TAB2.
      ENDIF.
    WHEN C_TABSTRIP-TAB3.
      IF VG_SUBT_LOTE NE '5130' AND VG_SUBT_LOTE NE '5140'.
        VG_SUBT_LOTE = '5320'.
        G_TABSTRIP-PRESSED_TAB = C_TABSTRIP-TAB3.
      ENDIF.
    WHEN C_TABSTRIP-TAB4.
      G_TABSTRIP-PRESSED_TAB = C_TABSTRIP-TAB4.
    WHEN C_TABSTRIP-TAB5.
      G_TABSTRIP-PRESSED_TAB = C_TABSTRIP-TAB5.
    WHEN C_TABSTRIP-TAB6.
      G_TABSTRIP-PRESSED_TAB = C_TABSTRIP-TAB6.
    WHEN C_TABSTRIP-TAB7.
      G_TABSTRIP-PRESSED_TAB = C_TABSTRIP-TAB7.
      PERFORM CLEAR_5720.
      VG_SUBT_LOTE = '5720'.
    WHEN C_TABSTRIP-TAB8.
      IF VG_SUBT_LOTE NE '5730' AND VG_SUBT_LOTE NE '5740'.
        G_TABSTRIP-PRESSED_TAB = C_TABSTRIP-TAB8.
        VG_SUBT_LOTE = '5820'.
      ENDIF.
    WHEN OTHERS.
*&SPWIZARD:      DO NOTHING
  ENDCASE.
ENDMODULE.
