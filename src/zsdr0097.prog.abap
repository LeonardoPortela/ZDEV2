REPORT ZSDR0097.

TABLES: J_1BNFDOC, LFA1.

SELECTION-SCREEN BEGIN OF BLOCK ZB04 WITH FRAME TITLE TEXT-001.
PARAMETERS:     T_EMPREE TYPE BUKRS    OBLIGATORY,
                T_CENTRE TYPE WERKS_D,
                T_PRODUE TYPE MATNR.
SELECT-OPTIONS: T_PERIOE FOR  J_1BNFDOC-DOCDAT OBLIGATORY,
                T_REMETP FOR  LFA1-LIFNR.
SELECTION-SCREEN END OF BLOCK ZB04.

DATA: IT_EXPORTACOES TYPE TABLE OF ZEXPORT_ACOMP INITIAL SIZE 0 WITH HEADER LINE.

CLEAR: IT_EXPORTACOES[].

CALL FUNCTION 'Z_EXPORT_TERCEIRO_ACOMP'
  EXPORTING
    P_BUKRS          = T_EMPREE
    P_WERKS          = T_CENTRE
    P_MATNR          = T_PRODUE
    T_EXPORT         = T_REMETP[]
    T_PERIOD         = T_PERIOE[]
    EXPORTADORES     = ABAP_TRUE
    NOTAS_EXPORTACAO = ABAP_TRUE
    P_DIRECAO        = '1'
  TABLES
    IT_EXPORTACOES   = IT_EXPORTACOES
  EXCEPTIONS
    CFOPS_SAIDA      = 1
    OTHERS           = 2.

IF SY-SUBRC IS NOT INITIAL.
  EXIT.
ENDIF.

CALL FUNCTION 'REUSE_ALV_GRID_DISPLAY'
  EXPORTING
    I_STRUCTURE_NAME = 'ZEXPORT_ACOMP'
  TABLES
    T_OUTTAB         = IT_EXPORTACOES.
