*&---------------------------------------------------------------------*
*&  Include           ZLESR0120_TOP
*&---------------------------------------------------------------------*

REPORT ZLESR0120.

TABLES: ZLEST0060.

TYPES: BEGIN OF TY_ESTRUTURA.
        INCLUDE TYPE SLIS_FIELDCAT_MAIN.
        INCLUDE TYPE SLIS_FIELDCAT_ALV_SPEC.
TYPES: END OF TY_ESTRUTURA.

TYPES: BEGIN OF TY_SAIDA_0100,
         NAME1     TYPE LFA1-NAME1,
         MAKTX     TYPE MAKT-MAKTX,
         DISP_CCT  TYPE C LENGTH 4,
         VINC_TOT  TYPE C LENGTH 4,
         COLOR     TYPE KKBLO_SPECIALCOL OCCURS 0.
         INCLUDE STRUCTURE ZLEST0060.
TYPES END OF TY_SAIDA_0100.

*---------------------------------------------------------------------*
*  Inicio Definition Classes
*---------------------------------------------------------------------*

CLASS LCL_ALV_TOOLBAR_0100 DEFINITION.
  PUBLIC SECTION.
*Constructor
    METHODS: CONSTRUCTOR
                IMPORTING IO_ALV_GRID TYPE REF TO CL_GUI_ALV_GRID,
*Event for toolbar
    ON_TOOLBAR FOR EVENT TOOLBAR OF CL_GUI_ALV_GRID
               IMPORTING  E_OBJECT,

    HANDLE_USER_COMMAND FOR EVENT USER_COMMAND OF CL_GUI_ALV_GRID
               IMPORTING E_UCOMM.

ENDCLASS.                    "LCL_ALV_TOOLBAR DEFINITION


CLASS LCL_EVENT_HANDLER_0100 DEFINITION.
  PUBLIC SECTION.

    CLASS-METHODS:
      CATCH_HOTSPOT FOR EVENT HOTSPOT_CLICK OF CL_GUI_ALV_GRID
            IMPORTING E_ROW_ID E_COLUMN_ID ES_ROW_NO.
ENDCLASS.


CLASS LCL_ALV_TOOLBAR_0110 DEFINITION.
  PUBLIC SECTION.
*Constructor
    METHODS: CONSTRUCTOR
                IMPORTING IO_ALV_GRID TYPE REF TO CL_GUI_ALV_GRID,
*Event for toolbar
    ON_TOOLBAR FOR EVENT TOOLBAR OF CL_GUI_ALV_GRID
               IMPORTING  E_OBJECT,

    HANDLE_USER_COMMAND FOR EVENT USER_COMMAND OF CL_GUI_ALV_GRID
               IMPORTING E_UCOMM.

ENDCLASS.                    "LCL_ALV_TOOLBAR DEFINITION


CLASS LCL_EVENT_HANDLER_0110 DEFINITION.
  PUBLIC SECTION.

    CLASS-METHODS:
      CATCH_HOTSPOT FOR EVENT HOTSPOT_CLICK OF CL_GUI_ALV_GRID
            IMPORTING E_ROW_ID E_COLUMN_ID ES_ROW_NO.
ENDCLASS.

DATA: OBJ_ALV_0100         TYPE REF TO CL_GUI_ALV_GRID,
      OBJ_CONTAINER_0100   TYPE REF TO CL_GUI_CUSTOM_CONTAINER.

DATA: GT_CATALOG       TYPE LVC_T_FCAT,
      GW_CATALOG       TYPE LVC_S_FCAT.

DATA: OBJ_TOOLBAR_0100 TYPE REF TO LCL_ALV_TOOLBAR_0100.

* ALV field catalogs
DATA: IT_FCAT    TYPE LVC_T_FCAT,
      WA_FCAT    TYPE LVC_S_FCAT.

* ALV excluded functions
DATA: IT_EXCLUDE_FCODE TYPE UI_FUNCTIONS,
      WA_EXCLUDE_FCODE LIKE LINE OF IT_EXCLUDE_FCODE.

* Alv Styles
DATA: LS_EDIT         TYPE LVC_S_STYL,
      LT_EDIT         TYPE LVC_T_STYL.

* ALV layout variant
DATA: GS_VARIANT       TYPE DISVARIANT.

* ALV layout
DATA: GS_LAYOUT        TYPE LVC_S_LAYO.

* ALV Stable
DATA: WA_STABLE        TYPE LVC_S_STBL.

DATA: IT_SELECTEDCELL  TYPE LVC_T_CELL,
      WA_SELECTEDCELL  TYPE LVC_S_CELL.

DATA: IT_SEL_ROWS         TYPE LVC_T_ROW,
      WA_SEL_ROWS         TYPE LVC_S_ROW.

DATA: GT_ESTILO   TYPE LVC_T_STYL WITH HEADER LINE,
      WL_ESTILO   TYPE LVC_S_STYL.

DATA: GT_F4  TYPE LVC_T_F4 WITH HEADER LINE.

* Objetos
DATA: C_ALV_TOOLBARMANAGER TYPE REF TO CL_ALV_GRID_TOOLBAR_MANAGER,
      TY_TOOLBAR TYPE STB_BUTTON.

DATA: WA_ESTRUTURA       TYPE TY_ESTRUTURA,
      ESTRUTURA          TYPE TABLE OF TY_ESTRUTURA.

DATA: WL_VRM_VALUE  TYPE VRM_VALUE,
      IT_VRM_VALUE TYPE STANDARD TABLE OF VRM_VALUE.

*-------------------------------------------------------------------
* Classes
*-------------------------------------------------------------------
DATA: ZCL_CCT_CONTROL_NF TYPE REF TO ZCL_CCT_CONTROL_NF.

*-------------------------------------------------------------------
* Tabelas Internas and Work Areas.
*-------------------------------------------------------------------
DATA: IT_SAIDA_0100     TYPE TABLE OF TY_SAIDA_0100,
      WA_SAIDA_0100     TYPE TY_SAIDA_0100,
      IT_SAIDA_0100_AUX TYPE TABLE OF TY_SAIDA_0100,
      WA_SAIDA_0100_AUX TYPE TY_SAIDA_0100,
      TG_LFA1           TYPE TABLE OF LFA1 WITH HEADER LINE,
      TG_MAKT           TYPE TABLE OF MAKT WITH HEADER LINE,
      TG_0142           TYPE TABLE OF ZLEST0142 WITH HEADER LINE,
      TG_0073           TYPE TABLE OF ZLEST0073 WITH HEADER LINE,
      TG_0060_NFE       TYPE TABLE OF ZLEST0060 WITH HEADER LINE,
      TG_ACTIVE         TYPE TABLE OF J_1BNFE_ACTIVE WITH HEADER LINE,
      TG_0060           TYPE TABLE OF ZLEST0060 WITH HEADER LINE.


*-------------------------------------------------------------------
* VÃ¡riaveis
*-------------------------------------------------------------------
DATA: VG_OPERACAO         TYPE C LENGTH 20,
      VAR_ANSWER          TYPE C,
      VG_NOT_FOUND        TYPE C,
      VG_INIT_SCREEN      TYPE C.


*-------------------------------------------------------------------
* Ranges
*-------------------------------------------------------------------

RANGES: R_DOC_REM       FOR ZLEST0060-DOC_REM,
        R_PESO_CCT      FOR ZLEST0060-PESO_CCT,
        R_TP_TRANSGENIA FOR ZLEST0060-TP_TRANSGENIA.

*-------------------------------------------------------------------
* Constantes
*-------------------------------------------------------------------
CONSTANTS: C_APLIC_SALDO_NFE     TYPE C VALUE 'APLIC_SALDO_NFE'    LENGTH 20,
           C_REMOV_APLIC_SALDO   TYPE C VALUE 'REMOV_APLIC_SALDO'  LENGTH 20,
           C_REMOV_CCT           TYPE C VALUE 'REMOV_CCT'          LENGTH 20,
           C_DISP_CCT            TYPE C VALUE 'DISP_CCT'           LENGTH 20.

SELECTION-SCREEN: BEGIN OF SCREEN 0001 AS SUBSCREEN.

SELECT-OPTIONS: P_BUKRS  FOR ZLEST0060-BUKRS_ROM NO-EXTENSION NO INTERVALS OBLIGATORY,
                P_BRANCH FOR ZLEST0060-BRANCH_ROM NO-EXTENSION NO INTERVALS OBLIGATORY,
                P_REMET  FOR ZLEST0060-RM_CODIGO NO-EXTENSION NO INTERVALS,
                P_MATNR  FOR ZLEST0060-MATNR NO-EXTENSION NO INTERVALS OBLIGATORY,
                P_DTDES  FOR ZLEST0060-DT_CHEGADA OBLIGATORY DEFAULT SY-DATUM.

PARAMETERS: P_TPCLA(2) AS LISTBOX VISIBLE LENGTH 30 OBLIGATORY.

SELECTION-SCREEN BEGIN OF LINE.
SELECTION-SCREEN END OF LINE.

SELECTION-SCREEN BEGIN OF LINE.
PARAMETERS: P_PROP RADIOBUTTON GROUP RB1 DEFAULT 'X'.
SELECTION-SCREEN COMMENT 3(10) TEXT-002 FOR FIELD   P_PROP.

PARAMETERS: P_TERC RADIOBUTTON GROUP RB1.
SELECTION-SCREEN COMMENT 15(10) TEXT-003 FOR FIELD  P_TERC.
SELECTION-SCREEN END OF LINE.

PARAMETERS: P_SALDO TYPE P DECIMALS 3.

PARAMETERS: P_PENDE AS CHECKBOX DEFAULT 'X'.

*SELECTION-SCREEN BEGIN OF LINE.
*
*SELECTION-SCREEN COMMENT 1(20) TEXT-004 FOR FIELD P_SALDO.
*PARAMETERS: P_SALDO TYPE P DECIMALS 3.
*
*SELECTION-SCREEN COMMENT 1(20) TEXT-004 FOR FIELD P_SALDO.
*PARAMETERS: P_PESO_C TYPE P DECIMALS 3.
*
*SELECTION-SCREEN END OF LINE.



SELECTION-SCREEN: END OF SCREEN 0001.

AT SELECTION-SCREEN OUTPUT.

  LOOP AT SCREEN.
    CASE SCREEN-NAME.
      WHEN 'P_SALDO'.
        SCREEN-INPUT = '0'.
        MODIFY SCREEN.
      ENDCASE.
  ENDLOOP.

INITIALIZATION.

  CALL SCREEN 0100.
