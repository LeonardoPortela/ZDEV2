*&---------------------------------------------------------------------*
*& Report  ZRD_ZSDT0245_EXIT.
*&
*&---------------------------------------------------------------------*
*&
*&
*&---------------------------------------------------------------------*
REPORT ZRD_ZSDT0245_EXIT.


FORM F_EXIT_ZSDT0245_0001 CHANGING P_REGISTRO_MANTER TYPE ANY.
"
*  DATA: WL_ZSDT0245 TYPE ZSDT0245.
*
*  CLEAR: WL_ZSDT0245.
*
*  WL_ZSDT0245-DATA = SY-DATUM.
*  WL_ZSDT0245-HORA = SY-UZEIT.
*  WL_ZSDT0245-USUARIO = SY-UNAME.
*
*  MOVE-CORRESPONDING WL_ZSDT0245 TO P_REGISTRO_MANTER.


ENDFORM.

FORM F_EXIT_ZSDT0245_0002 USING P_REGISTRO_MANTER TYPE ANY
                       CHANGING P_ERROR.

  DATA: WL_ZSDT0245 TYPE ZSDT0245.

  CLEAR: WL_ZSDT0245.

  MOVE-CORRESPONDING P_REGISTRO_MANTER TO WL_ZSDT0245.

  CLEAR: P_ERROR.

  IF WL_ZSDT0245-MATNR IS INITIAL AND WL_ZSDT0245-MATKL IS INITIAL.
    P_ERROR = ABAP_TRUE.
    MESSAGE 'Informar o material ou grupo!' TYPE 'S'.
    EXIT.
  ENDIF.

  IF WL_ZSDT0245-MATNR IS NOT INITIAL AND WL_ZSDT0245-MATKL IS NOT INITIAL.
    P_ERROR = ABAP_TRUE.
    MESSAGE 'Informar o material ou grupo!' TYPE 'S'.
    EXIT.
  ENDIF.


ENDFORM.

FORM F_EXIT_ZSDT0245_0003 CHANGING P_REGISTRO_MANTER TYPE ANY.
*
*  DATA: WL_ZSDT0245 TYPE ZSDT0245.
*
*  CLEAR: WL_ZSDT0245.
*
*  MOVE-CORRESPONDING P_REGISTRO_MANTER TO WL_ZSDT0245.
*
**  WL_ZSDT0245-DATA = SY-DATUM.
**  WL_ZSDT0245-HORA = SY-UZEIT.
**  WL_ZSDT0245-USUARIO = SY-UNAME.
*
*  MOVE-CORRESPONDING WL_ZSDT0245 TO P_REGISTRO_MANTER.

ENDFORM.

FORM F_EXIT_ZSDT0245_0004 CHANGING P_SAIDA TYPE ANY.

  DATA: WL_ZSDT0245_OUT TYPE ZMME0245,
        V_MATNR         TYPE MARA-MATNR.



  CLEAR: WL_ZSDT0245_OUT.

  MOVE-CORRESPONDING P_SAIDA TO WL_ZSDT0245_OUT.

  SELECT SINGLE VTEXT
     INTO WL_ZSDT0245_OUT-VTEXT
    FROM T685T
    WHERE SPRAS = SY-LANGU
    AND   KVEWE = 'A' "Determinação preço
    AND   KAPPL = 'V' "SD
    AND   KSCHL = WL_ZSDT0245_OUT-KSCHL.


  CALL FUNCTION 'CONVERSION_EXIT_ALPHA_INPUT'
    EXPORTING
      INPUT  = WL_ZSDT0245_OUT-MATNR
    IMPORTING
      OUTPUT = V_MATNR.

  SELECT SINGLE MAKTX
    INTO WL_ZSDT0245_OUT-MAKTX
    FROM MAKT
    WHERE SPRAS = SY-LANGU
    AND   MATNR = V_MATNR.


  SELECT SINGLE WGBEZ
  INTO WL_ZSDT0245_OUT-WGBEZ
  FROM T023T
  WHERE SPRAS = SY-LANGU
  AND   MATKL = WL_ZSDT0245_OUT-MATKL.

  MOVE-CORRESPONDING WL_ZSDT0245_OUT TO P_SAIDA.

ENDFORM.
