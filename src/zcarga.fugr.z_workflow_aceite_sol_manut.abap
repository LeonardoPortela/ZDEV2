FUNCTION Z_WORKFLOW_ACEITE_SOL_MANUT .
*"----------------------------------------------------------------------
*"*"Interface local:
*"  IMPORTING
*"     REFERENCE(I_WORKFLOW_ID) TYPE  ZDE_SE_RECORDID_WORKFLOW
*"     REFERENCE(I_TP_APROVACAO) TYPE  ZDE_TP_ROM_ACEITE_MANUT
*"     REFERENCE(I_TP_RESPOSTA) TYPE  ZDE_TP_ROM_RESPOSTA
*"     REFERENCE(I_MOTIVO_RESPOSTA) TYPE  STRING
*"  EXPORTING
*"     REFERENCE(E_MENSAGEM) TYPE  STRING
*"     REFERENCE(E_MENSAGEM_ERRO) TYPE  STRING
*"     REFERENCE(E_SUCESSO) TYPE  CHAR01
*"----------------------------------------------------------------------
  DATA: LC_MOTIVO_RESPOSTA TYPE STRING.

  IF I_WORKFLOW_ID IS INITIAL.
    E_MENSAGEM = 'FAILURE'.
    MESSAGE S295(ZCARGA) INTO E_MENSAGEM_ERRO.
    EXIT.
  ENDIF.

  SELECT SINGLE * INTO @DATA(WA_ZSDT0001AB)
    FROM ZSDT0001ACB
   WHERE SE_RECORDID EQ @I_WORKFLOW_ID.

  IF ( SY-SUBRC IS NOT INITIAL ).
    E_MENSAGEM = 'FAILURE'.
    MESSAGE S181(ZCARGA) WITH I_WORKFLOW_ID INTO E_MENSAGEM_ERRO.
    EXIT.
  ENDIF.

  E_SUCESSO  = '0'.

  CALL FUNCTION 'SCP_REPLACE_STRANGE_CHARS'
    EXPORTING
      INTEXT            = I_MOTIVO_RESPOSTA
    IMPORTING
      OUTTEXT           = LC_MOTIVO_RESPOSTA
    EXCEPTIONS
      INVALID_CODEPAGE  = 1
      CODEPAGE_MISMATCH = 2
      INTERNAL_ERROR    = 3
      CANNOT_CONVERT    = 4
      FIELDS_NOT_TYPE_C = 5
      OTHERS            = 6.

  TRY .
      ZCL_CARGA_RECEBIMENTO_V0001=>ZIF_CARGA~GET_INSTANCE(
       )->SET_REGISTRO_MANUTENCAO( I_ID_SOLICITACAO = WA_ZSDT0001AB-ID_SOLICITACAO
       )->SET_ACEITE_SOLI_MANUTENCAO(
           EXPORTING
             I_TP_APROVACAO    = I_TP_APROVACAO
             I_TP_RESPOSTA     = I_TP_RESPOSTA
             I_MOTIVO_RESPOSTA = CONV #( LC_MOTIVO_RESPOSTA )
           IMPORTING
             E_MENSSAGEM_RETORNO = DATA(E_MENSSAGEM_RETORNO)
       ).

      IF E_MENSSAGEM_RETORNO IS INITIAL.
        E_MENSAGEM = 'SUCCESS'.
      ELSE.
        E_MENSAGEM = E_MENSSAGEM_RETORNO.
      ENDIF.
      E_SUCESSO  = '1'.

    CATCH ZCX_CARGA INTO DATA(EX_CARGA) .
      E_MENSAGEM = 'FAILURE'.
      MESSAGE ID EX_CARGA->MSGID TYPE 'S'
       NUMBER EX_CARGA->MSGNO
         WITH EX_CARGA->MSGV1 EX_CARGA->MSGV2 EX_CARGA->MSGV3 EX_CARGA->MSGV4
         INTO E_MENSAGEM_ERRO.
    CATCH ZCX_MIRO_EXCEPTION INTO DATA(EX_MIRO_EXCEPTION) .
      E_MENSAGEM = 'FAILURE'.
      MESSAGE ID EX_MIRO_EXCEPTION->MSGID TYPE 'S'
       NUMBER EX_MIRO_EXCEPTION->MSGNO
         WITH EX_MIRO_EXCEPTION->MSGV1 EX_MIRO_EXCEPTION->MSGV2 EX_MIRO_EXCEPTION->MSGV3 EX_MIRO_EXCEPTION->MSGV4
         INTO E_MENSAGEM_ERRO.
    CATCH ZCX_JOB INTO DATA(EX_JOB) .
      E_MENSAGEM = 'FAILURE'.
      MESSAGE ID EX_JOB->MSGID TYPE 'S'
       NUMBER EX_JOB->MSGNO
         WITH EX_JOB->MSGV1 EX_JOB->MSGV2 EX_JOB->MSGV3 EX_JOB->MSGV4
         INTO E_MENSAGEM_ERRO.
    CATCH ZCX_PEDIDO_COMPRA_EXCEPTION INTO DATA(EX_PEDIDO_COMPRA_EXCEPTION) .
      E_MENSAGEM = 'FAILURE'.
      MESSAGE ID EX_PEDIDO_COMPRA_EXCEPTION->MSGID TYPE 'S'
       NUMBER EX_PEDIDO_COMPRA_EXCEPTION->MSGNO
         WITH EX_PEDIDO_COMPRA_EXCEPTION->MSGV1 EX_PEDIDO_COMPRA_EXCEPTION->MSGV2 EX_PEDIDO_COMPRA_EXCEPTION->MSGV3 EX_PEDIDO_COMPRA_EXCEPTION->MSGV4
         INTO E_MENSAGEM_ERRO.
    CATCH ZCX_CADASTRO INTO DATA(EX_CADASTRO) .
      E_MENSAGEM = 'FAILURE'.
      MESSAGE ID EX_CADASTRO->MSGID TYPE 'S'
       NUMBER EX_CADASTRO->MSGNO
         WITH EX_CADASTRO->MSGV1 EX_CADASTRO->MSGV2 EX_CADASTRO->MSGV3 EX_CADASTRO->MSGV4
         INTO E_MENSAGEM_ERRO.
    CATCH ZCX_ORDEM_CARREGAMENTO INTO DATA(EX_ORDEM_CARREGAMENTO) .
      E_MENSAGEM = 'FAILURE'.
      MESSAGE ID EX_ORDEM_CARREGAMENTO->MSGID TYPE 'S'
       NUMBER EX_ORDEM_CARREGAMENTO->MSGNO
         WITH EX_ORDEM_CARREGAMENTO->MSGV1 EX_ORDEM_CARREGAMENTO->MSGV2 EX_ORDEM_CARREGAMENTO->MSGV3 EX_ORDEM_CARREGAMENTO->MSGV4
         INTO E_MENSAGEM_ERRO.
    CATCH ZCX_ORDEM_VENDA INTO DATA(EX_ORDEM_VENDA) .
      E_MENSAGEM = 'FAILURE'.
      MESSAGE ID EX_ORDEM_VENDA->MSGID TYPE 'S'
       NUMBER EX_ORDEM_VENDA->MSGNO
         WITH EX_ORDEM_VENDA->MSGV1 EX_ORDEM_VENDA->MSGV2 EX_ORDEM_VENDA->MSGV3 EX_ORDEM_VENDA->MSGV4
         INTO E_MENSAGEM_ERRO.
    CATCH ZCX_PARCEIROS INTO DATA(EX_PARCEIROS) .
      E_MENSAGEM = 'FAILURE'.
      MESSAGE ID EX_PARCEIROS->MSGID TYPE 'S'
       NUMBER EX_PARCEIROS->MSGNO
         WITH EX_PARCEIROS->MSGV1 EX_PARCEIROS->MSGV2 EX_PARCEIROS->MSGV3 EX_PARCEIROS->MSGV4
         INTO E_MENSAGEM_ERRO.
  ENDTRY.


ENDFUNCTION.
