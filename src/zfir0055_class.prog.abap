*&---------------------------------------------------------------------*
*&  Include           ZFIR0055_CLASS
*&---------------------------------------------------------------------*

CLASS LCL_ALV_TOOLBAR IMPLEMENTATION.
  METHOD CONSTRUCTOR.
*   Create ALV toolbar manager instance
    CREATE OBJECT C_ALV_TOOLBARMANAGER
      EXPORTING
        IO_ALV_GRID = IO_ALV_GRID.
  ENDMETHOD.                    "constructor

  METHOD ON_TOOLBAR.

    TY_TOOLBAR-ICON      = ICON_WIZARD.
    TY_TOOLBAR-FUNCTION  = 'ATRIB_CLASS'.
    TY_TOOLBAR-TEXT      = 'Atribuir Classificação'.
    TY_TOOLBAR-BUTN_TYPE = 0.
    APPEND TY_TOOLBAR TO E_OBJECT->MT_TOOLBAR.
    CLEAR TY_TOOLBAR.

    TY_TOOLBAR-ICON      = ICON_CREATE.
    TY_TOOLBAR-FUNCTION  = 'INC_MANUAL'.
    TY_TOOLBAR-TEXT      = 'Lcto.Manual'.
    TY_TOOLBAR-BUTN_TYPE = 0.
    APPEND TY_TOOLBAR TO E_OBJECT->MT_TOOLBAR.
    CLEAR TY_TOOLBAR.

    TY_TOOLBAR-ICON      = ICON_CREATE.
    TY_TOOLBAR-FUNCTION  = 'INC_SALDO'.
    TY_TOOLBAR-TEXT      = 'Inclusão Saldo'.
    TY_TOOLBAR-BUTN_TYPE = 0.
    APPEND TY_TOOLBAR TO E_OBJECT->MT_TOOLBAR.
    CLEAR TY_TOOLBAR.

    TY_TOOLBAR-ICON      = ICON_REFRESH.
    TY_TOOLBAR-FUNCTION  = 'ATUALIZAR'.
    TY_TOOLBAR-QUICKINFO = 'Atualizar'.
    TY_TOOLBAR-TEXT      = 'Atualizar'.

    TY_TOOLBAR-BUTN_TYPE = 0.
    APPEND TY_TOOLBAR TO E_OBJECT->MT_TOOLBAR.
    CLEAR TY_TOOLBAR.

*    CALL METHOD C_ALV_TOOLBARMANAGER->REORGANIZE
*      EXPORTING
*        IO_ALV_TOOLBAR = E_OBJECT.

  ENDMETHOD.                    "on_toolbar

  METHOD HANDLE_USER_COMMAND.

    CASE E_UCOMM.
      WHEN 'ATRIB_CLASS'.
        PERFORM INF_CLASSIFICAO_FLX.
        LEAVE TO SCREEN 0100.
      WHEN 'INC_MANUAL'.
        CLEAR: ZFIT0121.
        CALL SCREEN 0102  STARTING AT 20 08 ENDING AT 54 13.
        PERFORM RENOVAR.
      WHEN 'INC_SALDO'.
        CLEAR: ZFIT0080, T_SAIDA_0103[].
        CALL SCREEN 0103 STARTING AT 05 05 ENDING AT 90 22.

      WHEN 'ATUALIZAR'.
        PERFORM RENOVAR.

    ENDCASE.

  ENDMETHOD.                    "HANDLE_USER_COMMAND

ENDCLASS.                    "lcl_alv_toolbar IMPLEMENTATION

CLASS LCL_ALV_TOOLBAR_0103 IMPLEMENTATION.
  METHOD CONSTRUCTOR.
*   Create ALV toolbar manager instance
    CREATE OBJECT C_ALV_TOOLBARMANAGER
      EXPORTING
        IO_ALV_GRID = IO_ALV_GRID.
  ENDMETHOD.                    "constructor

  METHOD ON_TOOLBAR.

    "TY_TOOLBAR-BUTN_TYPE = 0.
    "APPEND TY_TOOLBAR TO E_OBJECT->MT_TOOLBAR.
    "CLEAR TY_TOOLBAR.

    CALL METHOD C_ALV_TOOLBARMANAGER->REORGANIZE
      EXPORTING
        IO_ALV_TOOLBAR = E_OBJECT.

  ENDMETHOD.                    "on_toolbar

  METHOD HANDLE_USER_COMMAND.

    CASE E_UCOMM.
      WHEN OTHERS.

    ENDCASE.

  ENDMETHOD.                    "HANDLE_USER_COMMAND

ENDCLASS.                    "lcl_alv_toolbar IMPLEMENTATION

CLASS LCL_EVENT_HANDLER IMPLEMENTATION.                 "

  METHOD HANDLE_HOTSPOT_CLICK.
    PERFORM HANDLE_HOTSPOT_CLICK USING E_ROW_ID E_COLUMN_ID ES_ROW_NO.
  ENDMETHOD.

ENDCLASS.           "lcl_event_handler_0102 IMPLEMENTA
