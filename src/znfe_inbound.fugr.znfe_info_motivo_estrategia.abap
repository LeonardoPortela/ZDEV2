FUNCTION ZNFE_INFO_MOTIVO_ESTRATEGIA.
*"----------------------------------------------------------------------
*"*"Interface local:
*"  IMPORTING
*"     REFERENCE(I_MOTIVO) TYPE  ZDE_MOTIVO_REJEICAO_FISCAL
*"     REFERENCE(I_CHAVE_NFE) TYPE  ZDE_CHAVE_DOC_E
*"  EXPORTING
*"     REFERENCE(E_TP_AUTORIZACAO) TYPE  ZDE_TP_AUTORIZACAO
*"     REFERENCE(E_TLINE) TYPE  TLINE_T
*"----------------------------------------------------------------------

  CK_SELECIONOU_APROVACAO = ABAP_FALSE.
  CK_VIEW_APROVACAO       = ABAP_FALSE.

  CALL FUNCTION 'GET_DOMAIN_VALUES'
    EXPORTING
      DOMNAME    = 'ZDM_MOTIVO_REJEICAO_FISCAL'
    TABLES
      VALUES_TAB = IT_DD07V.

  READ TABLE IT_DD07V INTO WA_DD07V WITH KEY DOMVALUE_L = I_MOTIVO.

  CLEAR: E_TP_AUTORIZACAO, E_TLINE, WA_ULTIMA_APROVACAO, SEL_TP_AUTORIZACAO.

  SELECT SINGLE * INTO WA_ULTIMA_APROVACAO
    FROM ZIB_NFE_DIST_EAP
   WHERE CD_CHAVE_NFE EQ I_CHAVE_NFE
     AND TP_APROVACAO EQ I_MOTIVO
     AND CK_ULTIMO    EQ ABAP_TRUE.

  CALL SCREEN 9003 STARTING AT 5 5.

  IF CK_SELECIONOU_APROVACAO EQ ABAP_TRUE.
    E_TP_AUTORIZACAO = SEL_TP_AUTORIZACAO.
    MOVE TL_TLINES[] TO E_TLINE[].
  ENDIF.

ENDFUNCTION.
