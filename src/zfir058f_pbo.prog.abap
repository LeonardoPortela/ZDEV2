*&---------------------------------------------------------------------*
*&  Include           ZFIR058_PBO
*&---------------------------------------------------------------------*

MODULE STATUS_0100 OUTPUT.
  SET PF-STATUS 'PF0100'.
  SET TITLEBAR 'T0100'.
ENDMODULE.

MODULE PBO_0100 OUTPUT.

  PERFORM F_REFRESH_OBJETOS.
  IF OBJ_CONTAINER_0100 IS INITIAL.

    PERFORM F_CRIAR_CATALOG USING '0100'.

    CREATE OBJECT OBJ_CONTAINER_0100
      EXPORTING
        CONTAINER_NAME = 'CC_ALV_0100'.

    CREATE OBJECT OBJ_ALV_0100
      EXPORTING
        I_PARENT = OBJ_CONTAINER_0100.

    CREATE OBJECT OBJ_TOOLBAR_0100
      EXPORTING
        IO_ALV_GRID = OBJ_ALV_0100.

    GS_LAYOUT-SEL_MODE   = 'A'.
    GS_VARIANT-REPORT  = SY-REPID.
    WA_STABLE-ROW         = 'X'.
    WA_STABLE-COL         = 'X'.

    SET HANDLER: OBJ_TOOLBAR_0100->ON_TOOLBAR          FOR OBJ_ALV_0100,
                 OBJ_TOOLBAR_0100->HANDLE_USER_COMMAND FOR OBJ_ALV_0100.

    PERFORM F_EXCLUDE_FCODE USING '0100'.

    CALL METHOD OBJ_ALV_0100->SET_TABLE_FOR_FIRST_DISPLAY
      EXPORTING
        IS_LAYOUT            = GS_LAYOUT
        I_SAVE               = 'A'
        IT_TOOLBAR_EXCLUDING = IT_EXCLUDE_FCODE
        IS_VARIANT           = GS_VARIANT
      CHANGING
        IT_FIELDCATALOG      = IT_FCAT
        IT_OUTTAB            = IT_SAIDA_0100.

    SET HANDLER: LCL_EVENT_HANDLER_0100=>HANDLE_HOTSPOT_CLICK FOR OBJ_ALV_0100.

    CALL METHOD OBJ_ALV_0100->REGISTER_EDIT_EVENT
      EXPORTING
        I_EVENT_ID = CL_GUI_ALV_GRID=>MC_EVT_MODIFIED.

    CALL METHOD OBJ_ALV_0100->REGISTER_EDIT_EVENT
      EXPORTING
        I_EVENT_ID = CL_GUI_ALV_GRID=>MC_EVT_ENTER.

  ELSE.
    CALL METHOD OBJ_ALV_0100->REFRESH_TABLE_DISPLAY
      EXPORTING
        IS_STABLE = WA_STABLE.
  ENDIF.

ENDMODULE.

MODULE STATUS_0110 OUTPUT.
  SET PF-STATUS 'PF0110'.
  SET TITLEBAR 'T0110'.
ENDMODULE.

MODULE PBO_0110 OUTPUT.

  IF OBJ_CONTAINER_0110 IS INITIAL.

    PERFORM F_REFRESH_OBJETOS.
    PERFORM F_CRIAR_CATALOG USING '0110'.

    CREATE OBJECT OBJ_CONTAINER_0110
      EXPORTING
        CONTAINER_NAME = 'CC_ALV_0110'.

    CREATE OBJECT OBJ_ALV_0110
      EXPORTING
        I_PARENT = OBJ_CONTAINER_0110.

    CREATE OBJECT OBJ_TOOLBAR_0110
      EXPORTING
        IO_ALV_GRID = OBJ_ALV_0110.

    GS_LAYOUT-SEL_MODE    = 'A'.
    GS_LAYOUT-STYLEFNAME  = 'ESTILO'.
    GS_VARIANT-REPORT     = SY-REPID.
    WA_STABLE-ROW         = 'X'.
    WA_STABLE-COL         = 'X'.

    PERFORM F_EXCLUDE_FCODE USING '0110'.

    SET HANDLER: OBJ_TOOLBAR_0110->ON_TOOLBAR          FOR OBJ_ALV_0110,
                 OBJ_TOOLBAR_0110->HANDLE_USER_COMMAND FOR OBJ_ALV_0110.

    CALL METHOD OBJ_ALV_0110->SET_TABLE_FOR_FIRST_DISPLAY
      EXPORTING
        IS_LAYOUT            = GS_LAYOUT
        I_SAVE               = 'A'
        IT_TOOLBAR_EXCLUDING = IT_EXCLUDE_FCODE
        IS_VARIANT           = GS_VARIANT
      CHANGING
        IT_FIELDCATALOG      = IT_FCAT
        IT_OUTTAB            = IT_SAIDA_0110.


    CALL METHOD OBJ_ALV_0110->REGISTER_EDIT_EVENT
      EXPORTING
        I_EVENT_ID = CL_GUI_ALV_GRID=>MC_EVT_MODIFIED.

    CALL METHOD OBJ_ALV_0110->REGISTER_EDIT_EVENT
      EXPORTING
        I_EVENT_ID = CL_GUI_ALV_GRID=>MC_EVT_ENTER.

    SET HANDLER: LCL_EVENT_HANDLER_0110=>ON_DATA_CHANGED_FINISHED FOR OBJ_ALV_0110,
                 LCL_EVENT_HANDLER_0110=>HANDLE_HOTSPOT_CLICK     FOR OBJ_ALV_0110.


  ELSE.
    CALL METHOD OBJ_ALV_0110->REFRESH_TABLE_DISPLAY
      EXPORTING
        IS_STABLE = WA_STABLE.

    PERFORM F_ATUALIZA_SALDO.
  ENDIF.

ENDMODULE.

MODULE STATUS_0120 OUTPUT.
  SET PF-STATUS 'PF0120'.
  SET TITLEBAR 'T0120'.
ENDMODULE.

MODULE PBO_0120 OUTPUT.

  IF OBJ_CONTAINER_0120 IS INITIAL.

    PERFORM F_REFRESH_OBJETOS.
    PERFORM F_CRIAR_CATALOG USING '0120'.

    CREATE OBJECT OBJ_CONTAINER_0120
      EXPORTING
        CONTAINER_NAME = 'CC_ALV_0120'.

    CREATE OBJECT OBJ_ALV_0120
      EXPORTING
        I_PARENT = OBJ_CONTAINER_0120.

    CREATE OBJECT OBJ_TOOLBAR_0120
      EXPORTING
        IO_ALV_GRID = OBJ_ALV_0120.

    GS_LAYOUT-SEL_MODE    = 'A'.
    GS_LAYOUT-STYLEFNAME  = 'ESTILO'.
    GS_VARIANT-REPORT     = SY-REPID.
    WA_STABLE-ROW         = 'X'.
    WA_STABLE-COL         = 'X'.

    PERFORM F_EXCLUDE_FCODE USING '0120'.

    SET HANDLER: OBJ_TOOLBAR_0120->ON_TOOLBAR          FOR OBJ_ALV_0120,
                 OBJ_TOOLBAR_0120->HANDLE_USER_COMMAND FOR OBJ_ALV_0120.

    CALL METHOD OBJ_ALV_0120->SET_TABLE_FOR_FIRST_DISPLAY
      EXPORTING
        IS_LAYOUT            = GS_LAYOUT
        I_SAVE               = 'A'
        IT_TOOLBAR_EXCLUDING = IT_EXCLUDE_FCODE
        IS_VARIANT           = GS_VARIANT
      CHANGING
        IT_FIELDCATALOG      = IT_FCAT
        IT_OUTTAB            = IT_SAIDA_0120.


    CALL METHOD OBJ_ALV_0120->REGISTER_EDIT_EVENT
      EXPORTING
        I_EVENT_ID = CL_GUI_ALV_GRID=>MC_EVT_MODIFIED.

    CALL METHOD OBJ_ALV_0120->REGISTER_EDIT_EVENT
      EXPORTING
        I_EVENT_ID = CL_GUI_ALV_GRID=>MC_EVT_ENTER.

    SET HANDLER: LCL_EVENT_HANDLER_0120=>HANDLE_HOTSPOT_CLICK     FOR OBJ_ALV_0120.


  ELSE.
    CALL METHOD OBJ_ALV_0120->REFRESH_TABLE_DISPLAY
      EXPORTING
        IS_STABLE = WA_STABLE.
  ENDIF.

ENDMODULE.
