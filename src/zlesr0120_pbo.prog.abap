*&---------------------------------------------------------------------*
*&  Include           ZLESR0120_PBO
*&---------------------------------------------------------------------*


MODULE PBO_0100 OUTPUT.

  IF OBJ_ALV_0100 IS INITIAL.

    PERFORM F_REFRESH_OBJETOS.
    PERFORM F_CRIAR_CATALOG USING '0100'.

    IF OBJ_CONTAINER_0100 IS INITIAL.
      CREATE OBJECT OBJ_CONTAINER_0100
        EXPORTING
          CONTAINER_NAME = 'CC_ALV_0100'.
    ENDIF.

    CREATE OBJECT OBJ_ALV_0100
      EXPORTING
        I_PARENT = OBJ_CONTAINER_0100.

    CREATE OBJECT OBJ_TOOLBAR_0100
      EXPORTING
        IO_ALV_GRID = OBJ_ALV_0100.

    GS_LAYOUT-SEL_MODE   = 'A'.
    GS_LAYOUT-CTAB_FNAME = 'COLOR'.
    GS_VARIANT-REPORT    = SY-REPID.
    WA_STABLE-ROW        = 'X'.
    WA_STABLE-COL        = 'X'.

    SET HANDLER: OBJ_TOOLBAR_0100->ON_TOOLBAR          FOR OBJ_ALV_0100,
                 OBJ_TOOLBAR_0100->HANDLE_USER_COMMAND FOR OBJ_ALV_0100,
                 LCL_EVENT_HANDLER_0100=>CATCH_HOTSPOT FOR OBJ_ALV_0100.

    PERFORM F_EXCLUDE_FCODE USING '0100'.

    CALL METHOD OBJ_ALV_0100->SET_TABLE_FOR_FIRST_DISPLAY
      EXPORTING
        IS_LAYOUT            = GS_LAYOUT
        I_SAVE               = 'A'
        IT_TOOLBAR_EXCLUDING = IT_EXCLUDE_FCODE
        IS_VARIANT           = GS_VARIANT
      CHANGING
        IT_FIELDCATALOG      = IT_FCAT
        IT_OUTTAB            = IT_SAIDA_0100.

    CALL METHOD OBJ_ALV_0100->REGISTER_EDIT_EVENT
      EXPORTING
        I_EVENT_ID = CL_GUI_ALV_GRID=>MC_EVT_MODIFIED.

    CALL METHOD OBJ_ALV_0100->REGISTER_EDIT_EVENT
      EXPORTING
        I_EVENT_ID = CL_GUI_ALV_GRID=>MC_EVT_ENTER.

  ELSE.
    CALL METHOD OBJ_ALV_0100->REFRESH_TABLE_DISPLAY
       EXPORTING
         IS_STABLE = WA_STABLE.
  ENDIF.

ENDMODULE.

MODULE STATUS_0100 OUTPUT.
  SET PF-STATUS 'PF0100'.
  SET TITLEBAR 'T0100'.

  IF VG_INIT_SCREEN IS INITIAL.

    CLEAR: IT_VRM_VALUE[].

    WL_VRM_VALUE-KEY  = 'CO'.
    WL_VRM_VALUE-TEXT = 'Convencional'.
    APPEND WL_VRM_VALUE TO IT_VRM_VALUE.

    WL_VRM_VALUE-KEY  = 'R1'.
    WL_VRM_VALUE-TEXT = 'RR'.
    APPEND WL_VRM_VALUE TO IT_VRM_VALUE.

    WL_VRM_VALUE-KEY  = 'R2'.
    WL_VRM_VALUE-TEXT = 'RR2'.
    APPEND WL_VRM_VALUE TO IT_VRM_VALUE.

    CALL FUNCTION 'VRM_SET_VALUES'
      EXPORTING
        ID      = 'P_TPCLA'
        VALUES  = IT_VRM_VALUE
      EXCEPTIONS
        ID_ILLEGAL_NAME = 1
        OTHERS = 2.

    VG_INIT_SCREEN = 'X'.

  ENDIF.

ENDMODULE.
