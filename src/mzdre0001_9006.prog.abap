*----------------------------------------------------------------------*
***INCLUDE MZDRE0001_9006 .
*----------------------------------------------------------------------*

*&---------------------------------------------------------------------*
*&      Module  USER_COMMAND_9006_EXIT  INPUT
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
MODULE USER_COMMAND_9006_EXIT INPUT.
  LEAVE TO SCREEN 0.
ENDMODULE.                 " USER_COMMAND_9006_EXIT  INPUT

*&---------------------------------------------------------------------*
*&      Module  USER_COMMAND_9006  INPUT
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
MODULE USER_COMMAND_9006 INPUT.

  DATA: VG_CC TYPE ZGL015_DRE_EST03,
        CC_CADAS TYPE CHAR50.


  IF OK_CODE_9006 EQ C_CONF.


    IF NOT ( ZGL015_DRE_EST03-SAKNR IS INITIAL ).


      SELECT SINGLE * INTO VG_CC
        FROM ZGL015_DRE_EST03
       WHERE BUKRS EQ ZGL015_DRE_EST02-BUKRS
         AND VERSN EQ ZGL015_DRE_EST02-VERSN
         AND NIVEL EQ ZGL015_DRE_EST02-NIVEL
         AND KTOPL EQ ZGL015_DRE_EST03-KTOPL
         AND SAKNR EQ ZGL015_DRE_EST03-SAKNR.

      IF SY-SUBRC IS INITIAL.
        CLEAR: CC_CADAS.
        CONCATENATE 'Conta Razão já cadastrada!' ZGL015_DRE_EST03-SAKNR INTO CC_CADAS.
        MESSAGE CC_CADAS TYPE 'E'.
      ENDIF.

      ZGL015_DRE_EST03-BUKRS = ZGL015_DRE_EST02-BUKRS.
      ZGL015_DRE_EST03-VERSN = ZGL015_DRE_EST02-VERSN.
      ZGL015_DRE_EST03-NIVEL = ZGL015_DRE_EST02-NIVEL.
      MODIFY ZGL015_DRE_EST03.

      PRIM_DRE_NIVEL_RE = C_X.
      MOVE-CORRESPONDING ZGL015_DRE_EST03 TO ZGL015_DRE_EST02.
    ENDIF.

    IF NOT ( LS_SAKNR_2 IS INITIAL ).

      SELECT SINGLE * INTO VG_CC
        FROM ZGL015_DRE_EST03
       WHERE BUKRS EQ ZGL015_DRE_EST02-BUKRS
         AND VERSN EQ ZGL015_DRE_EST02-VERSN
         AND NIVEL EQ ZGL015_DRE_EST02-NIVEL
         AND KTOPL EQ ZGL015_DRE_EST03-KTOPL
         AND SAKNR EQ LS_SAKNR_2.

      IF SY-SUBRC IS INITIAL.
        CLEAR: CC_CADAS.
        CONCATENATE 'Conta Razão já cadastrada!' LS_SAKNR_2 INTO CC_CADAS.
        MESSAGE CC_CADAS TYPE 'E'.
      ENDIF.

      ZGL015_DRE_EST03-BUKRS = ZGL015_DRE_EST02-BUKRS.
      ZGL015_DRE_EST03-VERSN = ZGL015_DRE_EST02-VERSN.
      ZGL015_DRE_EST03-NIVEL = ZGL015_DRE_EST02-NIVEL.
      ZGL015_DRE_EST03-SAKNR = LS_SAKNR_2.
      ZGL015_DRE_EST03-LEVAR_QTDE = VG_LEVAR_QTDE_2.
      MODIFY ZGL015_DRE_EST03.

      PRIM_DRE_NIVEL_RE = C_X.
      MOVE-CORRESPONDING ZGL015_DRE_EST03 TO ZGL015_DRE_EST02.
    ENDIF.


    IF NOT ( LS_SAKNR_3 IS INITIAL ).

      SELECT SINGLE * INTO VG_CC
        FROM ZGL015_DRE_EST03
       WHERE BUKRS EQ ZGL015_DRE_EST02-BUKRS
         AND VERSN EQ ZGL015_DRE_EST02-VERSN
         AND NIVEL EQ ZGL015_DRE_EST02-NIVEL
         AND KTOPL EQ ZGL015_DRE_EST03-KTOPL
         AND SAKNR EQ LS_SAKNR_3.

      IF SY-SUBRC IS INITIAL.
        CLEAR: CC_CADAS.
        CONCATENATE 'Conta Razão já cadastrada!' LS_SAKNR_3 INTO CC_CADAS.
        MESSAGE CC_CADAS TYPE 'E'.
      ENDIF.

      ZGL015_DRE_EST03-BUKRS = ZGL015_DRE_EST02-BUKRS.
      ZGL015_DRE_EST03-VERSN = ZGL015_DRE_EST02-VERSN.
      ZGL015_DRE_EST03-NIVEL = ZGL015_DRE_EST02-NIVEL.
      ZGL015_DRE_EST03-SAKNR = LS_SAKNR_3.
      ZGL015_DRE_EST03-LEVAR_QTDE = VG_LEVAR_QTDE_3.
      MODIFY ZGL015_DRE_EST03.


      PRIM_DRE_NIVEL_RE = C_X.
      MOVE-CORRESPONDING ZGL015_DRE_EST03 TO ZGL015_DRE_EST02.

    ENDIF.

    IF NOT ( LS_SAKNR_4 IS INITIAL ).


      SELECT SINGLE * INTO VG_CC
        FROM ZGL015_DRE_EST03
       WHERE BUKRS EQ ZGL015_DRE_EST02-BUKRS
         AND VERSN EQ ZGL015_DRE_EST02-VERSN
         AND NIVEL EQ ZGL015_DRE_EST02-NIVEL
         AND KTOPL EQ ZGL015_DRE_EST03-KTOPL
         AND SAKNR EQ LS_SAKNR_4.

      IF SY-SUBRC IS INITIAL.
        CLEAR: CC_CADAS.
        CONCATENATE 'Conta Razão já cadastrada!' LS_SAKNR_4 INTO CC_CADAS.
        MESSAGE CC_CADAS TYPE 'E'.
      ENDIF.

      ZGL015_DRE_EST03-BUKRS = ZGL015_DRE_EST02-BUKRS.
      ZGL015_DRE_EST03-VERSN = ZGL015_DRE_EST02-VERSN.
      ZGL015_DRE_EST03-NIVEL = ZGL015_DRE_EST02-NIVEL.
      ZGL015_DRE_EST03-SAKNR = LS_SAKNR_4.
      ZGL015_DRE_EST03-LEVAR_QTDE = VG_LEVAR_QTDE_4.
      MODIFY ZGL015_DRE_EST03.

      PRIM_DRE_NIVEL_RE = C_X.
      MOVE-CORRESPONDING ZGL015_DRE_EST03 TO ZGL015_DRE_EST02.

    ENDIF.

    IF NOT ( LS_SAKNR_5 IS INITIAL ).

      SELECT SINGLE * INTO VG_CC
        FROM ZGL015_DRE_EST03
       WHERE BUKRS EQ ZGL015_DRE_EST02-BUKRS
         AND VERSN EQ ZGL015_DRE_EST02-VERSN
         AND NIVEL EQ ZGL015_DRE_EST02-NIVEL
         AND KTOPL EQ ZGL015_DRE_EST03-KTOPL
         AND SAKNR EQ LS_SAKNR_5.

      IF SY-SUBRC IS INITIAL.
        CLEAR: CC_CADAS.
        CONCATENATE 'Conta Razão já cadastrada!' LS_SAKNR_5 INTO CC_CADAS.
        MESSAGE CC_CADAS TYPE 'E'.
      ENDIF.

      ZGL015_DRE_EST03-BUKRS = ZGL015_DRE_EST02-BUKRS.
      ZGL015_DRE_EST03-VERSN = ZGL015_DRE_EST02-VERSN.
      ZGL015_DRE_EST03-NIVEL = ZGL015_DRE_EST02-NIVEL.
      ZGL015_DRE_EST03-SAKNR = LS_SAKNR_5.
      ZGL015_DRE_EST03-LEVAR_QTDE = VG_LEVAR_QTDE_5.
      MODIFY ZGL015_DRE_EST03.

      PRIM_DRE_NIVEL_RE = C_X.
      MOVE-CORRESPONDING ZGL015_DRE_EST03 TO ZGL015_DRE_EST02.
    ENDIF.

    CALL METHOD G_TREE->DELETE_ALL_NODES.
    LEAVE TO SCREEN 0.
  ENDIF.

ENDMODULE.                 " USER_COMMAND_9006  INPUT

*&---------------------------------------------------------------------*
*&      Module  STATUS_9006  OUTPUT
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
MODULE STATUS_9006 OUTPUT.

  SET PF-STATUS 'PF9003'.
  SET TITLEBAR 'TL9006'.

  CLEAR: VG_PLANO_CONTA,
         VG_CONTA_RAZAO,
         VG_CONTA_RAZAO_2,
         VG_CONTA_RAZAO_3,
         VG_CONTA_RAZAO_4,
         VG_CONTA_RAZAO_5.


  IF NOT ZGL015_DRE_EST03-KTOPL IS INITIAL.

    SELECT SINGLE KTPLT INTO VG_PLANO_CONTA
      FROM T004T
     WHERE SPRAS EQ SY-LANGU
       AND KTOPL EQ ZGL015_DRE_EST03-KTOPL.

    IF NOT ZGL015_DRE_EST03-SAKNR IS INITIAL.

      SELECT SINGLE TXT50 INTO VG_CONTA_RAZAO
        FROM SKAT
       WHERE SPRAS EQ SY-LANGU
         AND KTOPL EQ ZGL015_DRE_EST03-KTOPL
         AND SAKNR EQ ZGL015_DRE_EST03-SAKNR.

      IF NOT ( LS_SAKNR_2 IS INITIAL ).
        SELECT SINGLE TXT50 INTO VG_CONTA_RAZAO_2
          FROM SKAT
         WHERE SPRAS EQ SY-LANGU
           AND KTOPL EQ ZGL015_DRE_EST03-KTOPL
           AND SAKNR EQ LS_SAKNR_2.

      ENDIF.

      IF NOT ( LS_SAKNR_3 IS INITIAL ).
        SELECT SINGLE TXT50 INTO VG_CONTA_RAZAO_3
          FROM SKAT
         WHERE SPRAS EQ SY-LANGU
           AND KTOPL EQ ZGL015_DRE_EST03-KTOPL
           AND SAKNR EQ LS_SAKNR_3.

      ENDIF.

      IF NOT ( LS_SAKNR_4 IS INITIAL ).
        SELECT SINGLE TXT50 INTO VG_CONTA_RAZAO_4
          FROM SKAT
         WHERE SPRAS EQ SY-LANGU
           AND KTOPL EQ ZGL015_DRE_EST03-KTOPL
           AND SAKNR EQ LS_SAKNR_4.
      ENDIF.

      IF NOT ( LS_SAKNR_5 IS INITIAL ).
        SELECT SINGLE TXT50 INTO VG_CONTA_RAZAO_5
          FROM SKAT
         WHERE SPRAS EQ SY-LANGU
           AND KTOPL EQ ZGL015_DRE_EST03-KTOPL
           AND SAKNR EQ LS_SAKNR_5.

      ENDIF.



    ENDIF.
  ENDIF.

ENDMODULE.                 " STATUS_9006  OUTPUT
