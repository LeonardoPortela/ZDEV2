

DATA: WL_LFA1            TYPE LFA1,
      IT_ZCTE_INFO_NOTA  TYPE TABLE OF ZCTE_INFO_NOTA,
      WL_ZCTE_INFO_NOTA  TYPE ZCTE_INFO_NOTA,
      WL_ZCTE_IDENTIFICA TYPE ZCTE_IDENTIFICA.

CLEAR: WA_SAIDA, IT_ZCTE_INFO_NOTA[].
SELECT SINGLE
       DOCNUM MT_NOME MT_CNH MT_UF_CNH MT_CPF MT_RG MT_UF_RG
       EMISSOR  DT_ORIGEM
  FROM ZCTE_CIOT
  INTO WA_SAIDA
  WHERE DOCNUM    = I_DOCNUM.

CHECK SY-SUBRC = 0.

SELECT SINGLE *
  FROM LFA1
  INTO WL_LFA1
  WHERE LIFNR = WA_SAIDA-EMISSOR.

SELECT *
  FROM ZCTE_INFO_NOTA
  INTO TABLE IT_ZCTE_INFO_NOTA
  WHERE DOCNUM  = I_DOCNUM.

  SELECT SINGLE *
    FROM ZCTE_IDENTIFICA
    INTO WL_ZCTE_IDENTIFICA
   WHERE DOCNUM  = I_DOCNUM.

WA_SAIDA-NAME1   = WL_LFA1-NAME1.
"WA_SAIDA-NUMERO  = WL_ZCTE_INFO_NOTA-NUMERO.
"WA_SAIDA-SERIE   = WL_ZCTE_INFO_NOTA-SERIE.

CLEAR: WA_SAIDA-NF_CTE.
LOOP AT IT_ZCTE_INFO_NOTA INTO WL_ZCTE_INFO_NOTA .
  IF WA_SAIDA-NF_CTE IS INITIAL.
    WA_SAIDA-NF_CTE = WL_ZCTE_INFO_NOTA-NUMERO && '-' && WL_ZCTE_INFO_NOTA-SERIE.
  ELSE.
    WA_SAIDA-NF_CTE = WA_SAIDA-NF_CTE && ',' && WL_ZCTE_INFO_NOTA-NUMERO && '-' && WL_ZCTE_INFO_NOTA-SERIE.
  ENDIF.
ENDLOOP.

WA_SAIDA-NMUNENV = WL_ZCTE_IDENTIFICA-NMUNENV.
WA_SAIDA-UFINI   = WL_ZCTE_IDENTIFICA-UFINI.
WA_SAIDA-DHEMI   = WL_ZCTE_IDENTIFICA-DHEMI.







