*&---------------------------------------------------------------------*
*&  Include           ZGL032_CLASS
*&---------------------------------------------------------------------*

CLASS LCL_ALV_TOOLBAR IMPLEMENTATION.
  METHOD CONSTRUCTOR.
*   Create ALV toolbar manager instance
    CREATE OBJECT C_ALV_TOOLBARMANAGER
      EXPORTING
        IO_ALV_GRID = IO_ALV_GRID.
  ENDMETHOD.                    "constructor

  METHOD ON_TOOLBAR.

    TY_TOOLBAR-ICON      = ICON_SYSTEM_SAVE.
    TY_TOOLBAR-FUNCTION  = 'RECLAS'.
    TY_TOOLBAR-TEXT      = 'Gerar Rcl.Cta.Variação'.

    IF R_AR2 IS INITIAL.
      TY_TOOLBAR-DISABLED  = 'X'.
    ENDIF.

    TY_TOOLBAR-BUTN_TYPE = 0.
    APPEND TY_TOOLBAR TO E_OBJECT->MT_TOOLBAR.
    CLEAR TY_TOOLBAR.

    TY_TOOLBAR-ICON      = ICON_STORNO.
    TY_TOOLBAR-FUNCTION  = 'ESTORNAR_CONTABIL'.
    TY_TOOLBAR-QUICKINFO = 'Estornar Documento Contábil'.
    TY_TOOLBAR-TEXT      = 'Estornar Contábil'.

    IF R_AR2 IS INITIAL.
      TY_TOOLBAR-DISABLED  = 'X'.
    ENDIF.

    TY_TOOLBAR-BUTN_TYPE = 0.
    APPEND TY_TOOLBAR TO E_OBJECT->MT_TOOLBAR.
    CLEAR TY_TOOLBAR.

    TY_TOOLBAR-ICON      = ICON_REFRESH.
    TY_TOOLBAR-FUNCTION  = 'ATUALIZAR'.
    TY_TOOLBAR-QUICKINFO = 'Atualizar'.
    TY_TOOLBAR-TEXT      = 'Atualizar'.

    IF R_AR2 IS INITIAL.
      TY_TOOLBAR-DISABLED  = 'X'.
    ENDIF.

    TY_TOOLBAR-BUTN_TYPE = 0.
    APPEND TY_TOOLBAR TO E_OBJECT->MT_TOOLBAR.
    CLEAR TY_TOOLBAR.

    CALL METHOD C_ALV_TOOLBARMANAGER->REORGANIZE
      EXPORTING
        IO_ALV_TOOLBAR = E_OBJECT.

  ENDMETHOD.                    "on_toolbar

  METHOD HANDLE_USER_COMMAND.

    CASE E_UCOMM.
      WHEN 'RECLAS'.
        PERFORM GERAR_DOC_RECLAS.
      WHEN 'ESTORNAR_CONTABIL'.
        PERFORM ESTORNAR_DOC_CONT.
      WHEN 'ATUALIZAR'.
        PERFORM REFRESH_DOC_CONTABIL.
    ENDCASE.

  ENDMETHOD.                    "HANDLE_USER_COMMAND

ENDCLASS.                    "lcl_alv_toolbar IMPLEMENTATION

CLASS LCL_EVENT_HANDLER IMPLEMENTATION.                 "

  METHOD HANDLE_HOTSPOT_CLICK.
    PERFORM HANDLE_HOTSPOT_CLICK USING E_ROW_ID E_COLUMN_ID ES_ROW_NO.
  ENDMETHOD.

ENDCLASS.           "lcl_event_handler_0102 IMPLEMENTATION
