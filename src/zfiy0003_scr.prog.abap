*&---------------------------------------------------------------------*
*&  Include         ZFIY0003_SCR
*&---------------------------------------------------------------------*
PARAMETERS: S_PDATE LIKE J_1AFPDO-PRDATE NO-DISPLAY,
            S_COPY  LIKE J_1AFPDO-COPYNO NO-DISPLAY.
DATA            P_SCRIPT TYPE C.

SELECTION-SCREEN BEGIN OF BLOCK BLOQUE2 WITH FRAME TITLE TEXT-003.
PARAMETERS: P_CERTIF AS CHECKBOX DEFAULT 'X',
            S_COPIA  LIKE J_1AFPDO-COPYNO OBLIGATORY DEFAULT 1.
SKIP.
PARAMETERS: RB_VIEW TYPE C  RADIOBUTTON GROUP GR1,
            RB_PRNT TYPE C  RADIOBUTTON GROUP GR1,
            P_IMPR  TYPE TSP03-PADEST OBLIGATORY DEFAULT 'LOCL',
            P_PATH  TYPE STRING.
SELECTION-SCREEN END OF BLOCK BLOQUE2.

SELECTION-SCREEN BEGIN OF BLOCK MAIL WITH FRAME TITLE TEXT-001.
PARAMETERS: PSEND   AS CHECKBOX DEFAULT ' ',
            PEMAIL  TYPE CHAR120,
            PTESTEE AS CHECKBOX DEFAULT ' '.
SELECTION-SCREEN END OF BLOCK MAIL.

AT SELECTION-SCREEN ON VALUE-REQUEST FOR P_PATH .

  CALL METHOD CL_GUI_FRONTEND_SERVICES=>DIRECTORY_BROWSE
    EXPORTING
      WINDOW_TITLE         = 'directorio de descarga'    "Titulo de la ventana
    CHANGING
      SELECTED_FOLDER      = P_PATH   "Path del archivo de   salida
    EXCEPTIONS
      CNTL_ERROR           = 1
      ERROR_NO_GUI         = 2
      NOT_SUPPORTED_BY_GUI = 3
      OTHERS               = 4.

  IF SY-SUBRC <> 0.
    MESSAGE ID SY-MSGID TYPE SY-MSGTY NUMBER SY-MSGNO
               WITH SY-MSGV1 SY-MSGV2 SY-MSGV3 SY-MSGV4.
  ENDIF.
