FUNCTION ZMP2E_IMSEG_TO_2017_ITEM_CREAT.
*"--------------------------------------------------------------------
*"*"Interface local:
*"  IMPORTING
*"     REFERENCE(IMSEG) LIKE  IMSEG STRUCTURE  IMSEG
*"  CHANGING
*"     REFERENCE(BAPI2017_GM_ITEM_CREATE)
*"  LIKE  BAPI2017_GM_ITEM_CREATE STRUCTURE  BAPI2017_GM_ITEM_CREATE
*"  EXCEPTIONS
*"      ERROR_CONVERTING_ISO_CODE
*"      ERROR_CONVERTING_KEYS
*"      ERROR_CONVERTING_CURR_AMOUNT
*"      ERROR_CONVERTING_NETWORK
*"--------------------------------------------------------------------

* This function module was generated. Don't change it manually!
* <VERSION>|5
* <BAPI_STRUCTURE>|BAPI2017_GM_ITEM_CREATE
* <SAP_STRUCTURE>|IMSEG
* <INTERN_TO_EXTERN>|X
* <APPEND FORM>|X

DATA TMP_AMOUNT LIKE BAPICURR-BAPICURR.

* <BAPI_FIELD>|CMMT_ITEM
* <SAP_FIELD>|FIPOS
* <CODE_PART>|A_MOVE
* <ADD_FIELD>|
MOVE IMSEG-FIPOS
  TO BAPI2017_GM_ITEM_CREATE-CMMT_ITEM                            .

* <BAPI_FIELD>|FUNDS_CTR
* <SAP_FIELD>|FISTL
* <CODE_PART>|A_MOVE
* <ADD_FIELD>|
MOVE IMSEG-FISTL
  TO BAPI2017_GM_ITEM_CREATE-FUNDS_CTR                            .

* <BAPI_FIELD>|FUND
* <SAP_FIELD>|GEBER
* <CODE_PART>|A_MOVE
* <ADD_FIELD>|
MOVE IMSEG-GEBER
  TO BAPI2017_GM_ITEM_CREATE-FUND                                 .

* <BAPI_FIELD>|PROD_DATE
* <SAP_FIELD>|HSDAT
* <CODE_PART>|A_MOVE
* <ADD_FIELD>|
MOVE IMSEG-HSDAT
  TO BAPI2017_GM_ITEM_CREATE-PROD_DATE                            .

* <BAPI_FIELD>|EXPIRYDATE
* <SAP_FIELD>|VFDAT
* <CODE_PART>|A_MOVE
* <ADD_FIELD>|
MOVE IMSEG-VFDAT
  TO BAPI2017_GM_ITEM_CREATE-EXPIRYDATE                           .

* <BAPI_FIELD>|XSTOB
* <SAP_FIELD>|XSTOB
* <CODE_PART>|A_MOVE
* <ADD_FIELD>|
MOVE IMSEG-XSTOB
  TO BAPI2017_GM_ITEM_CREATE-XSTOB                                .

* <BAPI_FIELD>|IND_PROPOSE_QUANX
* <SAP_FIELD>|XMEVO
* <CODE_PART>|A_MOVE
* <ADD_FIELD>|
MOVE IMSEG-XMEVO
  TO BAPI2017_GM_ITEM_CREATE-IND_PROPOSE_QUANX                    .

* <BAPI_FIELD>|GL_ACCOUNT
* <SAP_FIELD>|KONTO
* <CODE_PART>|A_MOVE
* <ADD_FIELD>|
MOVE IMSEG-KONTO
  TO BAPI2017_GM_ITEM_CREATE-GL_ACCOUNT                           .

* <BAPI_FIELD>|VAL_S_ORD_ITEM
* <SAP_FIELD>|MAT_KDPOS
* <CODE_PART>|A_MOVE
* <ADD_FIELD>|
MOVE IMSEG-MAT_KDPOS
  TO BAPI2017_GM_ITEM_CREATE-VAL_S_ORD_ITEM                       .

* <BAPI_FIELD>|VAL_SALES_ORD
* <SAP_FIELD>|MAT_KDAUF
* <CODE_PART>|A_MOVE
* <ADD_FIELD>|
MOVE IMSEG-MAT_KDAUF
  TO BAPI2017_GM_ITEM_CREATE-VAL_SALES_ORD                        .

* <BAPI_FIELD>|PROFIT_CTR
* <SAP_FIELD>|PRCTR
* <CODE_PART>|A_MOVE
* <ADD_FIELD>|
MOVE IMSEG-PRCTR
  TO BAPI2017_GM_ITEM_CREATE-PROFIT_CTR                           .

* <BAPI_FIELD>|PROFIT_SEGM_NO
* <SAP_FIELD>|PAOBJNR
* <CODE_PART>|A_MOVE
* <ADD_FIELD>|
MOVE IMSEG-PAOBJNR
  TO BAPI2017_GM_ITEM_CREATE-PROFIT_SEGM_NO                       .

* <BAPI_FIELD>|COST_OBJ
* <SAP_FIELD>|KSTRG
* <CODE_PART>|A_MOVE
* <ADD_FIELD>|
MOVE IMSEG-KSTRG
  TO BAPI2017_GM_ITEM_CREATE-COST_OBJ                             .

* <BAPI_FIELD>|RL_EST_KEY
* <SAP_FIELD>|IMKEY
* <CODE_PART>|A_MOVE
* <ADD_FIELD>|
MOVE IMSEG-IMKEY
  TO BAPI2017_GM_ITEM_CREATE-RL_EST_KEY                           .

* <BAPI_FIELD>|MOVE_REAS
* <SAP_FIELD>|GRUND
* <CODE_PART>|A_MOVE
* <ADD_FIELD>|
MOVE IMSEG-GRUND
  TO BAPI2017_GM_ITEM_CREATE-MOVE_REAS                            .

* <BAPI_FIELD>|REF_DOC_IT
* <SAP_FIELD>|LFPOS
* <CODE_PART>|A_MOVE
* <ADD_FIELD>|
MOVE IMSEG-LFPOS
  TO BAPI2017_GM_ITEM_CREATE-REF_DOC_IT                           .

* <BAPI_FIELD>|REF_DOC
* <SAP_FIELD>|LFBNR
* <CODE_PART>|A_MOVE
* <ADD_FIELD>|
MOVE IMSEG-LFBNR
  TO BAPI2017_GM_ITEM_CREATE-REF_DOC                              .

* <BAPI_FIELD>|REF_DOC_YR
* <SAP_FIELD>|LFBJA
* <CODE_PART>|A_MOVE
* <ADD_FIELD>|
MOVE IMSEG-LFBJA
  TO BAPI2017_GM_ITEM_CREATE-REF_DOC_YR                           .

* <BAPI_FIELD>|PART_ACCT
* <SAP_FIELD>|VPTNR
* <CODE_PART>|A_MOVE
* <ADD_FIELD>|
MOVE IMSEG-VPTNR
  TO BAPI2017_GM_ITEM_CREATE-PART_ACCT                            .

* <BAPI_FIELD>|NETWORK
* <SAP_FIELD>|NPLNR
* <CODE_PART>|A_MOVE
* <ADD_FIELD>|
MOVE IMSEG-NPLNR
  TO BAPI2017_GM_ITEM_CREATE-NETWORK                              .

* <BAPI_FIELD>|DELIV_NUMB                                        "359954
* <SAP_FIELD>|VBELN
* <CODE_PART>|A_MOVE
* <ADD_FIELD>|
MOVE IMSEG-VBELN
  TO BAPI2017_GM_ITEM_CREATE-DELIV_NUMB.                         "359954

* <BAPI_FIELD>|STGE_TYPE_ST
* <SAP_FIELD>|UMLGT
* <CODE_PART>|A_MOVE
* <ADD_FIELD>|
MOVE IMSEG-UMLGT
  TO BAPI2017_GM_ITEM_CREATE-STGE_TYPE_ST                         .

* <BAPI_FIELD>|GR_NUMBER
* <SAP_FIELD>|WENUM
* <CODE_PART>|A_MOVE
* <ADD_FIELD>|
MOVE IMSEG-WENUM
  TO BAPI2017_GM_ITEM_CREATE-GR_NUMBER                            .

* <BAPI_FIELD>|NO_PST_CHGNT
* <SAP_FIELD>|KZKUB
* <CODE_PART>|A_MOVE
* <ADD_FIELD>|
MOVE IMSEG-KZKUB
  TO BAPI2017_GM_ITEM_CREATE-NO_PST_CHGNT                         .

* <BAPI_FIELD>|STGE_BIN_PC
* <SAP_FIELD>|UBLGP
* <CODE_PART>|A_MOVE
* <ADD_FIELD>|
MOVE IMSEG-UBLGP
  TO BAPI2017_GM_ITEM_CREATE-STGE_BIN_PC                          .

* <BAPI_FIELD>|STGE_TYPE_PC
* <SAP_FIELD>|UBTYP
* <CODE_PART>|A_MOVE
* <ADD_FIELD>|
MOVE IMSEG-UBTYP
  TO BAPI2017_GM_ITEM_CREATE-STGE_TYPE_PC                         .

* <BAPI_FIELD>|NO_TRANSFER_REQ
* <SAP_FIELD>|TBPKZ
* <CODE_PART>|A_MOVE
* <ADD_FIELD>|
MOVE IMSEG-TBPKZ
  TO BAPI2017_GM_ITEM_CREATE-NO_TRANSFER_REQ                      .

* <BAPI_FIELD>|MATYEAR_TR_CANCEL
* <SAP_FIELD>|TBBJR
* <CODE_PART>|A_MOVE
* <ADD_FIELD>|
MOVE IMSEG-TBBJR
  TO BAPI2017_GM_ITEM_CREATE-MATYEAR_TR_CANCEL                    .

* <BAPI_FIELD>|MATITEM_TR_CANCEL
* <SAP_FIELD>|TBBPO
* <CODE_PART>|A_MOVE
* <ADD_FIELD>|
MOVE IMSEG-TBBPO
  TO BAPI2017_GM_ITEM_CREATE-MATITEM_TR_CANCEL                    .

* <BAPI_FIELD>|MATDOC_TR_CANCEL
* <SAP_FIELD>|TBBEL
* <CODE_PART>|A_MOVE
* <ADD_FIELD>|
MOVE IMSEG-TBBEL
  TO BAPI2017_GM_ITEM_CREATE-MATDOC_TR_CANCEL                     .

* <BAPI_FIELD>|STGE_BIN_ST
* <SAP_FIELD>|UMLGP
* <CODE_PART>|A_MOVE
* <ADD_FIELD>|
MOVE IMSEG-UMLGP
  TO BAPI2017_GM_ITEM_CREATE-STGE_BIN_ST                          .

* <BAPI_FIELD>|SU_PL_STCK_1
* <SAP_FIELD>|ANZL1
* <CODE_PART>|A_MOVE
* <ADD_FIELD>|
MOVE IMSEG-ANZL1
  TO BAPI2017_GM_ITEM_CREATE-SU_PL_STCK_1                         .

* <BAPI_FIELD>|STGE_BIN
* <SAP_FIELD>|LGPLA
* <CODE_PART>|A_MOVE
* <ADD_FIELD>|
MOVE IMSEG-LGPLA
  TO BAPI2017_GM_ITEM_CREATE-STGE_BIN                             .

* <BAPI_FIELD>|STGE_TYPE
* <SAP_FIELD>|LGTYP
* <CODE_PART>|A_MOVE
* <ADD_FIELD>|
MOVE IMSEG-LGTYP
  TO BAPI2017_GM_ITEM_CREATE-STGE_TYPE                            .

* <BAPI_FIELD>|SERIALNO_AUTO_NUMBERASSIGNMENT
* <SAP_FIELD>|XSAUT
* <CODE_PART>|A_MOVE
* <ADD_FIELD>|
MOVE IMSEG-XSAUT
  TO BAPI2017_GM_ITEM_CREATE-SERIALNO_AUTO_NUMBERASSIGNMENT       .

* <BAPI_FIELD>|DELIV_ITEM                                        "359954
* <SAP_FIELD>|POSNR
* <CODE_PART>|A_MOVE
* <ADD_FIELD>|
MOVE IMSEG-POSNR
  TO BAPI2017_GM_ITEM_CREATE-DELIV_ITEM.                         "359954

* <BAPI_FIELD>|UNITTYPE_2
* <SAP_FIELD>|LETY2
* <CODE_PART>|A_MOVE
* <ADD_FIELD>|
MOVE IMSEG-LETY2
  TO BAPI2017_GM_ITEM_CREATE-UNITTYPE_2                           .

* <BAPI_FIELD>|ST_UN_QTYY_2
* <SAP_FIELD>|LMEN2
* <CODE_PART>|A_MOVE
* <ADD_FIELD>|
MOVE IMSEG-LMEN2
  TO BAPI2017_GM_ITEM_CREATE-ST_UN_QTYY_2                         .

* <BAPI_FIELD>|SU_PL_STCK_2
* <SAP_FIELD>|ANZL2
* <CODE_PART>|A_MOVE
* <ADD_FIELD>|
MOVE IMSEG-ANZL2
  TO BAPI2017_GM_ITEM_CREATE-SU_PL_STCK_2                         .

* <BAPI_FIELD>|UNITTYPE_1
* <SAP_FIELD>|LETY1
* <CODE_PART>|A_MOVE
* <ADD_FIELD>|
MOVE IMSEG-LETY1
  TO BAPI2017_GM_ITEM_CREATE-UNITTYPE_1                           .

* <BAPI_FIELD>|ST_UN_QTYY_1
* <SAP_FIELD>|LMEN1
* <CODE_PART>|A_MOVE
* <ADD_FIELD>|
MOVE IMSEG-LMEN1
  TO BAPI2017_GM_ITEM_CREATE-ST_UN_QTYY_1                         .

* <BAPI_FIELD>|PO_NUMBER
* <SAP_FIELD>|EBELN
* <CODE_PART>|A_MOVE
* <ADD_FIELD>|
MOVE IMSEG-EBELN
  TO BAPI2017_GM_ITEM_CREATE-PO_NUMBER                            .

* <BAPI_FIELD>|PO_PR_QNT
* <SAP_FIELD>|BPMNG
* <CODE_PART>|A_MOVE
* <ADD_FIELD>|
MOVE IMSEG-BPMNG
  TO BAPI2017_GM_ITEM_CREATE-PO_PR_QNT                            .

* <BAPI_FIELD>|ENTRY_QNT
* <SAP_FIELD>|ERFMG
* <CODE_PART>|A_MOVE
* <ADD_FIELD>|
MOVE IMSEG-ERFMG
  TO BAPI2017_GM_ITEM_CREATE-ENTRY_QNT                            .

* <BAPI_FIELD>|VAL_TYPE
* <SAP_FIELD>|BWTAR
* <CODE_PART>|A_MOVE
* <ADD_FIELD>|
MOVE IMSEG-BWTAR
  TO BAPI2017_GM_ITEM_CREATE-VAL_TYPE                             .

* <BAPI_FIELD>|SCHED_LINE
* <SAP_FIELD>|KDEIN
* <CODE_PART>|A_MOVE
* <ADD_FIELD>|
MOVE IMSEG-KDEIN
  TO BAPI2017_GM_ITEM_CREATE-SCHED_LINE                           .

* <BAPI_FIELD>|ITEM_TEXT
* <SAP_FIELD>|SGTXT
* <CODE_PART>|A_MOVE
* <ADD_FIELD>|
MOVE IMSEG-SGTXT
  TO BAPI2017_GM_ITEM_CREATE-ITEM_TEXT                            .

* <BAPI_FIELD>|NO_MORE_GR
* <SAP_FIELD>|ELIKZ
* <CODE_PART>|A_MOVE
* <ADD_FIELD>|
MOVE IMSEG-ELIKZ
  TO BAPI2017_GM_ITEM_CREATE-NO_MORE_GR                           .

* <BAPI_FIELD>|COMP_SHIP
* <SAP_FIELD>|EVERE
* <CODE_PART>|A_MOVE
* <ADD_FIELD>|
MOVE IMSEG-EVERE
  TO BAPI2017_GM_ITEM_CREATE-COMP_SHIP                            .

* <BAPI_FIELD>|SHIPPING
* <SAP_FIELD>|EVERS
* <CODE_PART>|A_MOVE
* <ADD_FIELD>|
MOVE IMSEG-EVERS
  TO BAPI2017_GM_ITEM_CREATE-SHIPPING                             .

* <BAPI_FIELD>|PO_ITEM
* <SAP_FIELD>|EBELP
* <CODE_PART>|A_MOVE
* <ADD_FIELD>|
MOVE IMSEG-EBELP
  TO BAPI2017_GM_ITEM_CREATE-PO_ITEM                              .

* <BAPI_FIELD>|S_ORD_ITEM
* <SAP_FIELD>|KDPOS
* <CODE_PART>|A_MOVE
* <ADD_FIELD>|
MOVE IMSEG-KDPOS
  TO BAPI2017_GM_ITEM_CREATE-S_ORD_ITEM                           .

* <BAPI_FIELD>|MOVE_TYPE
* <SAP_FIELD>|BWART
* <CODE_PART>|A_MOVE
* <ADD_FIELD>|
MOVE IMSEG-BWART
  TO BAPI2017_GM_ITEM_CREATE-MOVE_TYPE                            .

* <BAPI_FIELD>|BATCH
* <SAP_FIELD>|CHARG
* <CODE_PART>|A_MOVE
* <ADD_FIELD>|
MOVE IMSEG-CHARG
  TO BAPI2017_GM_ITEM_CREATE-BATCH                                .

* <BAPI_FIELD>|STGE_LOC
* <SAP_FIELD>|LGORT
* <CODE_PART>|A_MOVE
* <ADD_FIELD>|
MOVE IMSEG-LGORT
  TO BAPI2017_GM_ITEM_CREATE-STGE_LOC                             .

* <BAPI_FIELD>|PLANT
* <SAP_FIELD>|WERKS
* <CODE_PART>|A_MOVE
* <ADD_FIELD>|
MOVE IMSEG-WERKS
  TO BAPI2017_GM_ITEM_CREATE-PLANT                                .

* <BAPI_FIELD>|MATERIAL
* <SAP_FIELD>|MATNR
* <CODE_PART>|A_MOVE
* <ADD_FIELD>|
MOVE IMSEG-MATNR
  TO BAPI2017_GM_ITEM_CREATE-MATERIAL                             .

* <BAPI_FIELD>|SALES_ORD
* <SAP_FIELD>|KDAUF
* <CODE_PART>|A_MOVE
* <ADD_FIELD>|
MOVE IMSEG-KDAUF
  TO BAPI2017_GM_ITEM_CREATE-SALES_ORD                            .

* <BAPI_FIELD>|CUSTOMER
* <SAP_FIELD>|KUNNR
* <CODE_PART>|A_MOVE
* <ADD_FIELD>|
MOVE IMSEG-KUNNR
  TO BAPI2017_GM_ITEM_CREATE-CUSTOMER                             .

* <BAPI_FIELD>|VENDOR
* <SAP_FIELD>|LIFNR
* <CODE_PART>|A_MOVE
* <ADD_FIELD>|
MOVE IMSEG-LIFNR
  TO BAPI2017_GM_ITEM_CREATE-VENDOR                               .

* <BAPI_FIELD>|SPEC_STOCK
* <SAP_FIELD>|SOBKZ
* <CODE_PART>|A_MOVE
* <ADD_FIELD>|
MOVE IMSEG-SOBKZ
  TO BAPI2017_GM_ITEM_CREATE-SPEC_STOCK                           .

* <BAPI_FIELD>|STCK_TYPE
* <SAP_FIELD>|INSMK
* <CODE_PART>|A_MOVE
* <ADD_FIELD>|
MOVE IMSEG-INSMK
  TO BAPI2017_GM_ITEM_CREATE-STCK_TYPE                            .

* <BAPI_FIELD>|GR_RCPT
* <SAP_FIELD>|WEMPF
* <CODE_PART>|A_MOVE
* <ADD_FIELD>|
MOVE IMSEG-WEMPF
  TO BAPI2017_GM_ITEM_CREATE-GR_RCPT                              .

* <BAPI_FIELD>|MOVE_MAT
* <SAP_FIELD>|UMMAT
* <CODE_PART>|A_MOVE
* <ADD_FIELD>|
MOVE IMSEG-UMMAT
  TO BAPI2017_GM_ITEM_CREATE-MOVE_MAT                             .

* <BAPI_FIELD>|WITHDRAWN
* <SAP_FIELD>|KZEAR
* <CODE_PART>|A_MOVE
* <ADD_FIELD>|
MOVE IMSEG-KZEAR
  TO BAPI2017_GM_ITEM_CREATE-WITHDRAWN                            .

* <BAPI_FIELD>|RES_TYPE
* <SAP_FIELD>|RSART
* <CODE_PART>|A_MOVE
* <ADD_FIELD>|
MOVE IMSEG-RSART
  TO BAPI2017_GM_ITEM_CREATE-RES_TYPE                             .

* <BAPI_FIELD>|RES_ITEM
* <SAP_FIELD>|RSPOS
* <CODE_PART>|A_MOVE
* <ADD_FIELD>|
MOVE IMSEG-RSPOS
  TO BAPI2017_GM_ITEM_CREATE-RES_ITEM                             .

* <BAPI_FIELD>|RESERV_NO
* <SAP_FIELD>|RSNUM
* <CODE_PART>|A_MOVE
* <ADD_FIELD>|
MOVE IMSEG-RSNUM
  TO BAPI2017_GM_ITEM_CREATE-RESERV_NO                            .

* <BAPI_FIELD>|MVT_IND
* <SAP_FIELD>|KZBEW
* <CODE_PART>|A_MOVE
* <ADD_FIELD>|
MOVE IMSEG-KZBEW
  TO BAPI2017_GM_ITEM_CREATE-MVT_IND                              .

* <BAPI_FIELD>|MOVE_VAL_TYPE
* <SAP_FIELD>|UMBAR
* <CODE_PART>|A_MOVE
* <ADD_FIELD>|
MOVE IMSEG-UMBAR
  TO BAPI2017_GM_ITEM_CREATE-MOVE_VAL_TYPE                        .

* <BAPI_FIELD>|MOVE_BATCH
* <SAP_FIELD>|UMCHA
* <CODE_PART>|A_MOVE
* <ADD_FIELD>|
MOVE IMSEG-UMCHA
  TO BAPI2017_GM_ITEM_CREATE-MOVE_BATCH                           .

* <BAPI_FIELD>|MOVE_STLOC
* <SAP_FIELD>|UMLGO
* <CODE_PART>|A_MOVE
* <ADD_FIELD>|
MOVE IMSEG-UMLGO
  TO BAPI2017_GM_ITEM_CREATE-MOVE_STLOC                           .

* <BAPI_FIELD>|MOVE_PLANT
* <SAP_FIELD>|UMWRK
* <CODE_PART>|A_MOVE
* <ADD_FIELD>|
MOVE IMSEG-UMWRK
  TO BAPI2017_GM_ITEM_CREATE-MOVE_PLANT                           .

* <BAPI_FIELD>|SUB_NUMBER
* <SAP_FIELD>|ANLN2
* <CODE_PART>|A_MOVE
* <ADD_FIELD>|
MOVE IMSEG-ANLN2
  TO BAPI2017_GM_ITEM_CREATE-SUB_NUMBER                           .

* <BAPI_FIELD>|CALC_MOTIVE
* <SAP_FIELD>|BEMOT
* <CODE_PART>|A_MOVE
* <ADD_FIELD>|
MOVE IMSEG-BEMOT
  TO BAPI2017_GM_ITEM_CREATE-CALC_MOTIVE                          .

* <BAPI_FIELD>|ORDER_ITNO
* <SAP_FIELD>|AUFPS
* <CODE_PART>|A_MOVE
* <ADD_FIELD>|
MOVE IMSEG-AUFPS
  TO BAPI2017_GM_ITEM_CREATE-ORDER_ITNO                           .

* <BAPI_FIELD>|ASSET_NO
* <SAP_FIELD>|ANLN1
* <CODE_PART>|A_MOVE
* <ADD_FIELD>|
MOVE IMSEG-ANLN1
  TO BAPI2017_GM_ITEM_CREATE-ASSET_NO                             .

* <BAPI_FIELD>|ORDERID
* <SAP_FIELD>|AUFNR
* <CODE_PART>|A_MOVE
* <ADD_FIELD>|
MOVE IMSEG-AUFNR
  TO BAPI2017_GM_ITEM_CREATE-ORDERID                              .

* <BAPI_FIELD>|COSTCENTER
* <SAP_FIELD>|KOSTL
* <CODE_PART>|A_MOVE
* <ADD_FIELD>|
MOVE IMSEG-KOSTL
  TO BAPI2017_GM_ITEM_CREATE-COSTCENTER                           .

* <BAPI_FIELD>|UNLOAD_PT
* <SAP_FIELD>|ABLAD
* <CODE_PART>|A_MOVE
* <ADD_FIELD>|
MOVE IMSEG-ABLAD
  TO BAPI2017_GM_ITEM_CREATE-UNLOAD_PT                            .

* <BAPI_FIELD>|CO_BUSPROC
* <SAP_FIELD>|PRZNR
* <CODE_PART>|A_MOVE
* <ADD_FIELD>|
MOVE IMSEG-PRZNR
  TO BAPI2017_GM_ITEM_CREATE-CO_BUSPROC                             .

* <BAPI_FIELD>|ACTTYPE
* <SAP_FIELD>|LSTAR
* <CODE_PART>|A_MOVE
* <ADD_FIELD>|
MOVE IMSEG-LSTAR
  TO BAPI2017_GM_ITEM_CREATE-ACTTYPE                                .

* <BAPI_FIELD>|SUPPL_VEND
* <SAP_FIELD>|LLIEF
* <CODE_PART>|A_MOVE
* <ADD_FIELD>|
MOVE IMSEG-LLIEF
  TO BAPI2017_GM_ITEM_CREATE-SUPPL_VEND                             .

* <BAPI_FIELD>|LINE_ID
* <SAP_FIELD>|LINE_ID
* <CODE_PART>|A_MOVE
* <ADD_FIELD>|
MOVE IMSEG-LINE_ID
  TO BAPI2017_GM_ITEM_CREATE-LINE_ID.

* <BAPI_FIELD>|PARENT_ID
* <SAP_FIELD>|PARENT_ID
* <CODE_PART>|A_MOVE
* <ADD_FIELD>|
MOVE IMSEG-PARENT_ID
  TO BAPI2017_GM_ITEM_CREATE-PARENT_ID.

* <BAPI_FIELD>|LINE_DEPTH
* <SAP_FIELD>|LINE_DEPTH
* <CODE_PART>|A_MOVE
* <ADD_FIELD>|
MOVE IMSEG-LINE_DEPTH
  TO BAPI2017_GM_ITEM_CREATE-LINE_DEPTH.

* <BAPI_FIELD>|QUANTITY
* <SAP_FIELD>|MENGE
* <CODE_PART>|A_MOVE
* <ADD_FIELD>|
MOVE IMSEG-MENGE
  TO BAPI2017_GM_ITEM_CREATE-QUANTITY.

* <BAPI_FIELD>|BASE_UOM
* <SAP_FIELD>|MEINS
* <CODE_PART>|A_MOVE
* <ADD_FIELD>|
MOVE IMSEG-MEINS
  TO BAPI2017_GM_ITEM_CREATE-BASE_UOM.

*---------  Note 359954: Start of insertation  -------------------------
* <BAPI_FIELD>|FUNC_AREA
* <SAP_FIELD>|FKBER
* <CODE_PART>|A_MOVE
* <ADD_FIELD>|
MOVE IMSEG-FKBER
  TO BAPI2017_GM_ITEM_CREATE-FUNC_AREA.

* <BAPI_FIELD>|TR_PART_BA
* <SAP_FIELD>|PARGB
* <CODE_PART>|A_MOVE
* <ADD_FIELD>|
MOVE IMSEG-PARGB
  TO BAPI2017_GM_ITEM_CREATE-TR_PART_BA.

* <BAPI_FIELD>|PAR_COMPCO
* <SAP_FIELD>|PARBU
* <CODE_PART>|A_MOVE
* <ADD_FIELD>|
MOVE IMSEG-PARBU
  TO BAPI2017_GM_ITEM_CREATE-PAR_COMPCO.

* <BAPI_FIELD>|DELIV_NUMB_TO_SEARCH
* <SAP_FIELD>|VLIEF_AVIS
* <CODE_PART>|A_MOVE
* <ADD_FIELD>|
MOVE IMSEG-VLIEF_AVIS
  TO BAPI2017_GM_ITEM_CREATE-DELIV_NUMB_TO_SEARCH.

* <BAPI_FIELD>|DELIV_ITEM_TO_SEARCH
* <SAP_FIELD>|VBELP_AVIS
* <CODE_PART>|A_MOVE
* <ADD_FIELD>|
MOVE IMSEG-VBELP_AVIS
  TO BAPI2017_GM_ITEM_CREATE-DELIV_ITEM_TO_SEARCH.

* <BAPI_FIELD>|UNLOAD_PTX
* <SAP_FIELD>|ABLADX
* <CODE_PART>|A_MOVE
* <ADD_FIELD>|
MOVE IMSEG-ABLADX
  TO BAPI2017_GM_ITEM_CREATE-UNLOAD_PTX.

* <BAPI_FIELD>|GR_RCPTX
* <SAP_FIELD>|WEMPFX
* <CODE_PART>|A_MOVE
* <ADD_FIELD>|
MOVE IMSEG-WEMPFX
  TO BAPI2017_GM_ITEM_CREATE-GR_RCPTX.

* <BAPI_FIELD>|NB_SLIPS
* <SAP_FIELD>|WEANZ
* <CODE_PART>|A_MOVE
* <ADD_FIELD>|MOVE BAPI2017_GM_ITEM_CREATE-NB_SLIPS
MOVE IMSEG-WEANZ
  TO BAPI2017_GM_ITEM_CREATE-NB_SLIPS.

* <BAPI_FIELD>|NB_SLIPSX
* <SAP_FIELD>|WEANZX
* <CODE_PART>|A_MOVE
* <ADD_FIELD>|MOVE BAPI2017_GM_ITEM_CREATE-NB_SLIPS
MOVE IMSEG-WEANZX
  TO BAPI2017_GM_ITEM_CREATE-NB_SLIPSX.
*---------  Note 359954: End of insertation  ---------------------------

* <BAPI_FIELD>|ORDERPR_UN_ISO
* <SAP_FIELD>|BPRME
* <CODE_PART>|ISO_INT_UNIT
* <ADD_FIELD>|ORDERPR_UN
MOVE IMSEG-BPRME
  TO BAPI2017_GM_ITEM_CREATE-ORDERPR_UN                           .
IF NOT
IMSEG-BPRME
IS INITIAL.
  CALL FUNCTION 'UNIT_OF_MEASURE_SAP_TO_ISO'
       EXPORTING
            SAP_CODE    =
       IMSEG-BPRME
       IMPORTING
            ISO_CODE    =
       BAPI2017_GM_ITEM_CREATE-ORDERPR_UN_ISO
       EXCEPTIONS
            NOT_FOUND   = 1
            NO_ISO_CODE = 2
            OTHERS      = 3.
  IF SY-SUBRC <> 0.
  CLEAR BAPI2017_GM_ITEM_CREATE-ORDERPR_UN_ISO                       .
  ENDIF.
ELSE.
  CLEAR BAPI2017_GM_ITEM_CREATE-ORDERPR_UN_ISO                       .
ENDIF.

* <BAPI_FIELD>|ENTRY_UOM_ISO
* <SAP_FIELD>|ERFME
* <CODE_PART>|ISO_INT_UNIT
* <ADD_FIELD>|ENTRY_UOM
MOVE IMSEG-ERFME
  TO BAPI2017_GM_ITEM_CREATE-ENTRY_UOM                            .
IF NOT
IMSEG-ERFME
IS INITIAL.
  CALL FUNCTION 'UNIT_OF_MEASURE_SAP_TO_ISO'
       EXPORTING
            SAP_CODE    =
       IMSEG-ERFME
       IMPORTING
            ISO_CODE    =
       BAPI2017_GM_ITEM_CREATE-ENTRY_UOM_ISO
       EXCEPTIONS
            NOT_FOUND   = 1
            NO_ISO_CODE = 2
            OTHERS      = 3.
  IF SY-SUBRC <> 0.
  CLEAR BAPI2017_GM_ITEM_CREATE-ENTRY_UOM_ISO                        .
  ENDIF.
ELSE.
  CLEAR BAPI2017_GM_ITEM_CREATE-ENTRY_UOM_ISO                        .
ENDIF.

* <BAPI_FIELD>|ST_UN_QTYY_1_ISO
* <SAP_FIELD>|MEINS
* <CODE_PART>|ISO_UNIT
* <ADD_FIELD>|
IF NOT
IMSEG-MEINS
IS INITIAL.
  CALL FUNCTION 'UNIT_OF_MEASURE_SAP_TO_ISO'
       EXPORTING
            SAP_CODE    =
       IMSEG-MEINS
       IMPORTING
            ISO_CODE    =
       BAPI2017_GM_ITEM_CREATE-ST_UN_QTYY_1_ISO
       EXCEPTIONS
            NOT_FOUND   = 1
            NO_ISO_CODE = 2
            OTHERS      = 3.
  IF SY-SUBRC <> 0.
    MESSAGE A541(B1) WITH
    IMSEG-MEINS
    'MEINS                         '
    RAISING ERROR_CONVERTING_ISO_CODE.
  ENDIF.
ELSE.
  CLEAR
  BAPI2017_GM_ITEM_CREATE-ST_UN_QTYY_1_ISO                     .
ENDIF.

* <BAPI_FIELD>|ST_UN_QTYY_2_ISO
* <SAP_FIELD>|MEINS
* <CODE_PART>|ISO_UNIT
* <ADD_FIELD>|
IF NOT
IMSEG-MEINS
IS INITIAL.
  CALL FUNCTION 'UNIT_OF_MEASURE_SAP_TO_ISO'
       EXPORTING
            SAP_CODE    =
       IMSEG-MEINS
       IMPORTING
            ISO_CODE    =
       BAPI2017_GM_ITEM_CREATE-ST_UN_QTYY_2_ISO
       EXCEPTIONS
            NOT_FOUND   = 1
            NO_ISO_CODE = 2
            OTHERS      = 3.
  IF SY-SUBRC <> 0.
    MESSAGE A541(B1) WITH
    IMSEG-MEINS
    'MEINS                         '
    RAISING ERROR_CONVERTING_ISO_CODE.
  ENDIF.
ELSE.
  CLEAR
  BAPI2017_GM_ITEM_CREATE-ST_UN_QTYY_2_ISO                     .
ENDIF.

* <BAPI_FIELD>|WBS_ELEM
* <SAP_FIELD>|PS_PSP_PNR
* <CODE_PART>|PSP_ELEM
* <ADD_FIELD>|
IF IMSEG-PS_PSP_PNR
IS INITIAL.
  CLEAR BAPI2017_GM_ITEM_CREATE-WBS_ELEM                             .
ELSE.
  CALL FUNCTION 'PSPNUM_INTERN_TO_EXTERN_CONV'
       EXPORTING
*           EDIT_IMP  = ' '
            INT_NUM   =
       IMSEG-PS_PSP_PNR
       IMPORTING
            EXT_NUM   =
       BAPI2017_GM_ITEM_CREATE-WBS_ELEM
       EXCEPTIONS
            NOT_FOUND = 1
            OTHERS    = 2.
  IF SY-SUBRC <> 0.
    MESSAGE A552(B1) WITH
    IMSEG-PS_PSP_PNR
    'PS_PSP_PNR                    '
    RAISING ERROR_CONVERTING_KEYS.
  ENDIF.
ENDIF.

* <BAPI_FIELD>|VAL_WBS_ELEM
* <SAP_FIELD>|MAT_PSPNR
* <CODE_PART>|PSP_ELEM
* <ADD_FIELD>|
IF IMSEG-MAT_PSPNR
IS INITIAL.
  CLEAR BAPI2017_GM_ITEM_CREATE-VAL_WBS_ELEM                         .
ELSE.
  CALL FUNCTION 'PSPNUM_INTERN_TO_EXTERN_CONV'
       EXPORTING
*           EDIT_IMP  = ' '
            INT_NUM   =
       IMSEG-MAT_PSPNR
       IMPORTING
            EXT_NUM   =
       BAPI2017_GM_ITEM_CREATE-VAL_WBS_ELEM
       EXCEPTIONS
            NOT_FOUND = 1
            OTHERS    = 2.
  IF SY-SUBRC <> 0.
    MESSAGE A552(B1) WITH
    IMSEG-MAT_PSPNR
    'MAT_PSPNR                     '
    RAISING ERROR_CONVERTING_KEYS.
  ENDIF.
ENDIF.

* <BAPI_FIELD>|AMOUNT_SV
* <SAP_FIELD>|EXVKW
* <CODE_PART>|Z_AMOUNT_FIELD
* <ADD_FIELD>|WAERS
IF NOT IMSEG-EXVKW
IS INITIAL.
  MOVE IMSEG-EXVKW
* to tmp_amount.
  TO BAPI2017_GM_ITEM_CREATE-AMOUNT_SV.
* if imseg-waers
* is initial.
*   message e537(b1) with
*   'IMSEG-WAERS                                                  '
*   tmp_amount
*   'EXVKW                         '
*   raising error_converting_curr_amount.
* else.
*   call function 'CURRENCY_AMOUNT_SAP_TO_BAPI'
*        exporting
*             currency    =
*        imseg-waers
*             sap_amount  =
*        tmp_amount
*        importing
*             bapi_amount =
*        bapi2017_gm_item_create-amount_sv
*        exceptions
*             others      = 0.
* endif.
ELSE.
  CLEAR BAPI2017_GM_ITEM_CREATE-AMOUNT_SV                            .
ENDIF.

* <BAPI_FIELD>|AMOUNT_LC
* <SAP_FIELD>|EXBWR
* <CODE_PART>|Z_AMOUNT_FIELD
* <ADD_FIELD>|WAERS
IF NOT IMSEG-EXBWR
IS INITIAL.
  MOVE IMSEG-EXBWR
  TO TMP_AMOUNT.
  IF IMSEG-WAERS
  IS INITIAL.
    MESSAGE E537(B1) WITH
    'IMSEG-WAERS                                                  '
    TMP_AMOUNT
    'EXBWR                         '
    RAISING ERROR_CONVERTING_CURR_AMOUNT.
  ELSE.
    CALL FUNCTION 'CURRENCY_AMOUNT_SAP_TO_BAPI'
         EXPORTING
              CURRENCY    =
         IMSEG-WAERS
              SAP_AMOUNT  =
         TMP_AMOUNT
         IMPORTING
              BAPI_AMOUNT =
         BAPI2017_GM_ITEM_CREATE-AMOUNT_LC
         EXCEPTIONS
              OTHERS      = 0.
  ENDIF.
ELSE.
  CLEAR BAPI2017_GM_ITEM_CREATE-AMOUNT_LC                            .
ENDIF.

PERFORM MP2E_IMSEG_TO_2017_ITEM_CREATE
  USING
    IMSEG
  CHANGING
    BAPI2017_GM_ITEM_CREATE       .

IF NOT IMSEG-SGT_SCAT IS INITIAL. "SEGMENTATION
*---> 14/06/2023 - Migração S4 - JS
*     MOVE IMSEG-SGT_SCAT TO BAPI2017_GM_ITEM_CREATE-STK_SEGMENT.
    BAPI2017_GM_ITEM_CREATE-STK_SEGMENT = CONV #( IMSEG-SGT_SCAT ).
*<--- 14/06/2023 - Migração S4 - JS
ELSE.
  CLEAR BAPI2017_GM_ITEM_CREATE-STK_SEGMENT.
ENDIF.

ENDFUNCTION.

FORM MP2E_IMSEG_TO_2017_ITEM_CREATE
  USING
    IMSEG
    STRUCTURE IMSEG
  CHANGING
    BAPI2017_GM_ITEM_CREATE
    STRUCTURE BAPI2017_GM_ITEM_CREATE       .

IF NOT IMSEG-AUFPL IS INITIAL AND IMSEG-APLZL IS INITIAL
 AND IMSEG-AUTYP = 20.                                           "574443
  CALL FUNCTION 'INT_ACTIVITY_GET_EXT_ACTIVITY'
       EXPORTING
            I_INT_ACT_AUFPL    = IMSEG-AUFPL
            I_INT_ACT_APLZL    = IMSEG-APLZL
       IMPORTING
            E_EXT_ACT_NETWORK  = BAPI2017_GM_ITEM_CREATE-NETWORK
            E_EXT_ACT_ACTIVITY = BAPI2017_GM_ITEM_CREATE-ACTIVITY
       EXCEPTIONS
            NOT_FOUND          = 1
            OTHERS             = 2.
  IF SY-SUBRC <> 0.
    MESSAGE E297(M7) WITH BAPI2017_GM_ITEM_CREATE-NETWORK
                          BAPI2017_GM_ITEM_CREATE-ACTIVITY
                     RAISING ERROR_CONVERTING_NETWORK.
*   Netzplan &, Aktivität & nicht vorhanden
  ENDIF.
ENDIF.
*----- Convert Long FM Fields & Grant ---------------------------------*
 MOVE IMSEG-GRANT_NBR to BAPI2017_GM_ITEM_CREATE-GRANT_NBR.
 CALL FUNCTION 'FUNC_AREA_CONVERSION_OUTBOUND'
      EXPORTING
       I_FUNC_AREA_LONG = IMSEG-FKBER
      IMPORTING
       E_FUNC_AREA      = BAPI2017_GM_ITEM_CREATE-FUNC_AREA
       E_FUNC_AREA_LONG = BAPI2017_GM_ITEM_CREATE-FUNC_AREA_LONG.

 CALL FUNCTION 'CMMT_ITEM_CONVERSION_OUTBOUND'
      EXPORTING
       I_CMMT_ITEM      = IMSEG-FIPOS
      IMPORTING
       E_CMMT_ITEM_LONG = BAPI2017_GM_ITEM_CREATE-CMMT_ITEM_LONG
       E_CMMT_ITEM      = BAPI2017_GM_ITEM_CREATE-CMMT_ITEM
      EXCEPTIONS
       NOT_FOUND        = 1
       OTHERS           = 2.
 IF SY-SUBRC <> 0.
    MESSAGE ID SY-MSGID TYPE SY-MSGTY NUMBER SY-MSGNO
           WITH SY-MSGV1 SY-MSGV2 SY-MSGV3 SY-MSGV4
           RAISING ERROR_CONVERTING_KEYS.
 ENDIF.

ENDFORM.
