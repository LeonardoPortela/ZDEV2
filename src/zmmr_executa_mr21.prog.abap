*&--------------------------------------------------------------------------------&*
*&                        AMAGGI                                                  &*
*&--------------------------------------------------------------------------------&*
*& Projeto..: AMaggi                                                              &*
*& Autor....: Jaime Tassoni                                                       &*
*& Data.....: 15.01.2025                                                          &*
*& Descrição: Executar MR21 com usuario definido                                  &*
*&--------------------------------------------------------------------------------&*
REPORT zmmr_executa_mr21.

************************************************************************************
* VARIAVEIS
************************************************************************************
DATA: t_bdcdata TYPE bdcdata_tab,
      t_msg_aux TYPE tab_bdcmsgcoll,
      rb_mr21   TYPE boolean.

************************************************************************************
* PARAMETROS
************************************************************************************
PARAMETERS: p_bdctab TYPE string,
            p_mr21   TYPE boolean.

************************************************************************************
* INICIO
************************************************************************************
START-OF-SELECTION.

  rb_mr21 = p_mr21.

  /ui2/cl_json=>deserialize( EXPORTING json = p_bdctab CHANGING data = t_bdcdata ).

  DATA(lv_mode)        = 'N'.
  DATA(lv_transaction) = COND #( WHEN rb_mr21 IS NOT INITIAL THEN 'MR21'
                                 ELSE 'MR22' ).

  CALL TRANSACTION lv_transaction  USING t_bdcdata
                                    MODE lv_mode
                                  UPDATE 'S'
                                MESSAGES INTO t_msg_aux.

************************************************************************************
************************************************************************************
