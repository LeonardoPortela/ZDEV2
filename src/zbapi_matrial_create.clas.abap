class ZBAPI_MATRIAL_CREATE definition
  public
  final
  create public .

public section.

  interfaces IF_BADI_INTERFACE .
  interfaces IF_EX_MB_BAPI_GOODSMVT_CREATE .
protected section.
private section.
ENDCLASS.



CLASS ZBAPI_MATRIAL_CREATE IMPLEMENTATION.


  METHOD IF_EX_MB_BAPI_GOODSMVT_CREATE~EXTENSIONIN_TO_MATDOC.

    FIELD-SYMBOLS: <FS_ZCHAVE_NFE>       TYPE ANY,
                   <FS_ZCH_REFERENCIA>   TYPE ANY,
                   <FS_ZID_DESTINACAO>   TYPE ANY,
                   <FS_ZOBJ_KEY_ENTRADA> TYPE ANY.

    READ TABLE EXTENSION_IN INTO DATA(WA_NFE) WITH KEY STRUCTURE = 'NFE_FORN'.
    IF SY-SUBRC IS INITIAL.
      ASSIGN ('CS_IMKPF-ZCHAVE_NFE') TO <FS_ZCHAVE_NFE>.
      IF <FS_ZCHAVE_NFE> IS ASSIGNED.
        <FS_ZCHAVE_NFE> = WA_NFE-VALUEPART1.
      ENDIF.
    ENDIF.

    READ TABLE EXTENSION_IN INTO WA_NFE WITH KEY STRUCTURE = 'ROMANEIO'.
    IF SY-SUBRC IS INITIAL.
      ASSIGN ('CS_IMKPF-ZCH_REFERENCIA') TO <FS_ZCH_REFERENCIA>.
      IF <FS_ZCH_REFERENCIA> IS ASSIGNED.
        <FS_ZCH_REFERENCIA> = WA_NFE-VALUEPART1.
      ENDIF.
    ENDIF.

    READ TABLE EXTENSION_IN INTO WA_NFE WITH KEY STRUCTURE = 'DESTINACAO'.
    IF SY-SUBRC IS INITIAL.
      ASSIGN ('CS_IMKPF-ZID_DESTINACAO') TO <FS_ZID_DESTINACAO>.
      IF <FS_ZID_DESTINACAO> IS ASSIGNED.
        <FS_ZID_DESTINACAO> = WA_NFE-VALUEPART1.
      ENDIF.
    ENDIF.

    READ TABLE EXTENSION_IN INTO WA_NFE WITH KEY STRUCTURE = 'ENTRADA_ESTOQUE'.
    IF SY-SUBRC IS INITIAL.
      ASSIGN ('CS_IMKPF-ZOBJ_KEY_ENTRADA') TO <FS_ZOBJ_KEY_ENTRADA>.
      IF <FS_ZOBJ_KEY_ENTRADA> IS ASSIGNED.
        <FS_ZOBJ_KEY_ENTRADA> = WA_NFE-VALUEPART1.
      ENDIF.
    ENDIF.

  ENDMETHOD.
ENDCLASS.
