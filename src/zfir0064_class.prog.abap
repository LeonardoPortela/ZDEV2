*&---------------------------------------------------------------------*
*&  Include           ZFIR0064_CLASS
*&---------------------------------------------------------------------*

CLASS LCL_ALV_TOOLBAR_XML IMPLEMENTATION.
  METHOD CONSTRUCTOR.
*   Create ALV toolbar manager instance
    CREATE OBJECT C_ALV_TOOLBARMANAGER
      EXPORTING
        IO_ALV_GRID = IO_ALV_GRID.
  ENDMETHOD.                    "constructor

  METHOD ON_TOOLBAR.

    TY_TOOLBAR-ICON      = ICON_INSERT_ROW.
    TY_TOOLBAR-FUNCTION  = 'INSR'.
    TY_TOOLBAR-BUTN_TYPE = 0.
    APPEND TY_TOOLBAR TO E_OBJECT->MT_TOOLBAR.
    CLEAR TY_TOOLBAR.

    TY_TOOLBAR-ICON      = ICON_DELETE_ROW.
    TY_TOOLBAR-FUNCTION  = 'DEL'.
    TY_TOOLBAR-BUTN_TYPE = 0.
    APPEND TY_TOOLBAR TO E_OBJECT->MT_TOOLBAR.
    CLEAR TY_TOOLBAR.

    TY_TOOLBAR-ICON      = ICON_REFRESH.
    TY_TOOLBAR-FUNCTION  = 'REN'.
    TY_TOOLBAR-BUTN_TYPE = 0.
    APPEND TY_TOOLBAR TO E_OBJECT->MT_TOOLBAR.
    CLEAR TY_TOOLBAR.

    CALL METHOD C_ALV_TOOLBARMANAGER->REORGANIZE
      EXPORTING
        IO_ALV_TOOLBAR = E_OBJECT.

  ENDMETHOD.                    "on_toolbar

  METHOD HANDLE_USER_COMMAND.

    CASE E_UCOMM.
      WHEN 'INSR'.

        CLEAR: WA_DOC_ELET.
        REFRESH: IT_J_1BBRANCH.

        PERFORM PREENCHE_CAMINHO.

        CALL SCREEN 0101 STARTING AT 02 02 ENDING AT 102 23.

        PERFORM: SELECIONA_DADOS,
                 PROCESSA_DADOS.

        CALL METHOD OBJ_ALV_XML->REFRESH_TABLE_DISPLAY
          EXPORTING
            IS_STABLE = WA_STABLE.

        CALL SCREEN 0100.


      WHEN 'DEL'.
        PERFORM EXCLUIR_XML.
      WHEN 'REN'.

    ENDCASE.

  ENDMETHOD.                    "HANDLE_USER_COMMAND



ENDCLASS.                    "lcl_alv_toolbar IMPLEMENTATION
