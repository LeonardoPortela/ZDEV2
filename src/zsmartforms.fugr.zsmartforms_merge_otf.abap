FUNCTION ZSMARTFORMS_MERGE_OTF.
*"----------------------------------------------------------------------
*"*"Interface local:
*"  IMPORTING
*"     REFERENCE(OTF_01) TYPE  TT_ITCOO
*"     REFERENCE(OTF_02) TYPE  TT_ITCOO
*"  EXPORTING
*"     REFERENCE(OTF_RESULT) TYPE  TT_ITCOO
*"----------------------------------------------------------------------

  DATA: OTF_03 TYPE  TT_ITCOO.

  IF OTF_01[] IS NOT INITIAL AND OTF_02[] IS INITIAL.
    OTF_RESULT[] = OTF_01[].
  ELSEIF OTF_01[] IS INITIAL AND OTF_02[] IS NOT INITIAL.
    OTF_RESULT[] = OTF_02[].
  ELSE.
    OTF_RESULT[] = OTF_01[].
    OTF_03[]     = OTF_02[].

    DESCRIBE TABLE OTF_03 LINES DATA(LC_QTD).

    IF LC_QTD IS NOT INITIAL.

      DELETE OTF_03 WHERE TDPRINTCOM = '//'.

      FIND ALL OCCURRENCES OF 'EP' IN TABLE OTF_RESULT RESULTS DATA(IT_RESULTADO).

      LOOP AT IT_RESULTADO INTO DATA(WA_RESULTADO).
        DATA(MY_TABIX) = WA_RESULTADO-LINE + 1.
      ENDLOOP.

      INSERT LINES OF OTF_03 INTO OTF_RESULT INDEX MY_TABIX.

    ENDIF.
  ENDIF.

ENDFUNCTION.
