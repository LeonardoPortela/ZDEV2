FUNCTION Z_SD_INFO_CTE_CANCELAR.
*"----------------------------------------------------------------------
*"*"Interface local:
*"  IMPORTING
*"     REFERENCE(P_DOCNUM) TYPE  J_1BDOCNUM
*"     REFERENCE(I_REASON) TYPE  J_1BNFE_CANCEL_REASON OPTIONAL
*"     REFERENCE(I_REASON1) TYPE  J_1BNFE_CANCEL_TEXT OPTIONAL
*"     REFERENCE(I_REASON2) TYPE  J_1BNFE_CANCEL_TEXT OPTIONAL
*"     REFERENCE(I_REASON3) TYPE  J_1BNFE_CANCEL_TEXT OPTIONAL
*"     REFERENCE(I_REASON4) TYPE  J_1BNFE_CANCEL_TEXT OPTIONAL
*"  EXPORTING
*"     VALUE(REASON) TYPE  J_1BNFE_CANCEL_REASON
*"     VALUE(REASON1) TYPE  J_1BNFE_CANCEL_TEXT
*"     VALUE(REASON2) TYPE  J_1BNFE_CANCEL_TEXT
*"     VALUE(REASON3) TYPE  J_1BNFE_CANCEL_TEXT
*"     VALUE(REASON4) TYPE  J_1BNFE_CANCEL_TEXT
*"  EXCEPTIONS
*"      ERROR
*"----------------------------------------------------------------------

  IF I_REASON IS INITIAL.
    PERFORM CANCELAR_VIAGEM USING P_DOCNUM REASON REASON1 REASON2 REASON3 REASON4.
  ELSE.
    REASON  = I_REASON.
    REASON1 = I_REASON1.
    REASON2 = I_REASON2.
    REASON3 = I_REASON3.
    REASON4 = I_REASON4.
  ENDIF.

  IF REASON IS INITIAL.
    MESSAGE E026(ZCIOT) RAISING ERROR.
  ENDIF.

  " Caso o DOCSTAT seja diferente de 1 e 2 informar que a viagem n√£o pode ser cancelada.
*  SELECT SINGLE * FROM J_1BNFE_ACTIVE INTO DOCSTAT_J_1BNFE_ACTIVE WHERE DOCNUM EQ P_DOCNUM.

*  IF ( DOCSTAT_J_1BNFE_ACTIVE-NFNUM9 IS INITIAL ) .
*    MESSAGE E032(ZCIOT) RAISING ERROR WITH DOCSTAT_J_1BNFE_ACTIVE-DOCSTA.
*  ENDIF.

*  IF NOT ( DOCSTAT_J_1BNFE_ACTIVE-NFNUM9 IS INITIAL ) AND ( DOCSTAT_J_1BNFE_ACTIVE-DOCSTA IS INITIAL ) .
*    MESSAGE E032(ZCIOT) RAISING ERROR WITH DOCSTAT_J_1BNFE_ACTIVE-DOCSTA.
*  ENDIF.

ENDFUNCTION.
