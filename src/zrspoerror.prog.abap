***INCLUDE RSPOERROR .

DEFINE TEXT_MESSAGE.
  IF SY-SUBRC <> 0.
    MESSAGE ID SY-MSGID TYPE 'I' NUMBER SY-MSGNO
            WITH SY-MSGV1 SY-MSGV2 SY-MSGV3 SY-MSGV4 INTO &1.
    WRITE &1.
  ENDIF.
END-OF-DEFINITION.

DEFINE OUT_MESSAGE.
  IF SY-SUBRC <> 0.
    MESSAGE ID SY-MSGID TYPE &1 NUMBER SY-MSGNO
            WITH SY-MSGV1 SY-MSGV2 SY-MSGV3 SY-MSGV4.
  ENDIF.
  CLEAR SY-MSGNO.
END-OF-DEFINITION.


DEFINE RAISE_MESSAGE.
  IF SY-SUBRC <> 0.
    MESSAGE ID SY-MSGID TYPE SY-MSGTY NUMBER SY-MSGNO
            WITH SY-MSGV1 SY-MSGV2 SY-MSGV3 SY-MSGV4 RAISING ERROR.
  ELSE.
    CLEAR SY-MSGNO.
  ENDIF.
END-OF-DEFINITION.


* &1 = system
* gprog = called program
DEFINE RAISE_PROG_MESSAGE.
  IF SY-SUBRC <> 0.
    IF SY-MSGID IS INITIAL OR SY-MSGTY IS INITIAL OR
                              SY-MSGNO IS INITIAL.
      MESSAGE I105 WITH SY-SYSID GPROG SY-SUBRC RAISING ERROR.
    ENDIF.
    MESSAGE ID SY-MSGID TYPE SY-MSGTY NUMBER SY-MSGNO
            WITH SY-MSGV1 SY-MSGV2 SY-MSGV3 SY-MSGV4 RAISING ERROR.
  ELSE.
    CLEAR SY-MSGNO.
  ENDIF.
END-OF-DEFINITION.


DEFINE OUT_PROG_MESSAGE.
  IF SY-SUBRC <> 0.
    IF SY-MSGID IS INITIAL OR SY-MSGTY IS INITIAL OR
                              SY-MSGNO IS INITIAL.
      MESSAGE ID 'SP01R' TYPE &1 NUMBER 105
                 WITH SY-SYSID GPROG SY-SUBRC.
    ENDIF.
    MESSAGE ID SY-MSGID TYPE &1 NUMBER SY-MSGNO
            WITH SY-MSGV1 SY-MSGV2 SY-MSGV3 SY-MSGV4.
  ENDIF.
  CLEAR SY-MSGNO.
END-OF-DEFINITION.


DEFINE RAISE_RFC_MESSAGE.
  IF SY-SUBRC <> 0.
    IF SY-SUBRC > 100.
      TRC = SY-SUBRC.
      LONG_MSG = 'System x1: x2'(040).
      REPLACE 'x1' WITH &1 INTO LONG_MSG.
      REPLACE 'x2' WITH MSG_TEXT INTO LONG_MSG.
      MESSAGE ID 'SP01R' TYPE 'I' NUMBER TRC
                  WITH LONG_MSG RAISING ERROR.
    ENDIF.
    IF SY-MSGID IS INITIAL OR SY-MSGTY IS INITIAL OR
                            SY-MSGNO IS INITIAL.
      MESSAGE I105 WITH &1 GPROG SY-SUBRC RAISING ERROR.
    ENDIF.
    MESSAGE ID SY-MSGID TYPE SY-MSGTY NUMBER SY-MSGNO
               WITH SY-MSGV1 SY-MSGV2 SY-MSGV3 SY-MSGV4 RAISING ERROR.
  ELSE.
    CLEAR SY-MSGNO.
  ENDIF.
END-OF-DEFINITION.


DEFINE OUT_RFC_MESSAGE.
  IF SY-SUBRC <> 0.
    IF SY-SUBRC > 100.
      TRC = SY-SUBRC.
      LONG_MSG = 'System x1: x2'(040).
      REPLACE 'x1' WITH &1 INTO LONG_MSG.
      REPLACE 'x2' WITH MSG_TEXT INTO LONG_MSG.
      MESSAGE ID 'SP01R' TYPE &2 NUMBER TRC
                  WITH LONG_MSG.
    ELSEIF SY-MSGID IS INITIAL OR SY-MSGTY IS INITIAL OR
                            SY-MSGNO IS INITIAL.
      MESSAGE ID 'SP01R' TYPE &2 NUMBER 105 WITH &1 GPROG SY-SUBRC.
    ELSE.
      MESSAGE ID SY-MSGID TYPE &2 NUMBER SY-MSGNO
               WITH SY-MSGV1 SY-MSGV2 SY-MSGV3 SY-MSGV4.
    ENDIF.
  ENDIF.
  CLEAR SY-MSGNO.
END-OF-DEFINITION.
