FUNCTION ZDUE_DADOS_RETIFICAR.
*"----------------------------------------------------------------------
*"*"Interface local:
*"  IMPORTING
*"     REFERENCE(I_ID_DUE) TYPE  ZDE_ID_DUE
*"  EXPORTING
*"     VALUE(E_PESO_LIQ_RETIFICAR) TYPE  ZDE_PESO_LIQ_TOTAL
*"  TABLES
*"      T_NF_EXP_DUE TYPE  ZDE_NF_EXP_DUE_T OPTIONAL
*"----------------------------------------------------------------------

  DATA: LT_ZNOM_REME_NOTAS   TYPE TABLE OF ZNOM_REME_NOTAS    WITH HEADER LINE,
        LT_ZDOC_NF_PRODUTOR  TYPE TABLE OF ZDOC_NF_PRODUTOR   WITH HEADER LINE,
        LT_ZNOM_PROG_REME    TYPE TABLE OF TY_ZNOM_PROG_REME  WITH HEADER LINE,
        LT_ZSDT_EXPORT       TYPE TABLE OF ZSDT_EXPORT        WITH HEADER LINE,
        LT_ZSDT_RETLOTE      TYPE TABLE OF ZSDT_RETLOTE       WITH HEADER LINE,
        LT_ZSDT_RETLOTE_TER  TYPE TABLE OF ZSDT_RETLOTE_TER   WITH HEADER LINE,
        LT_ZDOC_EXP          TYPE TABLE OF ZDOC_EXP           WITH HEADER LINE,
        LT_VBFA              TYPE TABLE OF VBFA               WITH HEADER LINE,
        LT_J_1BNFDOC_EXP     TYPE TABLE OF TY_DOC_EXP         WITH HEADER LINE,
        LT_DOC_FAT_REF       TYPE TABLE OF TY_DOC_FAT_REF     WITH HEADER LINE,
        WL_NF_EXP_DUE        TYPE ZDE_NF_EXP_DUE.

  DATA: WL_DUE_RETIFICAR     TYPE ZSDT0170.

  CLEAR: E_PESO_LIQ_RETIFICAR,  T_NF_EXP_DUE[].

  DATA(_OK) = ABAP_FALSE.
  PERFORM F_DADOS_RETIFICACAO TABLES LT_ZDOC_EXP
                                     LT_ZNOM_PROG_REME
                                     LT_J_1BNFDOC_EXP
                                     LT_ZDOC_NF_PRODUTOR
                                     LT_ZSDT_EXPORT
                                     LT_ZSDT_RETLOTE
                                     LT_ZSDT_RETLOTE_TER
                                     LT_DOC_FAT_REF
                               USING I_ID_DUE
                            CHANGING WL_DUE_RETIFICAR
                                     _OK.

  CHECK _OK EQ ABAP_TRUE.

  LOOP AT LT_DOC_FAT_REF WHERE REGISTRO_CCT EQ ABAP_TRUE.
    ADD LT_DOC_FAT_REF-PESO_LIQ_TOTAL TO E_PESO_LIQ_RETIFICAR.
  ENDLOOP.

  LOOP AT LT_J_1BNFDOC_EXP.
    CLEAR: WL_NF_EXP_DUE.

    WL_NF_EXP_DUE-BRANCH  = LT_J_1BNFDOC_EXP-BRANCH.
    WL_NF_EXP_DUE-DOCNUM  = LT_J_1BNFDOC_EXP-DOCNUM.
    WL_NF_EXP_DUE-NFENUM  = LT_J_1BNFDOC_EXP-NFENUM.
    WL_NF_EXP_DUE-MENGE   = LT_J_1BNFDOC_EXP-MENGE.
    WL_NF_EXP_DUE-MEINS   = LT_J_1BNFDOC_EXP-MEINS.
    WL_NF_EXP_DUE-NETWR   = LT_J_1BNFDOC_EXP-NETWR.

    APPEND WL_NF_EXP_DUE TO T_NF_EXP_DUE.
  ENDLOOP.


ENDFUNCTION.
