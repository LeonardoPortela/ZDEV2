DESCRIBE TABLE  IT_VBAP LINES WA_QNTLINHA.
DATA DATA TYPE ZSDT0040-DT_ENTREGA_DEF.

CLEAR: WA_LINHA, ENTREGA.
DATA: WA_LINES TYPE ZTLINE.

LOOP AT IT_LINES INTO WA_LINES.
  IF WA_LINES-TDFORMAT NE 'N'.
    IF SY-TABIX EQ 1.
      WA_LINHA = WA_LINES-TDLINE.
    ELSE.
      CONCATENATE WA_LINHA WA_LINES-TDLINE
      INTO WA_LINHA SEPARATED BY SPACE.
    ENDIF.
  ENDIF.
ENDLOOP.

CASE WA_TSPAT-SPART.
  WHEN '02'. DATA = WA_0040-DT_ENTREGA_FET.
  WHEN '03'. DATA = WA_0040-DT_ENTREGA_DEF.
  WHEN '04'. DATA = WA_0040-DT_ENTREGA_SEM.
ENDCASE.

SELECT SINGLE LTX
  FROM T247
  INTO @DATA(MES)
  WHERE SPRAS EQ 'P'
  AND MNR EQ @DATA+4(2).

ENTREGA = |{ DATA+6(2) } de { MES } de { DATA(4) }|.

CALL FUNCTION 'CONVERSION_EXIT_CGCBR_OUTPUT'
  EXPORTING
    INPUT  = WA_KNA1-STCD1
  IMPORTING
    OUTPUT = CNPJ.

CASE WA_TCURT-WAERS.
  WHEN 'BRL'. MOEDA = 'Reais (R$)'.
  WHEN 'USD'. MOEDA = 'Dólar (U$)'.
ENDCASE.


*Passar parametros da agencia e conta.
IF TCODE EQ 'ZSDT0044' OR  TCODE EQ 'ZSDT0029'.
CASE WA_T001-BUKRS.
  WHEN '0035'.
  CONTA = '21021-8'.
  AGENCIA = '2482-1'.
  BANCO = 'Banco Bradesco (237)'.


  WHEN OTHERS.
   CONTA = '40016-9'.
  AGENCIA = '1676 '.
  BANCO = 'Banco Itaú (341)'.
ENDCASE.
ELSE.
  CONTA = '40016-9'.
  AGENCIA = '1676 '.
  BANCO = 'Banco Itaú (341)'.
ENDIF.
* busca descrição da cultura

SELECT SINGLE descricao
    FROM zsdt0038
    INTO DESC_CULT
     WHERE cultura EQ WA_0040-cultura.




