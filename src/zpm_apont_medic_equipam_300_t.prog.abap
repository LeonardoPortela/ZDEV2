*&---------------------------------------------------------------------*
*&  Include  ZPM_APONT_MEDIC_EQUIPAM_300_T
*&---------------------------------------------------------------------*

*&SPWIZARD: DECLARATION OF TABLECONTROL 'CRL_EQUIP' ITSELF
CONTROLS: CRL_EQUIP TYPE TABLEVIEW USING SCREEN 0300.

*&SPWIZARD: LINES OF TABLECONTROL 'CRL_EQUIP'
DATA:     G_CRL_EQUIP_LINES  LIKE SY-LOOPC.
DATA:     zzOK_CODE LIKE SY-UCOMM.

*&SPWIZARD: OUTPUT MODULE FOR TC 'CRL_EQUIP'. DO NOT CHANGE THIS LINE!
*&SPWIZARD: UPDATE LINES FOR EQUIVALENT SCROLLBAR
MODULE CRL_EQUIP_CHANGE_TC_ATTR OUTPUT.
  DESCRIBE TABLE IT_EQUIP LINES CRL_EQUIP-lines.
ENDMODULE.

*&SPWIZARD: OUTPUT MODULE FOR TC 'CRL_EQUIP'. DO NOT CHANGE THIS LINE!
*&SPWIZARD: GET LINES OF TABLECONTROL
MODULE CRL_EQUIP_GET_LINES OUTPUT.
  G_CRL_EQUIP_LINES = SY-LOOPC.
ENDMODULE.

*&SPWIZARD: INPUT MODUL FOR TC 'CRL_EQUIP'. DO NOT CHANGE THIS LINE!
*&SPWIZARD: MARK TABLE
MODULE CRL_EQUIP_MARK INPUT.
  DATA: g_CRL_EQUIP_wa2 like line of IT_EQUIP.
    if CRL_EQUIP-line_sel_mode = 1
    and IT_EQUIP-MARC = 'X'.
     loop at IT_EQUIP into g_CRL_EQUIP_wa2
       where MARC = 'X'.
       g_CRL_EQUIP_wa2-MARC = ''.
       modify IT_EQUIP
         from g_CRL_EQUIP_wa2
         transporting MARC.
     endloop.
  endif.
  MODIFY IT_EQUIP
    INDEX CRL_EQUIP-CURRENT_LINE
    TRANSPORTING MARC.
ENDMODULE.

*&SPWIZARD: INPUT MODULE FOR TC 'CRL_EQUIP'. DO NOT CHANGE THIS LINE!
*&SPWIZARD: PROCESS USER COMMAND
MODULE CRL_EQUIP_USER_COMMAND INPUT.
  zzOK_CODE = SY-UCOMM.
  PERFORM USER_OK_TC USING    'CRL_EQUIP'
                              'IT_EQUIP'
                              'MARC'
                     CHANGING zzOK_CODE.
  SY-UCOMM = zzOK_CODE.
ENDMODULE.
