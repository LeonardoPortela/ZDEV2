FUNCTION-POOL ZGFIQG000000000004.           "MESSAGE-ID ..
* version 2000
*function-pool /1BCDWB/IQG000000000004.
TYPE-POOLS: SLIS.
*report AQZZ/SAPQUERY/AM28============.
INCLUDE <SYMBOL>.
INCLUDE <ICON>.

CONSTANTS:
  BEGIN OF %IQID,"type aqliqid
    WORKSPACE TYPE AQL_WSID   VALUE 'G',
    USERGROUP TYPE AQL_UGROUP VALUE '/SAPQUERY/AM',
    QUERY     TYPE AQL_QUERY  VALUE '28',
    LID       TYPE AQL_LID    VALUE 'G00',
    STRUCT    TYPE AQL_TNAME  VALUE 'ZIQG000000000004',
    INFOSET   TYPE AQL_ISET   VALUE '/SAPQUERY/AM27',
  END OF %IQID.

DATA %RUNMODE TYPE AQLIMODE.

DATA %SELOPTIONS TYPE TABLE OF RSPARAMS WITH HEADER LINE.

FIELD-SYMBOLS <%SELOPT> TYPE RSPARAMS_TT.


TABLES T093B.
DATA: GD_T093C LIKE T093C.
DATA: GD_T093  LIKE T093.
DATA: TL_CAT TYPE SLIS_T_FIELDCAT_ALV.

DATA TEXT_ANLP_ANLN1 LIKE ANLH-ANLHTXT.
DATA TEXT_ANLP_ANLN2 LIKE ANLA-LETXT.
DATA TEXT_ANLP_BUKRS LIKE T001-BUTXT.
DATA TEXT_ANLP_CAUFN LIKE AUFK-KTEXT.
DATA TEXT_ANLP_GSBER LIKE TGSBT-GTEXT.
DATA TEXT_ANLP_KTOGR LIKE T095T-KTGRTX.
DATA TEXT_ANLP_PERAF LIKE DD07D-DDTEXT.
* TXT4
DATA %Z_0001(004) TYPE C .
* TXT12
DATA %Z_0005(012) TYPE C .
TABLES ANLP.
*include /1BCDWB/IQG000000000004DAT.

SELECTION-SCREEN BEGIN OF SCREEN 2000.
*include /1BCDWB/IQG000000000004SSCR.
SELECTION-SCREEN BEGIN OF BLOCK ISSEL
                        WITH FRAME TITLE TEXT-S01.
SELECT-OPTIONS BUKRS FOR ANLP-BUKRS MEMORY ID BUK .
SELECT-OPTIONS ANLAGE FOR ANLP-ANLN1 .
SELECT-OPTIONS UNTNR FOR ANLP-ANLN2 . SELECTION-SCREEN SKIP .
SELECT-OPTIONS SO_KOSTL FOR ANLP-KOSTL MEMORY ID KOS. SELECTION-SCREEN SKIP .
SELECT-OPTIONS GSBER FOR ANLP-GSBER. SELECTION-SCREEN SKIP .
SELECT-OPTIONS AFABE FOR ANLP-AFABER MEMORY ID AFB NO-EXTENSION NO INTERVALS. .
SELECT-OPTIONS GJAHR FOR ANLP-GJAHR NO-EXTENSION NO INTERVALS. .
SELECT-OPTIONS AFBPLE FOR ANLP-PERAF .SELECTION-SCREEN SKIP .
PARAMETERS RECAP AS CHECKBOX.
PARAMETERS DEPRE AS CHECKBOX.
PARAMETERS DEPREAC AS CHECKBOX.
SELECTION-SCREEN END OF BLOCK ISSEL.
SELECTION-SCREEN BEGIN OF BLOCK STDSEL WITH FRAME TITLE TEXT-S03.
PARAMETERS %LAYOUT TYPE SLIS_VARI MODIF ID LAY.
SELECTION-SCREEN END OF BLOCK STDSEL.
SELECTION-SCREEN END OF SCREEN 2000.

*include /1BCDWB/IQG000000000004SSCRAT.
AT SELECTION-SCREEN.
  TABLES SSCRFIELDS.
  CALL FUNCTION 'RSAQRT_LAYOUT_CHECK'
    EXPORTING
      VARIANT = %LAYOUT
    CHANGING
      RTMODE  = %RUNMODE.
  CALL FUNCTION 'RSAQRT_SSCR_TEST'
    EXPORTING
      SSCRUC = SSCRFIELDS-UCOMM
    TABLES
      SELOPT = <%SELOPT>
    CHANGING
      RTMODE = %RUNMODE
    EXCEPTIONS
      OTHERS = 1.
  IF SY-SUBRC <> 0.
    %RUNMODE-EXTR_ON = SPACE.
    %RUNMODE-SHOW_ON = SPACE.
  ENDIF.

AT SELECTION-SCREEN ON VALUE-REQUEST FOR %LAYOUT.
  CALL FUNCTION 'RSAQRT_LAYOUT_VALUE_REQUEST'
    CHANGING
      RTMODE  = %RUNMODE
      VARIANT = %LAYOUT.

AT SELECTION-SCREEN OUTPUT.
  CALL FUNCTION 'RSAQRT_SSCR_OUTPUT'
    CHANGING
      RTMODE = %RUNMODE.

INITIALIZATION.
  ASSIGN %SELOPTIONS[] TO <%SELOPT>.
  CALL FUNCTION 'RSAQRT_INITIALIZATION'
    EXPORTING
      IQID   = %IQID
    IMPORTING
      RTMODE = %RUNMODE.
  PERFORM %INITIALIZATION.

*---------------------------------------------------------------*
*       FORM %initialization                                    *
*---------------------------------------------------------------*

FORM %INITIALIZATION.


ENDFORM.                    "%initialization
DATA: %DBCURSOR  TYPE CURSOR,
      %AUTH_TABS TYPE AQTTABNAME.
