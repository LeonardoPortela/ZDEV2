
PROCESS BEFORE OUTPUT.
  MODULE LISTE_INITIALISIEREN.
  LOOP AT EXTRACT WITH CONTROL
   TCTRL_ZLEST0041 CURSOR NEXTLINE.
    MODULE LISTE_SHOW_LISTE.
    MODULE BUSCA_NOME_FORNECEDOR.
    MODULE BUSCA_NOME_MATERIAL.
  ENDLOOP.
*
PROCESS AFTER INPUT.
  "module zuser_comand.
  MODULE LISTE_EXIT_COMMAND AT EXIT-COMMAND.
  MODULE LISTE_BEFORE_LOOP.
  MODULE CABECALHO_EXCEL.

  LOOP AT EXTRACT.
    MODULE LISTE_INIT_WORKAREA.
    CHAIN.
      FIELD ZLEST0041-CENTRO_COMPRADOR .
      FIELD ZLEST0041-NR_NF .
      FIELD ZLEST0041-COD_CLIENTE .
      FIELD ZLEST0041-NR_NF_PROPRIA.
      FIELD ZLEST0041-SERIE_PROPRIA.
      FIELD ZLEST0041-SERIE .
      FIELD ZLEST0041-QUANTIDADE.
      FIELD ZLEST0041-DATA_EMISSAO.
      FIELD ZLEST0041-COD_MATERIAL .
      FIELD ZLEST0041-CH_REFERENCIA.

      FIELD ZLEST0041-USUARIO.
      FIELD ZLEST0041-DATA.
      FIELD ZLEST0041-HORA.

      MODULE SET_UPDATE_FLAG ON CHAIN-REQUEST.
    ENDCHAIN.

    FIELD NM_CLIENTE  MODULE BUSCA_NOME_FORNECEDOR.
    FIELD NM_MATERIAL MODULE BUSCA_NOME_MATERIAL.

    FIELD VIM_MARKED MODULE LISTE_MARK_CHECKBOX.
    CHAIN.
      FIELD ZLEST0041-CENTRO_COMPRADOR .
      FIELD ZLEST0041-NR_NF .
      FIELD ZLEST0041-COD_CLIENTE .
      FIELD ZLEST0041-SERIE .
      MODULE LISTE_UPDATE_LISTE.
    ENDCHAIN.

    MODULE DETALHE_EXCEL.

  ENDLOOP.

  MODULE FIM_EXCEL.



  MODULE LISTE_AFTER_LOOP.
