*----------------------------------------------------------------------*
***INCLUDE ZFIR0025_PBO.
*----------------------------------------------------------------------*
*&---------------------------------------------------------------------*
*&      Module  CRIA_OBJETOS_6500  OUTPUT
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
MODULE CRIA_OBJETOS_6500 OUTPUT.

  clear wa_layout.
  WA_LAYOUT-ZEBRA      = C_X.
*    WA_LAYOUT-NO_TOOLBAR = C_X.
*    WA_LAYOUT-SGL_CLK_HD = C_X.
  WA_LAYOUT-NO_ROWMARK = C_X.
*    WA_LAYOUT-COL_OPT    = C_X.
  WA_STABLE-ROW        = C_X.
  WA_LAYOUT-INFO_FNAME = 'COLOR'.

  WA_LAYOUT-NO_TOOLBAR = C_X.
  WA_LAYOUT-STYLEFNAME = 'STYLE2'.
  WA_LAYOUT-GRID_TITLE = ' '.
  "GRID14
  IF OBG_CONTEINER_CPA IS INITIAL.
    CREATE OBJECT OBG_CONTEINER_CPA
      EXPORTING
        CONTAINER_NAME = G_CC_PAGAR.


    CREATE OBJECT GRID14
      EXPORTING
        I_PARENT = OBG_CONTEINER_CPA.


    PERFORM MONTAR_LAYOUT_CPA.

    REFRESH: TL_FUNCTION.
    WL_FUNCTION = CL_GUI_ALV_GRID=>MC_FC_LOC_DELETE_ROW.
    APPEND WL_FUNCTION TO TL_FUNCTION.
    WL_FUNCTION = CL_GUI_ALV_GRID=>MC_FC_LOC_INSERT_ROW.
    APPEND WL_FUNCTION TO TL_FUNCTION.
    WL_FUNCTION = CL_GUI_ALV_GRID=>MC_FC_LOC_MOVE_ROW.
    APPEND WL_FUNCTION TO TL_FUNCTION.
    WL_FUNCTION = CL_GUI_ALV_GRID=>MC_FC_LOC_PASTE.
    APPEND WL_FUNCTION TO TL_FUNCTION.
    WL_FUNCTION = CL_GUI_ALV_GRID=>MC_FC_LOC_PASTE_NEW_ROW.
    APPEND WL_FUNCTION TO TL_FUNCTION.
    WL_FUNCTION = CL_GUI_ALV_GRID=>MC_FC_LOC_UNDO.
    APPEND WL_FUNCTION TO TL_FUNCTION.
    WL_FUNCTION = CL_GUI_ALV_GRID=>MC_FC_LOC_APPEND_ROW.
    APPEND WL_FUNCTION TO TL_FUNCTION.
    WL_FUNCTION = CL_GUI_ALV_GRID=>MC_FC_LOC_COPY.
    APPEND WL_FUNCTION TO TL_FUNCTION.
    WL_FUNCTION = CL_GUI_ALV_GRID=>MC_FC_LOC_COPY_ROW.
    APPEND WL_FUNCTION TO TL_FUNCTION.
    WL_FUNCTION = CL_GUI_ALV_GRID=>MC_FC_LOC_CUT.
    APPEND WL_FUNCTION TO TL_FUNCTION.

*    wa_layout-cwidth_opt = c_x.
    WA_LAYOUT-NO_TOOLBAR = SPACE.
*     WA_LAYOUT-COL_OPT    = C_X.
    WA_LAYOUT-STYLEFNAME = 'STYLE2'.
    WA_LAYOUT-GRID_TITLE = ''.
    WA_LAYOUT-NO_TOOLBAR = C_X.


    CALL METHOD GRID14->SET_TABLE_FOR_FIRST_DISPLAY
      EXPORTING
        IS_LAYOUT            = WA_LAYOUT
        IT_TOOLBAR_EXCLUDING = TL_FUNCTION
      CHANGING
        IT_FILTER            = TL_FILTER
        IT_FIELDCATALOG      = T_FIELDCATALOG[]
        IT_OUTTAB            = TG_PAGAR[].

    CALL METHOD GRID14->REGISTER_EDIT_EVENT
      EXPORTING
        I_EVENT_ID = CL_GUI_ALV_GRID=>MC_EVT_ENTER.

    SET HANDLER:
              LCL_EVENT_HANDLER=>ON_DATA_CHANGED_FINISHED_CP FOR GRID14,
              LCL_EVENT_HANDLER=>ON_DATA_CHANGED_CP FOR GRID14.

  ELSE.
    CALL METHOD GRID14->GET_FRONTEND_FIELDCATALOG
      IMPORTING
        ET_FIELDCATALOG = T_FIELDCATALOG[].
    LOOP AT T_FIELDCATALOG INTO W_FIELDCATALOG
     WHERE FIELDNAME EQ 'VLR_PGTO'
        OR FIELDNAME EQ 'VLR_COMP'
        OR FIELDNAME EQ 'VLR_SLD'.
      W_FIELDCATALOG-OUTPUTLEN = '15'.
      MODIFY T_FIELDCATALOG FROM W_FIELDCATALOG.
    ENDLOOP.
    CALL METHOD GRID14->SET_FRONTEND_FIELDCATALOG
      EXPORTING
        IT_FIELDCATALOG = T_FIELDCATALOG[].

    CALL METHOD GRID14->REFRESH_TABLE_DISPLAY
      EXPORTING
        IS_STABLE = WA_STABLE.
  ENDIF.

  IF OBG_CONTEINER_ADTA IS INITIAL.
    CREATE OBJECT OBG_CONTEINER_ADTA
      EXPORTING
        CONTAINER_NAME = G_CC_ADIANT.


    CREATE OBJECT GRID15
      EXPORTING
        I_PARENT = OBG_CONTEINER_ADTA.


    PERFORM MONTAR_LAYOUT_ADTA.

    REFRESH: TL_FUNCTION.
    WL_FUNCTION = CL_GUI_ALV_GRID=>MC_FC_LOC_DELETE_ROW.
    APPEND WL_FUNCTION TO TL_FUNCTION.
    WL_FUNCTION = CL_GUI_ALV_GRID=>MC_FC_LOC_INSERT_ROW.
    APPEND WL_FUNCTION TO TL_FUNCTION.
    WL_FUNCTION = CL_GUI_ALV_GRID=>MC_FC_LOC_MOVE_ROW.
    APPEND WL_FUNCTION TO TL_FUNCTION.
    WL_FUNCTION = CL_GUI_ALV_GRID=>MC_FC_LOC_PASTE.
    APPEND WL_FUNCTION TO TL_FUNCTION.
    WL_FUNCTION = CL_GUI_ALV_GRID=>MC_FC_LOC_PASTE_NEW_ROW.
    APPEND WL_FUNCTION TO TL_FUNCTION.
    WL_FUNCTION = CL_GUI_ALV_GRID=>MC_FC_LOC_UNDO.
    APPEND WL_FUNCTION TO TL_FUNCTION.
    WL_FUNCTION = CL_GUI_ALV_GRID=>MC_FC_LOC_APPEND_ROW.
    APPEND WL_FUNCTION TO TL_FUNCTION.
    WL_FUNCTION = CL_GUI_ALV_GRID=>MC_FC_LOC_COPY.
    APPEND WL_FUNCTION TO TL_FUNCTION.
    WL_FUNCTION = CL_GUI_ALV_GRID=>MC_FC_LOC_COPY_ROW.
    APPEND WL_FUNCTION TO TL_FUNCTION.
    WL_FUNCTION = CL_GUI_ALV_GRID=>MC_FC_LOC_CUT.
    APPEND WL_FUNCTION TO TL_FUNCTION.

*    wa_layout-cwidth_opt = c_x.
    WA_LAYOUT-NO_TOOLBAR = SPACE.
*     WA_LAYOUT-COL_OPT    = C_X.
    WA_LAYOUT-STYLEFNAME = 'STYLE2'.
    WA_LAYOUT-GRID_TITLE = ''.
    WA_LAYOUT-NO_TOOLBAR = C_X.


    CALL METHOD GRID15->SET_TABLE_FOR_FIRST_DISPLAY
      EXPORTING
        IS_LAYOUT            = WA_LAYOUT
        IT_TOOLBAR_EXCLUDING = TL_FUNCTION
      CHANGING
        IT_FILTER            = TL_FILTER
        IT_FIELDCATALOG      = T_FIELDCATALOG[]
        IT_OUTTAB            = TG_ADIANT[].

    CALL METHOD GRID15->REGISTER_EDIT_EVENT
      EXPORTING
        I_EVENT_ID = CL_GUI_ALV_GRID=>MC_EVT_ENTER.

    SET HANDLER:
              LCL_EVENT_HANDLER=>ON_DATA_CHANGED_FINISHED_ADT FOR GRID15,
              LCL_EVENT_HANDLER=>ON_DATA_CHANGED_ADT FOR GRID15.

  ELSE.
    CALL METHOD GRID15->GET_FRONTEND_FIELDCATALOG
      IMPORTING
        ET_FIELDCATALOG = T_FIELDCATALOG[].
    LOOP AT T_FIELDCATALOG INTO W_FIELDCATALOG
     WHERE FIELDNAME EQ 'VLR_PGTO'
        OR FIELDNAME EQ 'VLR_COMP'
        OR FIELDNAME EQ 'VLR_SLD'.
      W_FIELDCATALOG-OUTPUTLEN = '15'.
      MODIFY T_FIELDCATALOG FROM W_FIELDCATALOG.
    ENDLOOP.
    CALL METHOD GRID15->SET_FRONTEND_FIELDCATALOG
      EXPORTING
        IT_FIELDCATALOG = T_FIELDCATALOG[].

    CALL METHOD GRID15->REFRESH_TABLE_DISPLAY
      EXPORTING
        IS_STABLE = WA_STABLE.
  ENDIF.

ENDMODULE.
