*&---------------------------------------------------------------------*
*&  Include           MZLES003COCKPIT0004
*&---------------------------------------------------------------------*

SELECTION-SCREEN BEGIN OF SCREEN 0004 AS SUBSCREEN NESTING LEVEL 4.
SELECTION-SCREEN BEGIN OF BLOCK ZB01.
*SELECT-OPTIONS: PNRLOTE FOR ZPFE_LOTE-NM_LOTE,
*                PDTPOSI FOR ZPFE_LOTE-DT_POSICAO,
*                PCDADMI FOR ZPFE_LOTE-CD_ADIMINISTRA,
*                PEMPRES FOR ZPFE_LOTE-BUKRS,
*                PFILIAL FOR ZPFE_LOTE-BRANCH,
*                PTRANS  FOR LFA1-LIFNR,
*                PDACTE  FOR ZPFE_LOTE_ITEM-CTENUM,
*                PCONTRA FOR ZPFE_LOTE_ITEM-NUCONTRATO,
*                PDTAVEN FOR ZPFE_LOTE-DT_VENCIMENTO,
*                PTIPO   FOR ZPFE_LOTE-TPLOTE,
*                PSTATUS FOR ZPFE_LOTE-STATUS DEFAULT 'F',
*                PBAIXA  FOR ZPFE_LOTE_ITEM-DT_BAIXA,
*                DT_POS  FOR ZPFE_LOTE_ITEM-DT_BAIXA NO INTERVALS NO-EXTENSION .

SELECTION-SCREEN BEGIN OF LINE.
SELECTION-SCREEN COMMENT 1(18) TEXT-001 FOR FIELD PNRLOTE.
SELECT-OPTIONS: PNRLOTE FOR ZPFE_LOTE-NM_LOTE.
SELECTION-SCREEN POSITION 60.
SELECTION-SCREEN COMMENT 65(18) TEXT-002 FOR FIELD PTRANS.
SELECT-OPTIONS: PTRANS  FOR LFA1-LIFNR.
SELECTION-SCREEN END OF LINE.

SELECTION-SCREEN BEGIN OF LINE.
SELECTION-SCREEN COMMENT 1(18) TEXT-003 FOR FIELD PDTPOSI.
SELECT-OPTIONS: PDTPOSI FOR ZPFE_LOTE-DT_POSICAO.
SELECTION-SCREEN POSITION 60.
SELECTION-SCREEN COMMENT 65(18) TEXT-004 FOR FIELD PDACTE.
SELECT-OPTIONS: PDACTE  FOR ZPFE_LOTE_ITEM-CTENUM.
SELECTION-SCREEN END OF LINE.

SELECTION-SCREEN BEGIN OF LINE.
SELECTION-SCREEN COMMENT 1(18) TEXT-005 FOR FIELD PCDADMI.
SELECT-OPTIONS: PCDADMI FOR ZPFE_LOTE-CD_ADIMINISTRA.
SELECTION-SCREEN POSITION 60.
SELECTION-SCREEN COMMENT 65(18) TEXT-006 FOR FIELD PCONTRA.
SELECT-OPTIONS: PCONTRA FOR ZPFE_LOTE_ITEM-NUCONTRATO.
SELECTION-SCREEN END OF LINE.

SELECTION-SCREEN BEGIN OF LINE.
SELECTION-SCREEN COMMENT 1(18) TEXT-007 FOR FIELD PEMPRES.
SELECT-OPTIONS: PEMPRES FOR ZPFE_LOTE-BUKRS.
SELECTION-SCREEN POSITION 60.
SELECTION-SCREEN COMMENT 65(18) TEXT-008 FOR FIELD PBAIXA.
SELECT-OPTIONS: PBAIXA  FOR ZPFE_LOTE_ITEM-DT_BAIXA.
SELECTION-SCREEN END OF LINE.

SELECTION-SCREEN BEGIN OF LINE.
SELECTION-SCREEN COMMENT 1(18) TEXT-009 FOR FIELD PFILIAL.
SELECT-OPTIONS:  PFILIAL FOR ZPFE_LOTE-BRANCH.
SELECTION-SCREEN POSITION 60.
SELECTION-SCREEN COMMENT 65(18) TEXT-010 FOR FIELD DT_POS.
SELECT-OPTIONS: DT_POS  FOR ZPFE_LOTE_ITEM-DT_BAIXA NO INTERVALS NO-EXTENSION .
SELECTION-SCREEN END OF LINE.

SELECTION-SCREEN BEGIN OF LINE.
SELECTION-SCREEN COMMENT 1(18) TEXT-011 FOR FIELD PDTAVEN.
SELECT-OPTIONS:  PDTAVEN FOR ZPFE_LOTE-DT_VENCIMENTO.
SELECTION-SCREEN END OF LINE.

SELECTION-SCREEN BEGIN OF LINE.
SELECTION-SCREEN COMMENT 1(18) TEXT-012 FOR FIELD PTIPO.
SELECT-OPTIONS:  PTIPO FOR ZPFE_LOTE-TPLOTE.
SELECTION-SCREEN END OF LINE.

SELECTION-SCREEN BEGIN OF LINE.
SELECTION-SCREEN COMMENT 1(18) TEXT-013 FOR FIELD PSTATUS.
SELECT-OPTIONS:  PSTATUS FOR ZPFE_LOTE-STATUS DEFAULT 'F'.
SELECTION-SCREEN END OF LINE.

*SELECT-OPTIONS: PDTAVEN FOR ZPFE_LOTE-DT_VENCIMENTO,
*                PTIPO   FOR ZPFE_LOTE-TPLOTE,
*                PSTATUS FOR ZPFE_LOTE-STATUS DEFAULT 'F'.
**--> Mes / Ano
*SELECTION-SCREEN BEGIN OF LINE.
*SELECTION-SCREEN COMMENT 1(10) TEXT-001 FOR FIELD P_MES.
*SELECTION-SCREEN POSITION POS_LOW.
*PARAMETERS P_MES    TYPE ZTBMM122-MES_REF. "OBLIGATORY.
*SELECTION-SCREEN POSITION 40.
*PARAMETERS P_ANO    TYPE ZTBMM122-ANO_REF. "OBLIGATORY.
*SELECTION-SCREEN END OF LINE.
SELECTION-SCREEN END OF BLOCK ZB01.
SELECTION-SCREEN END OF SCREEN 0004.

*&---------------------------------------------------------------------*
*&      Form  PESQUISA_LOTE
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
FORM PESQUISA_LOTE .
  LOOP AT DT_POS.
    DT_POS-OPTION = 'LE'.
    MODIFY DT_POS.

  ENDLOOP.
  IF DT_POS[] IS NOT INITIAL.
    REFRESH: PSTATUS.
  ENDIF.

  CALL FUNCTION 'Z_PFE_PSQ_LOTE'
    EXPORTING
      PNRLOTE      = PNRLOTE[]
      PDTPOSI      = PDTPOSI[]
      PCDADMI      = PCDADMI[]
      PEMPRES      = PEMPRES[]
      PFILIAL      = PFILIAL[]
      PDTAVEN      = PDTAVEN[]
      PTIPO        = PTIPO[]
      PSTATUS      = PSTATUS[]
      PCONTRA      = PCONTRA[]
      PTRANS       = PTRANS[]
      PDACTE       = PDACTE[]
      PBAIXA       = PBAIXA[]
      PDTPOS       = DT_POS[]
    TABLES
      IT_LOTES     = IT_LOTES
      IT_LOTES_ALV = IT_LOTES_ALV.

ENDFORM.                    " PESQUISA_LOTE
