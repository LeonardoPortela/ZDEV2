DATA: WL_T001     TYPE T001,
      WL_LFA1     TYPE LFA1,
      WL_ZFIT0091 TYPE ZHCMT_PA_0009.

LOOP AT IT_DATA INTO WL_ZFIT0091.
*Seleciona Empresa.
  SELECT SINGLE *
    FROM T001
    INTO WL_T001
   WHERE BUKRS = WL_ZFIT0091-BUKRS.

  WL_SAIDA-BUKRS = WL_T001-BUKRS.
  WL_SAIDA-BUTXT = WL_T001-BUTXT.

  SELECT SINGLE *
    FROM PA0465
    INTO @DATA(_DADOS_PESSOAIS)
  WHERE PERNR = @WL_ZFIT0091-PERNR.

  SELECT SINGLE RBETR ZNME1
    FROM REGUH
    INTO (WL_SAIDA-VLR_PGTO, WL_SAIDA-FAVORECIDO)
   WHERE VBLNR = WL_ZFIT0091-VBLNR.

  PERFORM F_STRLEN(ZHCMR_PA0029) USING WL_ZFIT0091-AGENCIA
                        CHANGING WL_SAIDA-AGENCIA.

  PERFORM F_STRLEN(ZHCMR_PA0029) USING WL_ZFIT0091-CONTA_CORRENTE
                        CHANGING WL_SAIDA-CONTA_CORRENTE.

  SHIFT WL_SAIDA-CONTA_CORRENTE LEFT DELETING LEADING '0'.

  WL_SAIDA-VLR_PGTO      = WL_SAIDA-VLR_PGTO * -1.
  WL_SAIDA-CNPJ_EMPRESA  = WL_ZFIT0091-CNPJ_EMPRESA.
  WL_SAIDA-CPF           = _DADOS_PESSOAIS-CPF_NR.
  WL_SAIDA-MATRICULA     = _DADOS_PESSOAIS-PERNR.
  WL_SAIDA-COD_AUTENT    = WL_ZFIT0091-COD_AUTENT.
*  WL_SAIDA-COD_BARRAS    = WL_ZFIT0091-COD_BARRAS.

* Concatena Banco + Agência + Dígito;
  IF WL_ZFIT0091-DV_AG_FAV IS INITIAL.
    WL_SAIDA-BCO_AG_FAV = WL_ZFIT0091-BCO_FAV
                       && WL_ZFIT0091-AG_FAV.
  ELSE.
    WL_SAIDA-BCO_AG_FAV = WL_ZFIT0091-BCO_FAV
                       && WL_ZFIT0091-AG_FAV
                       && '-'
                       && WL_ZFIT0091-DV_AG_FAV.
  ENDIF.

* Concatena Conta Corrente + Digito;
  IF WL_ZFIT0091-DV_FAV IS NOT INITIAL.
    WL_SAIDA-CC_FAV = WL_ZFIT0091-CC_FAV && '-' && WL_ZFIT0091-DV_FAV.
  ELSE.
    WL_SAIDA-CC_FAV = WL_ZFIT0091-CC_FAV.
  ENDIF.

  SHIFT WL_SAIDA-CC_FAV LEFT DELETING LEADING '0'.

* Formata a data.
  CONCATENATE WL_ZFIT0091-DT_PGTO+6(2) '/'
  WL_ZFIT0091-DT_PGTO+4(2) '/' WL_ZFIT0091-DT_PGTO(4)
  INTO WL_SAIDA-DT_PAGAMENTO.

* Nomeia o banco.
  CASE WL_ZFIT0091-BANCO.
    WHEN '001'.
      WL_SAIDA-BCO_EMPRESA = 'BANCO DO BRASIL'.
    WHEN '237'.
      WL_SAIDA-BCO_EMPRESA = 'BANCO BRADESCO'.
    WHEN '399'.
      WL_SAIDA-BCO_EMPRESA = 'BANCO HSBC'.
    WHEN OTHERS.
  ENDCASE.

  APPEND WL_SAIDA TO GT_SAIDA.
ENDLOOP.
