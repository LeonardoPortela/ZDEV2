*&---------------------------------------------------------------------*
*&  Include           ZSDR0092_TOP
*&---------------------------------------------------------------------*

REPORT ZSDR0092.

TABLES: ZSDT0169, ZSDT0167, ZSDT0168.

TYPES: BEGIN OF TY_ESTRUTURA.
        INCLUDE TYPE SLIS_FIELDCAT_MAIN.
        INCLUDE TYPE SLIS_FIELDCAT_ALV_SPEC.
TYPES: END OF TY_ESTRUTURA.

TYPES: BEGIN OF TY_SAIDA_0100,
         DS_URF          TYPE ZSDT0167-DS_URF,
         DS_RA           TYPE ZSDT0168-DS_RA,
         LOCAL_DESPACHO  TYPE ZSDT0168-LOCAL_DESPACHO,
         LOCAL_EMBARQUE  TYPE ZSDT0168-LOCAL_EMBARQUE,
         LIFNR           TYPE ZSDT0168-LIFNR.
         INCLUDE STRUCTURE ZSDT0169.
TYPES END OF TY_SAIDA_0100.

TYPES: BEGIN OF TY_SAIDA_0120,
         CK_MODIFY TYPE C,
         ESTILO    TYPE LVC_T_STYL.
         INCLUDE STRUCTURE ZSDT0167.
TYPES END OF TY_SAIDA_0120.

TYPES: BEGIN OF TY_SAIDA_0130,
         CK_MODIFY TYPE C,
         ESTILO    TYPE LVC_T_STYL.
         INCLUDE STRUCTURE ZSDT0168.
TYPES END OF TY_SAIDA_0130.

*---------------------------------------------------------------------*
*  Inicio Definition Classes
*---------------------------------------------------------------------*

CLASS LCL_ALV_TOOLBAR_0100 DEFINITION.
  PUBLIC SECTION.
*Constructor
    METHODS: CONSTRUCTOR
                IMPORTING IO_ALV_GRID TYPE REF TO CL_GUI_ALV_GRID,
*Event for toolbar
    ON_TOOLBAR FOR EVENT TOOLBAR OF CL_GUI_ALV_GRID
               IMPORTING  E_OBJECT,

    HANDLE_USER_COMMAND FOR EVENT USER_COMMAND OF CL_GUI_ALV_GRID
               IMPORTING E_UCOMM.

ENDCLASS.                    "LCL_ALV_TOOLBAR DEFINITION


CLASS LCL_ALV_TOOLBAR_0120 DEFINITION.
  PUBLIC SECTION.
*Constructor
    METHODS: CONSTRUCTOR
                IMPORTING IO_ALV_GRID TYPE REF TO CL_GUI_ALV_GRID,
*Event for toolbar
    ON_TOOLBAR FOR EVENT TOOLBAR OF CL_GUI_ALV_GRID
               IMPORTING  E_OBJECT,

    HANDLE_USER_COMMAND FOR EVENT USER_COMMAND OF CL_GUI_ALV_GRID
               IMPORTING E_UCOMM.

ENDCLASS.                    "LCL_ALV_TOOLBAR DEFINITION


CLASS LCL_ALV_TOOLBAR_0130 DEFINITION.
  PUBLIC SECTION.
*Constructor
    METHODS: CONSTRUCTOR
                IMPORTING IO_ALV_GRID TYPE REF TO CL_GUI_ALV_GRID,
*Event for toolbar
    ON_TOOLBAR FOR EVENT TOOLBAR OF CL_GUI_ALV_GRID
               IMPORTING  E_OBJECT,

    HANDLE_USER_COMMAND FOR EVENT USER_COMMAND OF CL_GUI_ALV_GRID
               IMPORTING E_UCOMM.

ENDCLASS.                    "LCL_ALV_TOOLBAR DEFINITION

CLASS LCL_EVENT_HANDLER_0100 DEFINITION.
  PUBLIC SECTION.

    CLASS-METHODS:
      CATCH_HOTSPOT FOR EVENT HOTSPOT_CLICK OF CL_GUI_ALV_GRID
            IMPORTING E_ROW_ID E_COLUMN_ID ES_ROW_NO.
ENDCLASS.

CLASS LCL_EVENT_HANDLER_0120 DEFINITION.

  PUBLIC SECTION.

    CLASS-METHODS:
       ON_DATA_CHANGED_FINISHED FOR EVENT DATA_CHANGED_FINISHED OF CL_GUI_ALV_GRID
                        IMPORTING E_MODIFIED ET_GOOD_CELLS.


    CLASS-METHODS: ON_DATA_CHANGED FOR EVENT DATA_CHANGED OF CL_GUI_ALV_GRID
                        IMPORTING ER_DATA_CHANGED
                                  E_ONF4
                                  E_ONF4_BEFORE
                                  E_ONF4_AFTER
                                  E_UCOMM .

ENDCLASS.

CLASS LCL_EVENT_HANDLER_0130 DEFINITION.

  PUBLIC SECTION.

    CLASS-METHODS:
       ON_DATA_CHANGED_FINISHED FOR EVENT DATA_CHANGED_FINISHED OF CL_GUI_ALV_GRID
                        IMPORTING E_MODIFIED ET_GOOD_CELLS.

    CLASS-METHODS: ON_DATA_CHANGED FOR EVENT DATA_CHANGED OF CL_GUI_ALV_GRID
                        IMPORTING ER_DATA_CHANGED
                                  E_ONF4
                                  E_ONF4_BEFORE
                                  E_ONF4_AFTER
                                  E_UCOMM .

ENDCLASS.

DATA: OBJ_ALV_0100         TYPE REF TO CL_GUI_ALV_GRID,
      OBJ_CONTAINER_0100   TYPE REF TO CL_GUI_CUSTOM_CONTAINER,
      OBJ_ALV_0120         TYPE REF TO CL_GUI_ALV_GRID,
      OBJ_CONTAINER_0120   TYPE REF TO CL_GUI_CUSTOM_CONTAINER,
      OBJ_ALV_0130         TYPE REF TO CL_GUI_ALV_GRID,
      OBJ_CONTAINER_0130   TYPE REF TO CL_GUI_CUSTOM_CONTAINER.

DATA: GT_CATALOG       TYPE LVC_T_FCAT,
      GW_CATALOG       TYPE LVC_S_FCAT.

DATA: OBJ_TOOLBAR_0100 TYPE REF TO LCL_ALV_TOOLBAR_0100,
      OBJ_TOOLBAR_0120 TYPE REF TO LCL_ALV_TOOLBAR_0120,
      OBJ_TOOLBAR_0130 TYPE REF TO LCL_ALV_TOOLBAR_0130.

* ALV field catalogs
DATA: IT_FCAT    TYPE LVC_T_FCAT,
      WA_FCAT    TYPE LVC_S_FCAT.

* ALV excluded functions
DATA: IT_EXCLUDE_FCODE TYPE UI_FUNCTIONS,
      WA_EXCLUDE_FCODE LIKE LINE OF IT_EXCLUDE_FCODE.

* Alv Styles
DATA: LS_EDIT         TYPE LVC_S_STYL,
      LT_EDIT         TYPE LVC_T_STYL.

* ALV layout variant
DATA: GS_VARIANT       TYPE DISVARIANT.

* ALV layout
DATA: GS_LAYOUT        TYPE LVC_S_LAYO.

* ALV Stable
DATA: WA_STABLE        TYPE LVC_S_STBL.

DATA: IT_SELECTEDCELL  TYPE LVC_T_CELL,
      WA_SELECTEDCELL  TYPE LVC_S_CELL.

DATA: IT_SEL_ROWS         TYPE LVC_T_ROW,
      WA_SEL_ROWS         TYPE LVC_S_ROW.

DATA: GT_ESTILO   TYPE LVC_T_STYL WITH HEADER LINE,
      WL_ESTILO   TYPE LVC_S_STYL.

DATA: GT_F4  TYPE LVC_T_F4 WITH HEADER LINE.

* Objetos
DATA: C_ALV_TOOLBARMANAGER TYPE REF TO CL_ALV_GRID_TOOLBAR_MANAGER,
      TY_TOOLBAR TYPE STB_BUTTON.

DATA: WA_ESTRUTURA       TYPE TY_ESTRUTURA,
      ESTRUTURA          TYPE TABLE OF TY_ESTRUTURA.

*-------------------------------------------------------------------
* Tabelas Internas and Work Areas.
*-------------------------------------------------------------------
DATA: IT_SAIDA_0100     TYPE TABLE OF TY_SAIDA_0100,
      WA_SAIDA_0100     TYPE TY_SAIDA_0100,
      IT_SAIDA_0120     TYPE TABLE OF TY_SAIDA_0120,
      WA_SAIDA_0120     TYPE TY_SAIDA_0120,
      IT_SAIDA_0130     TYPE TABLE OF TY_SAIDA_0130,
      WA_SAIDA_0130     TYPE TY_SAIDA_0130,
      TG_0167           TYPE TABLE OF ZSDT0167 WITH HEADER LINE,
      TG_0168           TYPE TABLE OF ZSDT0168 WITH HEADER LINE,
      TG_0169           TYPE TABLE OF ZSDT0169 WITH HEADER LINE.

*-------------------------------------------------------------------
* VÃ¡riaveis
*-------------------------------------------------------------------
DATA: VG_OPERACAO TYPE C LENGTH 20,
      VAR_ANSWER  TYPE C.

*-------------------------------------------------------------------
* Constantes
*-------------------------------------------------------------------
CONSTANTS: C_NOVO   TYPE C VALUE 'NOVO'   LENGTH 4,
           C_DEL    TYPE C VALUE 'DEL'    LENGTH 4,
           C_CHANGE TYPE C VALUE 'CHANGE' LENGTH 6.

INITIALIZATION.

  PERFORM: F_SELECIONAR_DADOS,
           F_PROCESSA_DADOS.

  CALL SCREEN 0100.
