*----------------------------------------------------------------------*
***INCLUDE MZDRE0001_9007 .
*----------------------------------------------------------------------*

*&---------------------------------------------------------------------*
*&      Module  STATUS_9007  OUTPUT
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
MODULE STATUS_9007 OUTPUT.

  SET PF-STATUS 'PF9003'.
  SET TITLEBAR 'TL9007'.

  CLEAR: VG_CC_GRUPO,
         VG_CC_GRUPO_2,
         VG_CC_GRUPO_3,
         VG_CC_GRUPO_4,
         VG_CC_GRUPO_5.


  IF NOT ZGL015_DRE_EST04-KOSAR IS INITIAL.

    SELECT SINGLE KTEXT INTO VG_CC_GRUPO
      FROM TKT05
     WHERE SPRAS EQ SY-LANGU
       AND KOSAR EQ ZGL015_DRE_EST04-KOSAR.


    IF NOT ( LS_KOSAR_2 IS INITIAL ).
      SELECT SINGLE KTEXT INTO VG_CC_GRUPO_2
        FROM TKT05
       WHERE SPRAS EQ SY-LANGU
         AND KOSAR EQ LS_KOSAR_2.
    ENDIF.

    IF NOT ( LS_KOSAR_3 IS INITIAL ).
      SELECT SINGLE KTEXT INTO VG_CC_GRUPO_3
        FROM TKT05
       WHERE SPRAS EQ SY-LANGU
         AND KOSAR EQ LS_KOSAR_3.
    ENDIF.

    IF NOT ( LS_KOSAR_4 IS INITIAL ).
      SELECT SINGLE KTEXT INTO VG_CC_GRUPO_4
        FROM TKT05
       WHERE SPRAS EQ SY-LANGU
         AND KOSAR EQ LS_KOSAR_4.
    ENDIF.

    IF NOT ( LS_KOSAR_5 IS INITIAL ).
      SELECT SINGLE KTEXT INTO VG_CC_GRUPO_5
         FROM TKT05
        WHERE SPRAS EQ SY-LANGU
          AND KOSAR EQ LS_KOSAR_5.
    ENDIF.

  ENDIF.
ENDMODULE.                 " STATUS_9007  OUTPUT

*&---------------------------------------------------------------------*
*&      Module  USER_COMMAND_9007_EXIT  INPUT
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
MODULE USER_COMMAND_9007_EXIT INPUT.
  LEAVE TO SCREEN 0.
ENDMODULE.                 " USER_COMMAND_9007_EXIT  INPUT

*&---------------------------------------------------------------------*
*&      Module  USER_COMMAND_9007  INPUT
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
MODULE USER_COMMAND_9007 INPUT.

  DATA: VG_CCC   TYPE ZGL015_DRE_EST04,
        CCC_CADAS TYPE CHAR50.

  IF OK_CODE_9007 EQ C_CONF.


    IF NOT ( ZGL015_DRE_EST04-KOSAR IS INITIAL ).

      SELECT SINGLE * INTO VG_CCC
        FROM ZGL015_DRE_EST04
       WHERE BUKRS EQ ZGL015_DRE_EST04-BUKRS
         AND VERSN EQ ZGL015_DRE_EST04-VERSN
         AND NIVEL EQ ZGL015_DRE_EST04-NIVEL
         AND KTOPL EQ ZGL015_DRE_EST04-KTOPL
         AND SAKNR EQ ZGL015_DRE_EST04-SAKNR
         AND KOSAR EQ ZGL015_DRE_EST04-KOSAR.

      IF SY-SUBRC IS INITIAL.
        CLEAR: CCC_CADAS.
        CONCATENATE 'Tipo de Centro de Custo já cadastrado!' ZGL015_DRE_EST04-KOSAR INTO CCC_CADAS.
        MESSAGE CCC_CADAS TYPE 'E'.
      ENDIF.

      MODIFY ZGL015_DRE_EST04.

      PRIM_DRE_NIVEL_RE = C_X.
      MOVE-CORRESPONDING ZGL015_DRE_EST04 TO ZGL015_DRE_EST02.

    ENDIF.

    IF NOT ( LS_KOSAR_2 IS INITIAL ).

      SELECT SINGLE * INTO VG_CCC
        FROM ZGL015_DRE_EST04
       WHERE BUKRS EQ ZGL015_DRE_EST04-BUKRS
         AND VERSN EQ ZGL015_DRE_EST04-VERSN
         AND NIVEL EQ ZGL015_DRE_EST04-NIVEL
         AND KTOPL EQ ZGL015_DRE_EST04-KTOPL
         AND SAKNR EQ ZGL015_DRE_EST04-SAKNR
         AND KOSAR EQ LS_KOSAR_2.

      IF SY-SUBRC IS INITIAL.
        CLEAR: CCC_CADAS.
        CONCATENATE 'Tipo de Centro de Custo já cadastrado!' LS_KOSAR_2 INTO CCC_CADAS.
        MESSAGE CCC_CADAS TYPE 'E'.
      ENDIF.

      ZGL015_DRE_EST04-KOSAR = LS_KOSAR_2.
      MODIFY ZGL015_DRE_EST04.

      PRIM_DRE_NIVEL_RE = C_X.
      MOVE-CORRESPONDING ZGL015_DRE_EST04 TO ZGL015_DRE_EST02.

    ENDIF.


    IF NOT ( LS_KOSAR_3 IS INITIAL ).

      SELECT SINGLE * INTO VG_CCC
        FROM ZGL015_DRE_EST04
       WHERE BUKRS EQ ZGL015_DRE_EST04-BUKRS
         AND VERSN EQ ZGL015_DRE_EST04-VERSN
         AND NIVEL EQ ZGL015_DRE_EST04-NIVEL
         AND KTOPL EQ ZGL015_DRE_EST04-KTOPL
         AND SAKNR EQ ZGL015_DRE_EST04-SAKNR
         AND KOSAR EQ LS_KOSAR_3.

      IF SY-SUBRC IS INITIAL.
        CLEAR: CCC_CADAS.
        CONCATENATE 'Tipo de Centro de Custo já cadastrado!' LS_KOSAR_3 INTO CCC_CADAS.
        MESSAGE CCC_CADAS TYPE 'E'.
      ENDIF.

      ZGL015_DRE_EST04-KOSAR = LS_KOSAR_3.
      MODIFY ZGL015_DRE_EST04.

      PRIM_DRE_NIVEL_RE = C_X.
      MOVE-CORRESPONDING ZGL015_DRE_EST04 TO ZGL015_DRE_EST02.

    ENDIF.

    IF NOT ( LS_KOSAR_4 IS INITIAL ).

      SELECT SINGLE * INTO VG_CCC
        FROM ZGL015_DRE_EST04
       WHERE BUKRS EQ ZGL015_DRE_EST04-BUKRS
         AND VERSN EQ ZGL015_DRE_EST04-VERSN
         AND NIVEL EQ ZGL015_DRE_EST04-NIVEL
         AND KTOPL EQ ZGL015_DRE_EST04-KTOPL
         AND SAKNR EQ ZGL015_DRE_EST04-SAKNR
         AND KOSAR EQ LS_KOSAR_4.

      IF SY-SUBRC IS INITIAL.
        CLEAR: CCC_CADAS.
        CONCATENATE 'Tipo de Centro de Custo já cadastrado!' LS_KOSAR_4 INTO CCC_CADAS.
        MESSAGE CCC_CADAS TYPE 'E'.
      ENDIF.

      ZGL015_DRE_EST04-KOSAR = LS_KOSAR_4.
      MODIFY ZGL015_DRE_EST04.

      PRIM_DRE_NIVEL_RE = C_X.
      MOVE-CORRESPONDING ZGL015_DRE_EST04 TO ZGL015_DRE_EST02.

    ENDIF.

    IF NOT ( LS_KOSAR_5 IS INITIAL ).

      SELECT SINGLE * INTO VG_CCC
        FROM ZGL015_DRE_EST04
       WHERE BUKRS EQ ZGL015_DRE_EST04-BUKRS
         AND VERSN EQ ZGL015_DRE_EST04-VERSN
         AND NIVEL EQ ZGL015_DRE_EST04-NIVEL
         AND KTOPL EQ ZGL015_DRE_EST04-KTOPL
         AND SAKNR EQ ZGL015_DRE_EST04-SAKNR
         AND KOSAR EQ LS_KOSAR_5.

      IF SY-SUBRC IS INITIAL.
        CLEAR: CCC_CADAS.
        CONCATENATE 'Tipo de Centro de Custo já cadastrado!' LS_KOSAR_5 INTO CCC_CADAS.
        MESSAGE CCC_CADAS TYPE 'E'.
      ENDIF.

      ZGL015_DRE_EST04-KOSAR = LS_KOSAR_5.
      MODIFY ZGL015_DRE_EST04.

      PRIM_DRE_NIVEL_RE = C_X.
      MOVE-CORRESPONDING ZGL015_DRE_EST04 TO ZGL015_DRE_EST02.

    ENDIF.

    CALL METHOD G_TREE->DELETE_ALL_NODES.
    LEAVE TO SCREEN 0.
  ENDIF.

ENDMODULE.                 " USER_COMMAND_9007  INPUT
