FUNCTION-POOL ZDRE.                         "MESSAGE-ID ..


RANGES: P_MONAT   FOR ZGL020_DRE_DADOS-MONAT,
        P_BUKRS   FOR ZGL020_DRE_DADOS-BUKRS,
        P_VERSN   FOR ZGL020_DRE_DADOS-VERSN,
        P_VBUND   FOR ZGL029_DRE_DADOS-VBUND.

DATA  : P_WAERS   TYPE T005-WAERS.
*----------------------------------------------------------------------*
* ESTUTURAS
*----------------------------------------------------------------------*
TYPES: BEGIN OF TY_EXCEL,
         BUKRS     TYPE ZGL021_DRE_DADOS-BUKRS,
         VERSN     TYPE ZGL021_DRE_DADOS-VERSN,
         MONAT     TYPE ZGL021_DRE_DADOS-MONAT,
         GJAHR     TYPE ZGL021_DRE_DADOS-GJAHR,
         NIVEL     TYPE ZGL021_DRE_DADOS-NIVEL,
         SAKNR     TYPE ZGL021_DRE_DADOS-SAKNR,
         DESC(70),
         QTD_TON   TYPE ZGL024_DRE_DADOS-QTD_TON,
         VLR_REA   TYPE ZGL021_DRE_DADOS-VLR_REA,
         VLR_DOLAR TYPE ZGL021_DRE_DADOS-VLR_DOLAR,
         VLR_GRUPO TYPE ZGL021_DRE_DADOS-VLR_GRUPO,
        END OF TY_EXCEL,

        BEGIN OF TY_FILE,
          FIELD(1000),
        END OF TY_FILE.



TYPES: BEGIN OF TP_CUSTO.
TYPES:  KOKRS	TYPE KOKRS,
        KOSTL	TYPE KOSTL,
        LTEXT	TYPE KLTXT.
        INCLUDE STRUCTURE ZGL015_DRE_EST04.
TYPES: END OF TP_CUSTO.

TYPES: BEGIN OF TP_DRE_DADOS.
TYPES: ICOST       TYPE CHAR04,
       ICOLI       TYPE CHAR04,
       IREPO       TYPE CHAR04,
       BUTXT       TYPE BUTXT,
       VSTXT       TYPE VSTXT_011T,
       STATUS_PROT TYPE C LENGTH 8,
       ROWCOLOR    TYPE CHAR04.
        INCLUDE STRUCTURE ZGL020_DRE_DADOS.
TYPES: END OF TP_DRE_DADOS.

TYPES: BEGIN OF TP_CONTA_RAZAO.
TYPES:  ID TYPE TV_NODEKEY,
        TX TYPE TXT50_SKAT.
        INCLUDE STRUCTURE ZGL015_DRE_EST03.
TYPES: END OF TP_CONTA_RAZAO.

TYPES: BEGIN OF TP_CENTRO_CUSTO.
TYPES:  ID TYPE TV_NODEKEY,
        TX TYPE KTEXT.
        INCLUDE STRUCTURE ZGL015_DRE_EST04.
TYPES: END OF TP_CENTRO_CUSTO.

TYPES: BEGIN OF TP_CENTRO_LUCRO.
TYPES:  ID TYPE TV_NODEKEY,
        TX TYPE LTEXT.
        INCLUDE STRUCTURE ZGL015_DRE_EST05.
TYPES: END OF TP_CENTRO_LUCRO.

TYPES: BEGIN OF TP_GRUPO_MATERIAL.
TYPES:  ID TYPE TV_NODEKEY,
        TX TYPE WGBEZ60.
        INCLUDE STRUCTURE ZGL015_DRE_EST06.
TYPES: END OF TP_GRUPO_MATERIAL.

TYPES: BEGIN OF TP_NIVEL_AGRUPADO.
TYPES:  ID TYPE TV_NODEKEY,
        TX TYPE CHAR50.
        INCLUDE STRUCTURE ZGL015_DRE_EST07.
TYPES: END OF TP_NIVEL_AGRUPADO.

TYPES: BEGIN OF TP_DRE_EST02.
TYPES:   NV01(02) type C ,
         NV02(02) type C ,
         NV03(02) type C ,
         NV04(02) type C ,
         NV05(02) type C ,
         NA01(02) type C ,
         NA02(02) type C ,
         NA03(02) type C ,
         NA04(02) type C ,
         NITXT_ANT  TYPE CHAR50.
        INCLUDE STRUCTURE ZGL015_DRE_EST02.
TYPES: END OF TP_DRE_EST02.

TYPES: BEGIN OF TY_ZGL029_DRE_AUX.
        INCLUDE STRUCTURE ZGL029_DRE_DADOS.
TYPES:  CTA_VIRTUAL   TYPE ZGLT060-CTA_VIRTUAL,
        KOSTL2        TYPE ZGLT060-KOSTL2,
        PRCTR2        TYPE ZGLT060-PRCTR2,
        MATKL2        TYPE ZGLT060-MATKL2,
        NIVEL         TYPE ZGLT060-NIVEL,
END OF TY_ZGL029_DRE_AUX.

DATA:
      IT_ZGL030_EST     TYPE TABLE OF ZGL030_EST_D WITH HEADER LINE,
      IT_ZGL030_EST_AUX TYPE TABLE OF ZGL030_EST_D WITH HEADER LINE,
      W_ZGL030_EST      TYPE ZGL030_EST_D.

DATA: IT_DRE_DADOS            TYPE TABLE OF ZGL020_DRE_DADOS WITH HEADER LINE,
      IT_ZGL015_DRE_EST01     TYPE TABLE OF ZGL015_DRE_EST01 WITH HEADER LINE,
      WA_ZGL015_DRE_EST01     TYPE ZGL015_DRE_EST01,
      WA_ZGL015_DRE_EST02     TYPE ZGL015_DRE_EST02,
      IT_ZGL015_DRE_EST02     TYPE TABLE OF ZGL015_DRE_EST02 WITH HEADER LINE,
      IT_ZGL015_DRE_EST03     TYPE TABLE OF ZGL015_DRE_EST03 WITH HEADER LINE,
      IT_ZGL015_DRE_EST04     TYPE TABLE OF ZGL015_DRE_EST04 WITH HEADER LINE,
      IT_ZGL015_DRE_EST05     TYPE TABLE OF ZGL015_DRE_EST05 WITH HEADER LINE,

      IT_ZGL015_DRE_EST06     TYPE TABLE OF ZGL015_DRE_EST06 WITH HEADER LINE,

      IT_ZGL015_DRE_EST07     TYPE TABLE OF ZGL015_DRE_EST07 WITH HEADER LINE,

      VG_EDITAR               TYPE C LENGTH 1,
      QT_NIVEIS               TYPE I,
      VG_BUKRS_TXT            TYPE BUTXT.

DATA: TG_T001 TYPE TABLE OF T001 WITH HEADER LINE,
      TG_T005 TYPE TABLE OF T005 WITH HEADER LINE.

DATA: IT_ZGL015_DRE_EST04_C TYPE TABLE OF TP_CUSTO WITH HEADER LINE,
      IT_ZGL015_DRE_EST02_ TYPE TABLE OF ZGL015_DRE_EST02 WITH HEADER LINE,
      IT_ZGL015_DRE_EST03_ TYPE TABLE OF ZGL015_DRE_EST03 WITH HEADER LINE,
      IT_ZGL015_DRE_EST04_ TYPE TABLE OF TP_CUSTO WITH HEADER LINE,
      IT_ZGL015_DRE_EST05_ TYPE TABLE OF ZGL015_DRE_EST05 WITH HEADER LINE,
      IT_ZGL015_DRE_EST06_ TYPE TABLE OF ZGL015_DRE_EST06 WITH HEADER LINE,
      TG_TKA02 TYPE TABLE OF TKA02 WITH HEADER LINE,

      IT_ZGL021_DRE_DADOS2 TYPE TABLE OF ZGL021_DRE_DADOS WITH HEADER LINE,
      IT_ZGL022_DRE_DADOS2 TYPE TABLE OF ZGL022_DRE_DADOS WITH HEADER LINE,
      IT_ZGL023_DRE_DADOS2 TYPE TABLE OF ZGL023_DRE_DADOS WITH HEADER LINE,
      IT_ZGL024_DRE_DADOS2 TYPE TABLE OF ZGL024_DRE_DADOS WITH HEADER LINE,
      IT_ZGL029_DRE_DADOS2 TYPE TABLE OF ZGL029_DRE_DADOS WITH HEADER LINE,
      IT_ZGL029_DRE_AUX    TYPE TABLE OF TY_ZGL029_DRE_AUX WITH HEADER LINE,

      IT_ZGL025_DRE_ACM   TYPE TABLE OF ZGL025_DRE_ACM   WITH HEADER LINE,
      IT_ZGL026_DRE_ACM   TYPE TABLE OF ZGL026_DRE_ACM   WITH HEADER LINE,
      IT_ZGL027_DRE_ACM   TYPE TABLE OF ZGL027_DRE_ACM   WITH HEADER LINE,
      IT_ZGL028_DRE_ACM   TYPE TABLE OF ZGL028_DRE_ACM   WITH HEADER LINE,
      IT_ZGL030_DRE_ACM2  TYPE TABLE OF ZGL030_DRE_ACM   WITH HEADER LINE,

      IT_SKAT             TYPE TABLE OF SKAT             WITH HEADER LINE,
      IT_CSKS             TYPE TABLE OF CSKS             WITH HEADER LINE,
      IT_CSKS_AUX         TYPE TABLE OF CSKS             WITH HEADER LINE,
      IT_CSKT             TYPE TABLE OF CSKT             WITH HEADER LINE,
      IT_CEPCT            TYPE TABLE OF CEPCT            WITH HEADER LINE,
      IT_T023T            TYPE TABLE OF T023T            WITH HEADER LINE,
      VG_EXISTE           TYPE C LENGTH 1,
      VG_MONAT            TYPE MONAT,
      VG_TABIX            TYPE SY-TABIX,
      VG_NIVEL_EST(02) type c.


*----------------------------------------------------------------------*
* Variaveis
*----------------------------------------------------------------------*
DATA:  VG_GERAR_REL      TYPE CHAR01.

*----------------------------------------------------------------------*
* Constantes
*----------------------------------------------------------------------*
CONSTANTS:
           OK_CEXCEL    TYPE SY-UCOMM   VALUE 'CEXCEL',
           C_X          TYPE C LENGTH 1 VALUE 'X'.
