*&---------------------------------------------------------------------*
*&  Include           ZPMR0047_TOPO
*&---------------------------------------------------------------------*
REPORT ZPMR0047.

TABLES: AUFK, ZPMT0021, EQUI, VIAUFKST, SSCRFIELDS, AFKO.

TYPES: BEGIN OF TY_UCOMM,
         UCOMM TYPE  SY-UCOMM,
       END OF TY_UCOMM.

TYPES: BEGIN OF TY_AUFK,
         OBJNR       TYPE J_OBJNR,
         WERKS       TYPE WERKS_D,
         TPLNR       TYPE TPLNR,
         EQUNR       TYPE EQUNR,
         EQKTX       TYPE KTX01,
         AUFNR       TYPE AUFNR,
         AUART       TYPE AUART,
         PRIOK       TYPE PRIOK,
         GLTRP       TYPE CO_GLTRP,
         GSTRP       TYPE CO_GSTRP,
         KTEXT       TYPE AUFTEXT,
         ERDAT       TYPE AUFERFDAT,
         TXT04       TYPE J_TXT04,
         DSEQUIPE    TYPE ZPMT0021-DSEQUIPE,
         ZSTATUS     TYPE CHAR5,
         MARC_STATUS TYPE CHAR1,
         ARBEI       TYPE  ARBEIT,
         ISMNW       TYPE CO_ISMNW,
         ARBEH       TYPE ARBEITE,
         DESV        TYPE P DECIMALS 2,
       END OF TY_AUFK.

TYPES: BEGIN OF TY_JEST,
         OBJNR TYPE JEST-OBJNR,
         STAT  TYPE JEST-STAT,
         TXT04 TYPE TJ02T-TXT04,
         INACT TYPE JEST-INACT,
       END OF TY_JEST.

DATA:
  WA_LAYOUT        TYPE LVC_S_LAYO,
  LS_LAYOUT        TYPE LVC_S_LAYO,
  WT_STABLE        TYPE LVC_S_STBL,
  WA_STABLE        TYPE LVC_S_STBL,
  IT_FCAT          TYPE TABLE OF LVC_S_FCAT,
  OBJ_CUSTOM_0110  TYPE REF TO CL_GUI_CUSTOM_CONTAINER,
  OBJ_ALV_0110     TYPE REF TO CL_GUI_ALV_GRID,
  GT_EXC_BUTTON    TYPE UI_FUNCTIONS,
  OBJ_ALV_STATUS   TYPE REF TO CL_GUI_ALV_GRID,
  LINES            TYPE SY-TABIX,
  IT_SELECTED_ROWS TYPE LVC_T_ROW,
  WA_SELECTED_ROWS TYPE LVC_S_ROW,
  WA_TOOLBAR       TYPE STB_BUTTON,
  IT_UCOMM         TYPE TABLE OF TY_UCOMM,
  G_CONTAINER      TYPE REF TO CL_GUI_CUSTOM_CONTAINER.

DATA: IT_ZPMT0021 TYPE TABLE OF ZPMT0021,
      WA_ZPMT0021 TYPE ZPMT0021.

DATA: IT_METHODS    TYPE TABLE OF BAPI_ALM_ORDER_METHOD,
      IT_HEADER     TYPE TABLE OF BAPI_ALM_ORDER_HEADERS_I,
      IT_OPERATION  TYPE TABLE OF BAPI_ALM_ORDER_OPERATION,
      IT_RETURN     TYPE TABLE OF BAPIRET2,
      IT_MSG_RETURN TYPE TABLE OF ZFIWRS0002,
      WA_MSG_RETURN TYPE ZFIWRS0002,
      WA_MENSAGEM   TYPE CHAR30.


DATA: WA_METHODS   TYPE BAPI_ALM_ORDER_METHOD,
      WA_HEADER    TYPE BAPI_ALM_ORDER_HEADERS_I,
      WA_OPERATION TYPE BAPI_ALM_ORDER_OPERATION,
      WA_RETURN    TYPE BAPIRET2.

"// Note we can't define a range with header line in Classes
"// Define a Ranges as Class Attribute
DATA STATUS_RANGE TYPE RANGE OF  STAT.
DATA STATUS_EQP TYPE RANGE OF  ZPMT0021-DSEQUIPE WITH HEADER LINE.

DATA INSTANCE_RANGE TYPE RANGE OF STAT.

DATA: GT_ORDEM TYPE TABLE OF TY_AUFK.
DATA: GT_JEST  TYPE TABLE OF TY_JEST.

SELECTION-SCREEN: BEGIN OF BLOCK B6 WITH FRAME TITLE TEXT-009.
SELECTION-SCREEN BEGIN OF LINE.

SELECTION-SCREEN POSITION 1 .
PARAMETER: P_ABE AS CHECKBOX DEFAULT 'X' USER-COMMAND ABC.
SELECTION-SCREEN COMMENT 05(12) TEXT-010 FOR FIELD P_ABE.

SELECTION-SCREEN POSITION 20.
PARAMETER: P_LIB AS CHECKBOX DEFAULT 'X' USER-COMMAND ABC.
SELECTION-SCREEN COMMENT 25(14) TEXT-011 FOR FIELD P_LIB.

SELECTION-SCREEN END OF LINE.
SELECTION-SCREEN: END OF BLOCK B6.

SELECTION-SCREEN BEGIN OF BLOCK B2 WITH FRAME TITLE TEXT-001.
SELECT-OPTIONS:
*                 P_BUKRS FOR AUFK-BUKRS NO-EXTENSION NO INTERVALS,
                 P_WERKS FOR AUFK-WERKS,
                 P_AUART FOR VIAUFKST-AUART,
                 P_AUFNR FOR VIAUFKST-AUFNR,
*                 P_ARBPL FOR VIAUFKST-VAPLZ, "MATCHCODE OBJECT CRAM.
                 P_ERDAT FOR AUFK-ERDAT OBLIGATORY DEFAULT SY-DATUM.
*PARAMETERS:
*                P_ARBPL TYPE VIAUFKST-VAPLZ.  " Centro de trabalho
SELECTION-SCREEN: END OF BLOCK B2.
*
*
SELECTION-SCREEN BEGIN OF BLOCK B4 WITH FRAME TITLE TEXT-002.
SELECT-OPTIONS:  P_EQUNR FOR EQUI-EQUNR,
*                 P_EQTYP FOR EQUI-EQTYP, "DEFAULT '*',
                 P_TPLNR FOR VIAUFKST-TPLNR.
SELECTION-SCREEN: END OF BLOCK B4.
*
*
SELECTION-SCREEN BEGIN OF BLOCK B3 WITH FRAME TITLE TEXT-003.
SELECT-OPTIONS:  P_KOSTL FOR VIAUFKST-KOSTL.
SELECTION-SCREEN: END OF BLOCK B3.

SELECTION-SCREEN FUNCTION KEY 1.

INITIALIZATION.
  SSCRFIELDS-FUNCTXT_01 = 'Cadastro de Equipe'.

AT SELECTION-SCREEN. "PAI
  CASE SSCRFIELDS-UCOMM. "pushbutton pressed
    WHEN 'FC01'.
*      MESSAGE 'teste' TYPE 'S'.

      IF SY-SUBRC IS INITIAL.
        CALL FUNCTION 'VIEW_MAINTENANCE_CALL'
          EXPORTING
            ACTION    = 'U'
            VIEW_NAME = 'ZPMT0021'.
      ENDIF.
  ENDCASE.
