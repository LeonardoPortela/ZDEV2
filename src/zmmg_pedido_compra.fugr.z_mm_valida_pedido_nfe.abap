FUNCTION Z_MM_VALIDA_PEDIDO_NFE.
*"----------------------------------------------------------------------
*"*"Interface local:
*"  IMPORTING
*"     REFERENCE(I_EBELN) TYPE  EBELN
*"     REFERENCE(I_CHAVE_NFE) TYPE  ZDE_CHAVE_DOC_E
*"     REFERENCE(I_VERF_EXISTE) TYPE  CHAR01 DEFAULT 'X'
*"  EXPORTING
*"     REFERENCE(E_MESSAGEM_ERRO) TYPE  STRING
*"     REFERENCE(E_SUCESSO) TYPE  CHAR01
*"----------------------------------------------------------------------

  E_SUCESSO  = '0'.

  TRY .
      ZCL_PEDIDO_COMPRA=>GET_VALIDA_PEDIDO_NOTA(
        EXPORTING
          I_EBELN       = I_EBELN   " Nº do documento de compras
          I_CHAVE_NFE   = I_CHAVE_NFE    " Chave de Documento Fiscal Eletrônico
          I_VERF_EXISTE = I_VERF_EXISTE
      ).

      E_SUCESSO  = '1'.

    CATCH ZCX_PEDIDO_COMPRA_EXCEPTION INTO DATA(EX_PEDIDO).    "
      MESSAGE ID EX_PEDIDO->MSGID TYPE 'S'
       NUMBER EX_PEDIDO->MSGNO
         WITH EX_PEDIDO->MSGV1 EX_PEDIDO->MSGV2 EX_PEDIDO->MSGV3 EX_PEDIDO->MSGV4
         INTO E_MESSAGEM_ERRO.
    CATCH ZCX_NFE_INBOUND_EXCEPTION INTO DATA(EX_INBOUND).    "
      MESSAGE ID EX_INBOUND->MSGID TYPE 'S'
       NUMBER EX_INBOUND->MSGNO
         WITH EX_INBOUND->MSGV1 EX_INBOUND->MSGV2 EX_INBOUND->MSGV3 EX_INBOUND->MSGV4
         INTO E_MESSAGEM_ERRO.
    CATCH ZCX_CADASTRO INTO DATA(EX_CADASTRO).    "
      MESSAGE ID EX_CADASTRO->MSGID TYPE 'S'
       NUMBER EX_CADASTRO->MSGNO
         WITH EX_CADASTRO->MSGV1 EX_CADASTRO->MSGV2 EX_CADASTRO->MSGV3 EX_CADASTRO->MSGV4
         INTO E_MESSAGEM_ERRO.
  ENDTRY.


ENDFUNCTION.
